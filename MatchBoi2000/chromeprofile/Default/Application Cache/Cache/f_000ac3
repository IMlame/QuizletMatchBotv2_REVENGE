woe.prototype.JU=X(1655,function(a){this.C.C.TP(a)});Eoe.prototype.JU=X(1654,function(a){this.D.JU(a)});Q_d.prototype.c6=X(1297,function(){return zi(this,3)});U4d.prototype.c6=X(1296,function(){return zi(this,3)});nra.prototype.Er=X(1285,function(){return zi(this,2)});JTd.prototype.Er=X(1284,function(){return zi(this,1)});Aoa.prototype.vr=X(11,function(){return ph(this,12)});Coa.prototype.vr=X(10,function(){return this.message.vr()});Cle.prototype.vr=X(9,function(){return J(this,2)});
Ile.prototype.vr=X(8,function(){return J(this,2)});function HAi(a){fM(a,function(b){b=new (b.H())(a.H,a.bb);dM(a,b);b.setVisible(!0)},"ritzmaestro")}function IAi(a,b){fM(a,function(c){c=c.C(b,this.H,this.kb);dM(this,c);c.setVisible(!0)},"ritzmaestro")}function JAi(a,b){fM(a,function(c){c=c.D(b,this.H,this.kb);dM(this,c);c.setVisible(!0)},"ritzmaestro")}function KAi(a,b){a.D=b}function LAi(a,b){var c=Bd;Cd(a,function(d,e){return c(b(d),b(e))})}function MAi(a){C.call(this,a)}v(MAi,C);
MAi.prototype.Td=function(){return this.message.Td()};function NAi(a){var b=OAi();PAi(b);return Ah(b,3,a)}function PAi(a){a.ij(1,2,3,4,5,6)}function QAi(a){this.fb=dh(a,-1,0)}v(QAi,gh);QAi.prototype.toBuilder=function(){return new MAi(this)};QAi.prototype.Td=function(){return ph(this,1)};function OAi(){var a=void 0===a?ih(QAi):a;return new MAi(a)}function RAi(a){C.call(this,a)}v(RAi,C);RAi.prototype.getFunctionName=function(){return this.message.getFunctionName()};
function SAi(a){this.fb=dh(a,-1,0)}v(SAi,gh);SAi.prototype.toBuilder=function(){return new RAi(this)};SAi.prototype.getFunctionName=function(){return ph(this,2)};function TAi(){var a=void 0===a?ih(SAi):a;return new RAi(a)}function UAi(a){C.call(this,a)}v(UAi,C);function VAi(a,b){return Eh(a,1,b)}function WAi(a){this.fb=dh(a,-1,0)}v(WAi,gh);WAi.prototype.toBuilder=function(){return new UAi(this)};function XAi(){var a=void 0===a?ih(WAi):a;return new UAi(a)}
function YAi(a,b){var c=this;this.J=a;this.F=new Rf;this.C=new Map;this.D=new Map;this.H=new Vl(this);this.H.listen(b,"external_data_change",function(){ZAi(c);c.F.dispatchEvent(null)});ZAi(this)}
function $Ai(a,b,c){for(var d=ha(uh(b,1,SAi).Fb()),e=d.next();!e.done;e=d.next()){var f=e.value;kh(f,2);e=f.getFunctionName();var h=a.C.get(e);if(h)if(mh(f,5))a.C.delete(e),a.D.set(e,h);else{h=h.toBuilder();kh(f,3);var k=ph(f,3);Ah(h,8,k);kh(f,4)?(f=ph(f,4),Ah(h,9,f)):xh(h,9);a.C.set(e,h.build())}else h=a.D.get(e).toBuilder(),kh(f,3),f=ph(f,3),Ah(h,8,f),a.C.set(e,h.build()),a.D.delete(e)}a.F.dispatchEvent(null);Ek(ap(So(a.J.Se("/editactions"),{data:JSON.parse(b.qb())}),"POST"),c).Te()}
function ZAi(a){var b=tj().pT()().map(Boa),c=new Map,d=new Map;b=ha(b);for(var e=b.next();!e.done;e=b.next())e=e.value,kh(e,8)?c.set(e.getFunctionName(),e):mh(e,11)||d.set(e.getFunctionName(),e);a.C=c;a.D=d}function aBi(){return T('<div class="waffle-edit-actions-dialog-scroll"><div class="waffle-edit-actions-dialog-actions-row-container"></div><div class="waffle-edit-actions-empty" role="alert">There are no macros</div></div>')}
function bBi(a){return T('<div class="waffle-edit-actions-row"><div class="waffle-edit-actions-row-name"><input class="waffle-edit-actions-name-input jfk-textinput" maxlength="50"/><div class="waffle-edit-actions-shortcut-conflict-message"></div></div><div class="waffle-edit-actions-options"><div class="waffle-edit-actions-row-shortcut-prefix">'+vr(a.yGa)+'</div><div class="waffle-edit-actions-row-shortcut"><input class="waffle-edit-actions-row-shortcut-input jfk-textinput" maxlength="1"/></div><div class="waffle-edit-actions-row-menu"></div></div></div>')}
;function cBi(a,b,c,d){Ev.call(this,void 0,!1,d);var e=this;this.R=a;this.O=Array.from(this.R.C.values());LAi(this.O,function(f){return f.getFunctionName()});this.F=b;this.ea=c;this.C=new Map;this.L=null;this.H=new i9b("Macro removed","UNDO",function(){return dBi(e)},void 0,this.oa(),"off");this.qa(this.H);Xv(this.ea,this.H);ss(this,(new ps).Df(ws,!1,!0).set("save","Update",!0))}v(cBi,Ev);
cBi.prototype.Ca=function(){Ev.prototype.Ca.call(this);this.qr=!1;rs(this,!1);eBi(this,!1);Ur(ns(this),"waffle-edit-actions-dialog-gm");Cs(this,"save");this.setTitle("Manage macros");this.yb().appendChild(sr(aBi));for(var a=this.Ea("waffle-edit-actions-dialog-actions-row-container"),b=ha(this.O),c=b.next();!c.done;c=b.next()){c=c.value;var d=new fBi(c,this.F);this.Ga(d);this.C.set(c.getFunctionName(),d);d.render(a)}Q(this.Ea("waffle-edit-actions-empty"),!1);this.H.render();Ur(this.H.Ka(),"waffle-edit-actions-undo-remove-toast")};
function eBi(a,b){ts(a.D,"save").disabled=!b}cBi.prototype.Ia=function(){var a=this;Ev.prototype.Ia.call(this);gBi(this);this.getHandler().listen(this,"dialogselect",this.ma).listen(this.Ka(),"keydown",function(b){13==b.keyCode&&"INPUT"==b.target.tagName&&(b.target.setSelectionRange(0,0),b.target.blur(),b.preventDefault());90==b.keyCode&&b.ctrlKey&&dBi(a)});hBi(this)};
function gBi(a){for(var b={},c=ha(a.C.values()),d=c.next();!d.done;b={YQ:b.YQ},d=c.next())b.YQ=d.value,a.getHandler().listen(b.YQ.ea,"action",function(e){return function(){return iBi(a,e.YQ)}}(b)).listen(jBi(b.YQ),"input",function(e){return function(){var f=e.YQ;kBi(f)?AV(f.mP):zV(f.mP,"Must be a number from 0 to 9 or blank.",!0);f=!hBi(a)&&kBi(f);eBi(a,f)}}(b)).listen(lBi(b.YQ),"input",function(){a.F.C(29573);eBi(a,!0)})}
function hBi(a){var b=new Map;a=ha(a.C.values());for(var c=a.next();!c.done;c=a.next())c=c.value,b.has(mBi(c))?b.get(mBi(c)).push(c):b.set(mBi(c),[c]);a=!1;c=null;b=ha(b);for(var d=b.next();!d.done;d=b.next()){var e=ha(d.value);d=e.next().value;e=e.next().value;1<e.length&&""!=d?(a=!0,c=d,e.forEach(function(h){h=h.Ea("waffle-edit-actions-shortcut-conflict-message");Em(h,"Conflicts with another shortcut");Q(h,!0)})):e.forEach(function(h){h=h.Ea("waffle-edit-actions-shortcut-conflict-message");Q(h,
!1)})}if(a){var f="Can't save conflicting shortcut "+c;setTimeout(function(){return qG(f)})}return a}function iBi(a,b){eBi(a,!0);a.L=b;a.C.delete(b.Aa);Q(b.Ka(),!1);hBi(a);a.H.setVisible(!0);0==a.C.size&&Q(a.Ea("waffle-edit-actions-empty"),!0);a.Ka().focus();var c="Macro "+(b.C.getValue()+" was removed, Ctrl-Z to Undo");setTimeout(function(){return qG(c)});a.F.C(29572)}
function dBi(a){if(null!=a.L){var b=a.L;a.C.set(b.Aa,b);Q(b.Ka(),!0);Q(a.Ea("waffle-edit-actions-empty"),!1);hBi(a);a.L=null;var c="Macro "+(b.C.getValue()+" is restored.");setTimeout(function(){return qG(c)});a.F.C(29577)}}
cBi.prototype.ma=function(a){var b=this;if("cancel"==a.key)this.F.C(29569);else if("save"==a.key){for(var c=ha(this.C.values()),d=c.next();!d.done;d=c.next())if(d=d.value,!kBi(d)||""!=nBi(d)){a.preventDefault();return}hBi(this)?a.preventDefault():(a=oBi(this),$Ai(this.R,a,function(){var e=Wv(b.ea,"Failed to update macros.",bm(),!0,0,!0,void 0,!0,["waffle-edit-actions-update-failed"]);e.C=!0;e.render();e.setVisible(!0)}),this.F.C(29574),setTimeout(function(){return qG("Macros updated")}))}};
function oBi(a){for(var b=XAi(),c=ha(a.O),d=c.next();!d.done;d=c.next()){var e=d.value;d=TAi();var f=!1,h=a.C.get(e.getFunctionName()),k=ph(e,9),m=ph(e,8);h?(k!=mBi(h)&&(k=mBi(h),f=!0),m!=h.C.getValue()&&(m=h.C.getValue(),f=!0)):(yh(d,5,!0),f=!0);f&&(f=ph(e,1),Ah(d,1,f),e=e.getFunctionName(),Ah(d,2,e),Ah(d,3,m),k&&Ah(d,4,k),d=d.build(),Dh(b,1,d))}return b.build()}
function fBi(a,b,c){S.call(this,c);this.xa=a;this.Ha=ph(a,8);this.Aa=a.getFunctionName();this.J=(a=ph(a,9))?a.split("+"):[];this.D=new kv;this.Ga(this.D);this.L=this.O=null;this.C=new kv;this.Ga(this.C);this.ma=new Iv;this.qa(this.ma);this.Ba=b;b=Rs(kt,"waffle-overflow-menu-material");this.H=new Bt(void 0,void 0,b,this.oa());this.qa(this.H);this.R=new pt("Edit script");this.qa(this.R);this.ea=new pt("Remove");this.qa(this.ea);this.mP=new yV(this.oa());this.qa(this.mP);this.F=new yV(this.oa());this.qa(this.F)}
v(fBi,S);fBi.prototype.Ca=function(){var a=(od(this.J)?pBi:this.J.slice(0,this.J.length-1)).join(" + ")+" + ";a=sr(bBi,{yGa:Np?a.replace(/Ctrl/g,"\u2318").replace(/Alt/g,"Option"):a});this.jb(a)};
fBi.prototype.Ia=function(){var a=this;this.D.Va(this.Ea("waffle-edit-actions-row-shortcut-input"));this.D.setValue(ad(this.J)||"");var b=this.Ea("waffle-edit-actions-name-input");this.C.Va(b);this.C.setValue(this.Ha);this.ma.Va(b);this.mP.setPosition(3,2);this.mP.render();b=this.D.Ka();this.mP.Vi(b);BV(this.mP,b);AV(this.mP);this.F.setPosition(0,2);this.F.render();b=this.C.Ka();this.F.Vi(b);BV(this.F,b);AV(this.F);b=new Kr(this.H.yb(),13);Ct(this.H,b);this.H.XD=!0;this.H.Vc(this.R);this.H.Vc(this.ea);
b=this.Ea("waffle-edit-actions-row-menu");this.H.Va(b);"black"==Ht()&&Ur(b,"waffle-overflow-menu-material-white");this.getHandler().listen(this.R,"action",function(){O("macros-editor").pb({scriptId:ph(a.xa,1),filename:ph(a.xa,10)});a.Ba.C(29570)}).listen(this.C.Ka(),"blur",function(){""==nBi(a)?AV(a.F):zV(a.F,nBi(a),!0)}).listen(this.D.Ka(),"click",function(){return a.D.Ka().select()}).listen(jBi(this),"input",function(){return a.Ba.C(29571)});Qr(this.Ea("waffle-edit-actions-name-input"),"Macro name");
Qr(this.D.Ka(),"Numeric shortcut key");Qr(b,"More options button")};function mBi(a){var b=a.D.getValue();return""==b?"":(od(a.J)?pBi:a.J.slice(0,a.J.length-1)).join("+")+"+"+b}function jBi(a){null==a.O&&(a.O=new Hv(a.D.Ka()),a.qa(a.O));return a.O}function lBi(a){null==a.L&&(a.L=new Hv(a.C.Ka()),a.qa(a.L));return a.L}function kBi(a){a=a.D.getValue();return""==a||/^\d$/.test(a)}
function nBi(a){a=a.C.getValue();return""==a?"Macro name must be not be empty.":/\r|\n/.test(a)?"Macro name must not contain line-break characters.":""}var pBi=["Ctrl","Alt","Shift"];function qBi(){return T('<div class="waffle-import-custom-function-actions-title-separator"></div><div class="waffle-import-custom-function-actions-dialog-scroll"><div class="waffle-import-custom-functions-row-container"></div></div>')}
function rBi(a){var b=a.hpc,c=a.fileName;a='<div class="waffle-import-custom-function-row" tabindex="0"><div class="waffle-import-custom-function-name">'+vr(a.functionName)+'</div><div class="waffle-import-custom-function-metadata"><div class="waffle-import-custom-function-project-name"><span class="waffle-import-custom-function-description-label">';a=a+'Project:</span><span class="function-description-seperator"></span>'+(vr(b)+'</div><div class="waffle-import-custom-function-file-name"><span class="waffle-import-custom-function-description-label">');
a=a+'File:</span><span class="function-description-seperator"></span>'+(vr(c)+'</div></div><div class="waffle-import-custom-function-view-script"></div><div class="waffle-import-custom-function-add-function"></div></div>');return T(a)};function sBi(a,b,c,d){Ev.call(this,void 0,!1,d);this.ma=a;this.H=Array.from(this.ma.D.values());LAi(this.H,function(e){return e.getFunctionName()});this.ea=b;this.Ba=c;this.R=[];this.F=[];this.C=Wv(this.Ba,"Function added.",bm(),!1,3E3,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);this.qa(this.C);this.Ha=new Kv(this.oa());this.qa(this.Ha);this.L=new Rn(this.O,3E3,this);this.qa(this.L)}v(sBi,Ev);
sBi.prototype.Ca=function(){Ev.prototype.Ca.call(this);Ur(ns(this),"waffle-import-custom-function-actions-dialog");this.setTitle("Import");var a=this.oa().Ca("DIV","waffle-import-custom-function-title-description",Iw()?"Added functions will appear in the menu under Extensions > Macros":"Added functions will appear in the menu under Tools > Macros");ls(this).appendChild(a);this.yb().appendChild(sr(qBi));a=this.Ea("waffle-import-custom-functions-row-container");for(var b=ha(this.H),c=b.next();!c.done;c=
b.next())c=new tBi(c.value,this.ea),this.Ga(c),c.render(a),this.R.push(c);this.C.render();this.C.setVisible(!1);ss(this,null)};sBi.prototype.Ia=function(){var a=this;Ev.prototype.Ia.call(this);for(var b={},c=ha(this.R),d=c.next();!d.done;b={nca:b.nca},d=c.next())b.nca=d.value,this.getHandler().listen(b.nca.D,"action",function(e){return function(){return uBi(a,e.nca)}}(b));this.getHandler().listen(this,"hide",function(){return a.O()})};
function uBi(a,b){vBi(b);var c=wBi(b.C);xBi(a,c);b=b.Ea("waffle-import-custom-function-add-function");b.setAttribute("tabindex","0");Qr(b,"This function has been added.");b.focus();a.ea.C(29576);setTimeout(function(){return a.C.setVisible(!0)})}function wBi(a){var b=TAi();var c=ph(a,1);b=Ah(b,1,c);c=a.getFunctionName();b=Ah(b,2,c);a=a.getFunctionName();return Ah(b,3,a).build()}function xBi(a,b){a.F.push(b);a.L.start()}
sBi.prototype.O=function(){var a=this;if(0<this.F.length){var b=VAi(XAi(),this.F).build();$Ai(this.ma,b,function(){var c=Wv(a.Ba,"Failed to add function.",bm(),!1,1E4,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);c.C=!0;c.render();c.setVisible(!0)});this.F=[]}};function tBi(a,b,c){S.call(this,c);this.C=a;this.H=b;a=Sv.getInstance();this.D=new lt("Add Function",a,c);this.Ga(this.D);this.F=new lt("Edit Script",a,c);this.Ga(this.F)}v(tBi,S);
tBi.prototype.Ca=function(){S.prototype.Ca.call(this);var a=sr(rBi,{functionName:this.C.getFunctionName(),hpc:ph(this.C,2),fileName:ph(this.C,10)});this.jb(a);this.D.render(this.Ea("waffle-import-custom-function-add-function"));this.F.render(this.Ea("waffle-import-custom-function-view-script"))};
tBi.prototype.Ia=function(){var a=this;S.prototype.Ia.call(this);this.getHandler().listen(this.F,"action",function(){O("macros-editor").pb({scriptId:ph(a.C,1),filename:ph(a.C,10)});a.H.C(29575)});var b="Function: "+(this.C.getFunctionName()+(", from project: "+(ph(this.C,2)+(", defined in file: "+ph(this.C,10)))));Qr(this.Ka(),b)};function vBi(a){Q(a.D.Ka(),!1);Ur(a.Ea("waffle-import-custom-function-add-function"),"waffle-import-custom-function-actions-checkmark")};function yBi(a,b,c,d,e,f){B.call(this);this.C=a;this.functionName=b;this.F=d||null;this.D=void 0!==f?f:null}v(yBi,B);function zBi(a){I(this,a,0,-1,ABi,null)}x(zBi,H);var ABi=[6];p=zBi.prototype;p.V=function(){var a=new D;BBi(this,a);return Y(a)};function BBi(a,b){var c=J(a,1);null!=c&&b.Da(1,c);c=J(a,2);null!=c&&b.Da(2,c);c=J(a,3);null!=c&&b.Da(3,c);c=J(a,4);null!=c&&b.Da(4,c);c=J(a,5);null!=c&&b.Da(5,c);c=a.uh();0<c.length&&ni(b,6,c,BBi);c=J(a,7);null!=c&&F(b,7,c);c=J(a,9);null!=c&&b.Da(9,c);c=J(a,10);null!=c&&b.Da(10,c);c=J(a,11);null!=c&&G(b,11,c);c=J(a,12);null!=c&&G(b,12,c);c=J(a,13);null!=c&&b.Da(13,c)}
p.Ie=function(){return J(this,1)};p.yg=function(){return J(this,2)};p.Lk=function(a){L(this,2,a)};p.getKey=function(){return J(this,5)};p.uh=function(){return Ni(this,zBi,6)};p.Vc=function(a,b){return Ri(this,6,a,zBi,b)};p.Na=function(a){return L(this,7,a)};p.vr=function(){return J(this,13)};function CBi(a){I(this,a,"amep",-1,null,null)}x(CBi,H);CBi.prototype.V=function(){var a=new D;var b=this.zb();null!=b&&a.va(1,b,BBi);return Y(a)};CBi.messageId="amep";CBi.prototype.zb=function(){return M(this,zBi,1,1)};CBi.prototype.Be=function(a){return Oi(this,1,a)};CBi.prototype.O4=function(){L(this,1,void 0)};CBi.prototype.At=function(){return vi(this,1)};function x7(a){Fl.call(this,a)}v(x7,Fl);function DBi(a){Fl.call(this,"amep");this.D=new CBi(a)}v(DBi,x7);DBi.prototype.C=g("D");function EBi(a){I(this,a,0,-1,null,null)}x(EBi,H);EBi.prototype.V=function(){var a=new D;FBi(this,a);return Y(a)};
function FBi(a,b){var c=J(a,1);null!=c&&b.Da(1,c);c=J(a,2);null!=c&&b.Da(2,c);c=J(a,3);null!=c&&b.Da(3,c);c=J(a,4);null!=c&&F(b,4,c);c=J(a,5);null!=c&&b.Da(5,c);c=J(a,6);null!=c&&b.Da(6,c);c=J(a,7);null!=c&&b.Da(7,c);c=J(a,8);null!=c&&F(b,8,c);c=J(a,9);null!=c&&F(b,9,c);c=J(a,10);null!=c&&F(b,10,c);c=J(a,11);null!=c&&b.Da(11,c);c=J(a,12);null!=c&&F(b,12,c);c=J(a,13);null!=c&&b.Da(13,c);c=J(a,14);null!=c&&b.Da(14,c);c=J(a,15);null!=c&&b.Da(15,c);c=J(a,16);null!=c&&b.Da(16,c);c=J(a,17);null!=c&&b.Da(17,
c);c=J(a,18);null!=c&&gi(b,18,c);c=J(a,19);null!=c&&F(b,19,c)}function y7(a){return J(a,2)}EBi.prototype.getName=function(){return J(this,3)};EBi.prototype.Kj=function(){return J(this,13)};function GBi(a,b){this.D=void 0===a?null:a;this.C=(void 0===b?null:b)||null}GBi.prototype.F=g("C");function HBi(a,b){return y(A(),"docs-emgsmw")?null==a.F||null==J(b,18)?!1:a.C===J(b,18):a.D===J(b,1)}function z7(a){return new GBi(J(a,1),J(a,18))};function IBi(a){I(this,a,"der",-1,null,null)}x(IBi,H);IBi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};IBi.messageId="der";IBi.prototype.Er=function(){return zi(this,1)};function JBi(a){I(this,a,"eer",-1,null,null)}x(JBi,H);JBi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};JBi.messageId="eer";JBi.prototype.Er=function(){return zi(this,1)};function KBi(a,b,c){this.D=a;this.C=b;this.F=c}KBi.prototype.getVersionInfo=g("F");function LBi(a,b){this.C=a;this.D=b}LBi.prototype.getVersionInfo=g("D");function MBi(a,b){this.C=a;this.Od=b}MBi.prototype.getExtension=g("C");MBi.prototype.isEnabled=g("Od");function NBi(a){Ev.call(this);this.C=a;os(this,!0);this.$y(!1);ss(this,null);rs(this,!1)}v(NBi,Ev);NBi.prototype.Ca=function(){Ev.prototype.Ca.call(this);this.C.render(this.yb())};NBi.prototype.Ia=function(){Ev.prototype.Ia.call(this);var a=this.Ka();Or(a,"labelledby");Qr(a,"Add-ons");Ur(ns(this),"gsm-widget")};function OBi(a,b){var c=new $i,d=new CGd;if(b){if(J(b,1)){var e=J(b,1);L(d,1,e)}e=zi(b,12);L(d,2,e);vi(b,18)&&(e=J(b,18),L(d,5,e));b=zi(b,19);L(d,6,b)}b=Wc(A(),"docs-tcmt");e=!!b;L(d,3,e);e&&L(d,4,b);Oi(c,73,d);return kq(lq(new jq,c),a).build()}function PBi(a){var b=new $i,c=new CGd;null!=a.D&&L(c,1,a.D);null!=a.C&&L(c,5,a.C);Oi(b,73,c);return kq(lq(new jq,b),90).build()};function QBi(a,b,c){WV.call(this,a);this.D=b;this.F=c;this.D.hj=!0}v(QBi,WV);p=QBi.prototype;p.LCa=function(){O("macros-extension-store-render").pb()};p.Gla=function(a,b,c){a=new GBi(null,a);O("macros-extension-store-install").pb(new KBi(a,String(b),c),PBi(a))};p.KCa=function(a,b){a=new GBi(null,a);O("macros-extension-store-uninstall-item").pb(new LBi(a,b),PBi(a))};
p.d3a=function(a){var b=new sdf,c=this.F(new GBi(null,a));if(!c)return b;a=c.getExtension();c=c.isEnabled();var d=new VV;d.Lk("Use in this document");L(d,3,"useInDoc");d.Gb(!!zi(a,4)||!!zi(a,12));d.Na(c);var e=new VV;e.Lk("Help");L(e,3,"help");d=[d,e];zi(a,9)&&(e=new VV,L(e,1,!0),d.push(e),zi(a,8)&&(a=new VV,a.Na(c),a.Lk("Settings"),L(a,3,"settings"),d.push(a)),a=new VV,a.Lk("Report an issue"),L(a,3,"reportIssue"),d.push(a));Qi(b,1,d);return b};
p.c3a=function(a,b){var c=new GBi(null,a);a=PBi(c);switch(b){case "help":b=this.F(c);if(!b)break;b=b.getExtension();O("macros-extension-help").pb(y7(b),a);break;case "reportIssue":O("macros-extension-store-report").pb(c,a);break;case "settings":O("macros-extension-store-settings").pb(c,a);Vf(this.D);break;case "useInDoc":O("macros-extension-store-use-in-doc").pb(c,a)}};p.ima=function(){this.D.setVisible(!1)};function RBi(a,b,c){B.call(this);this.C=SBi(a);this.F=b;this.D=c}v(RBi,B);function TBi(a,b,c,d,e){b=new Slf(b,null,e);Tlf(b,Zc(A(),"docs-gsmd"));a.D&&Wlf(b,a.D);KAi(b,c.map(function(f){return f.C}));d&&d.C&&(b.F=d.C);a=Zc(A(),"gaia_session_id");a=Od(a)?NaN:Number(a);isNaN(a)||Ulf(b,a);return b.build()}function UBi(a,b){var c=new NBi(b);a=new QBi(b,c,a.F);c.qa(a);return c}
function SBi(a){if(a==(Du(),Au))return"docs_addon";if(a==(Du(),Bu))return"sheets_addon";if(a==(Du(),Cu))return"slides_addon";if(a==(Du(),c0a))return"forms_addon";throw Error("Unsupported document type for GSM  ["+a+"]");};function VBi(a,b,c,d,e,f){B.call(this);this.F=b;this.D=new RBi(a,d,f);this.C=null}v(VBi,B);function WBi(a){I(this,a,"iar",-1,null,null)}x(WBi,H);WBi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=J(this,2);null!=b&&a.Da(2,b);b=J(this,3);null!=b&&F(a,3,b);return Y(a)};WBi.messageId="iar";WBi.prototype.Er=function(){return zi(this,1)};function XBi(a,b,c,d){var e=J(a,4)+"-polymorphic-"+(a.Ie()||"");lSa.call(this,e);this.C=a;this.L=gd(b,function(f){return new XBi(f,[],!1)},this);this.Na(this.isEnabled());this.xa=c;this.ma="boolean"===typeof d?d:!0}v(XBi,lSa);XBi.prototype.isInstalled=g("ma");XBi.prototype.pb=function(){O("macros-polymorphic-item").pb(this)};XBi.prototype.isEnabled=function(){return this.L&&(0<this.L.length?!0:!!zi(this.C,7))};XBi.prototype.getLabel=function(){return this.C.yg()||J(this.C,10)||""};function YBi(){Fl.call(this,"Jl")}v(YBi,Fl);function ZBi(){Pl.call(this);this.C={};this.C[1]={};this.C[0]={};this.D=new Yt(this);this.qa(this.D);this.D.subscribe(O("macros-polymorphic-item"),"action",this.F)}v(ZBi,Pl);ZBi.prototype.F=function(a){a.xa||0<a.L.length?this.dispatchEvent(new YBi(a)):(a=new yBi(J(a.C,4),J(a.C,3),void 0,J(a.C,9)||void 0,void 0,a.C.vr()||void 0),O("macros-exec").pb(a))};function $Bi(a){I(this,a,"ger",-1,aCi,null)}x($Bi,H);var aCi=[1];$Bi.prototype.V=function(){var a=new D;var b=this.Sfa();0<b.length&&ni(a,1,b,FBi);return Y(a)};$Bi.messageId="ger";$Bi.prototype.Sfa=function(){return Ni(this,EBi,1)};function bCi(a){I(this,a,0,-1,null,null)}x(bCi,H);bCi.prototype.V=function(){var a=new D;cCi(this,a);return Y(a)};function cCi(a,b){var c=J(a,1);null!=c&&b.Da(1,c);c=J(a,2);null!=c&&b.Da(2,c)}bCi.prototype.getName=function(){return J(this,1)};function dCi(a){I(this,a,0,-1,eCi,null)}x(dCi,H);var eCi=[4];p=dCi.prototype;p.V=function(){var a=new D;fCi(this,a);return Y(a)};function fCi(a,b){var c=J(a,1);null!=c&&b.Da(1,c);c=J(a,2);null!=c&&b.Da(2,c);c=J(a,3);null!=c&&b.Da(3,c);c=Ni(a,bCi,4);0<c.length&&ni(b,4,c,cCi)}p.getId=function(){return J(this,1)};p.Dc=function(a){return L(this,1,a)};p.getName=function(){return J(this,2)};p.Nd=function(){return J(this,3)};p.Pi=function(a){return L(this,3,a)};function gCi(a){I(this,a,"llr",-1,hCi,null)}x(gCi,H);var hCi=[2];gCi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=Ni(this,dCi,2);0<b.length&&ni(a,2,b,fCi);return Y(a)};gCi.messageId="llr";gCi.prototype.Er=function(){return zi(this,1)};function iCi(a){I(this,a,"rar",-1,null,null)}x(iCi,H);iCi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=J(this,2);null!=b&&a.Da(2,b);return Y(a)};iCi.messageId="rar";iCi.prototype.Er=function(){return zi(this,1)};function jCi(a){I(this,a,"uer",-1,null,null)}x(jCi,H);jCi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};jCi.messageId="uer";jCi.prototype.Er=function(){return zi(this,1)};function kCi(a,b,c,d){B.call(this);this.D=a;this.F=c;this.C=d||new lCi}v(kCi,B);p=kCi.prototype;p.UYa=function(a,b,c,d,e,f,h){a=["ruid",Ia({}),this.C.C,this.D,this.C.F,a,this.C.O,b,this.C.D,c,this.C.xa,e,this.C.Aa,f,this.C.ma,h];a=Zo(Dk(ap(A7(this,this.C.R),"POST"),2),a).Yr();d&&(Fk(a,w(this.M4b,this,d)),Ek(a,w(this.pLb,this,d)));a.Te()};p.cancel=function(a){a=["ruid",Ia({}),this.C.C,this.D,this.C.H,a];Zo(Dk(ap(A7(this,this.C.J),"POST"),2),a).Yr().Te()};
function mCi(a,b){var c=["ruid",Ia({}),a.C.C,a.D];c=Zo(Dk(A7(a,a.C.ea),2),c);b&&(Fk(c,w(a.WLb,a,b)),Ek(c,w(a.VLb,a,b)));c.Te()}p.M4b=function(a,b){b=b.Ae();b=new WBi(b[0]);a(b)};p.pLb=function(a){var b=new WBi;L(b,1,!1);a(b)};p.WLb=function(a,b){b=b.Ae();b=new gCi(b[0]);a(b)};p.VLb=function(a){var b=new gCi;L(b,1,!1);a(b)};p.N4b=function(a,b){b=b.Ae();b=new iCi(b[0]);a(b)};p.ySb=function(a){var b=new iCi;L(b,1,!1);a(b)};
function nCi(a,b){var c=["ruid",Ia({}),a.C.C,a.D];Ek(Fk(Zo(Dk(A7(a,"/scripts/getitems"),1),c),w(a.yJb,a,b)),za).Te()}p.yJb=function(a,b){b=b.Ae();b=new $Bi(b[0]);a(b)};function oCi(a,b,c,d){function e(h,k){k=k.Ae();k=new jCi(k[0]);h(k)}var f=["ruid",Ia({}),a.C.C,a.D];null!=b.D&&f.push("storeitemid",b.D);null!=b.C&&f.push("appid",b.C);d&&f.push("versioninfo",d);b=Zo(ap(A7(a,"/scripts/uninstallitem"),"POST"),f).Yr();c&&(Fk(b,w(e,a,c)),a=new jCi,L(a,1,!1),Ek(b,Ja(c,a)));b.Te()}
p.hOa=function(a,b,c,d,e,f){a=["ruid",Ia({}),this.C.C,this.D,this.C.D,e,"extensionid",a,"justInstalled",d];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);f&&a.push("versioninfo",f);b=Zo(Dk(ap(A7(this,"/scripts/enableitem"),"POST"),1),a).Yr();c&&(Fk(b,w(this.IHb,this,c)),Ek(b,w(this.HHb,this,c)));b.Te()};p.IHb=function(a,b){b=b.Ae();b=new JBi(b[0]);a(b)};p.HHb=function(a){var b=new JBi;L(b,1,!1);a(b)};
p.fjb=function(a,b,c,d){a=["ruid",Ia({}),this.C.C,this.D,this.C.D,d,"extensionid",a];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);b=Zo(Dk(ap(A7(this,"/scripts/disableitem"),"POST"),1),a).Yr();c&&(Fk(b,w(this.iGb,this,c)),Ek(b,w(this.hGb,this,c)));b.Te()};p.iGb=function(a,b){b=b.Ae();b=new IBi(b[0]);a(b)};p.hGb=function(a){var b=new IBi;L(b,1,!1);a(b)};function A7(a,b){return $o(a.F.Se(b)).setTimeout(4E4)}
function lCi(a,b,c,d,e,f,h,k,m,n,q,t,u,z,E,N,P,R){B.call(this);this.C=a||"id";this.F=c||"lib";this.O=d||"func";this.D=e||"ctx";this.H=f||"pid";this.xa=N||"eei";this.Aa=P||"usit";this.ma=void 0!==R?R:"did";this.L=h||"ca";this.R=k||"/scripts/invoke";this.J=m||"/scripts/cancel";this.ea=n||"/scripts/libraries";this.Ba=q||"/scripts/resume";this.Ha=u||"/scripts/uiready"}v(lCi,B);function pCi(a,b,c,d,e,f,h,k,m,n,q,t){B.call(this);var u=this;this.Ha=n?r8b(n):void 0;this.Ba=n?s8b(n):void 0;this.Aa=a;this.C=d;this.La=e;this.xa=b;this.O=f;this.F=h;this.L=k;this.D=[];this.H=m;this.J=new Ks("mae-show_addons_menu_promo");Ls(c,this.J,"mae-show_addons_menu_promo");this.ma=q||null;this.ea=t||null;this.R=new VBi(this.Aa,this.xa,this,function(z){if(z=u.getExtension(z)){var E=2==u.H?!1:1==u.H?!(!zi(z,10)||!zi(z,9)):!0;z=new MBi(z,E)}else z=void 0;return z},this.Ba,this.Ha);this.qa(this.R);
O("macros-extension-store-install").wb(vp,this.bIb,this);O("macros-extension-store-install").Na(!0);O("macros-extension-store-render").wb(vp,this.cIb,this);O("macros-extension-store-render").Na(!0);O("macros-extension-store-report").wb(vp,this.dIb,this);O("macros-extension-store-report").Na(!0);O("macros-extension-store-settings").wb(vp,this.eIb,this);O("macros-extension-store-settings").Na(!0);O("macros-extension-store-uninstall-item").wb(vp,this.fIb,this);O("macros-extension-store-uninstall-item").Na(!0);
O("macros-extension-store-use-in-doc").wb(vp,this.gIb,this);O("macros-extension-store-use-in-doc").Na(!0)}v(pCi,B);p=pCi.prototype;p.cIb=function(){qCi(this)};p.bIb=function(a){a=a.data;rCi(this,a.C,a.D,a.getVersionInfo())};p.dIb=function(a){a=this.getExtension(a.data);var b=z7(a);this.Q6a(b,y7(a),a.getName(),J(a,6)||void 0,J(a,11)||void 0)};p.eIb=function(a){a=this.getExtension(a.data);sCi(this,y7(a))};p.fIb=function(a){a=a.data;var b=this.getExtension(a.C),c=b&&y7(b);b=z7(b);tCi(this,c,b,za,a.getVersionInfo())};
p.gIb=function(a){var b=this.getExtension(a.data);a=z7(b);zi(b,4)||zi(b,12)?uCi(this,y7(b),a,function(c){c&&(L(b,4,!1),L(b,12,!1))}):vCi(this,y7(b),a,function(c){c&&L(b,4,!0)})};p.hW=function(a){var b=wCi(this,!1),c=this.R;var d=c.D;a=TBi(d,d.C,b,a,!1);d=UBi(d,a);c.C=d;d=c.C;c.F.Qh(d);d.setVisible(!0);xCi(this)};function wCi(a,b){return(void 0===b?0:b)?a.D.map(function(c){return z7(c)}):a.D.filter(function(c){return zi(c,10)&&zi(c,9)}).map(function(c){return z7(c)})}
function sCi(a,b){yCi(a.C);var c=w(function(d,e){this.C.gO();d&&d(e)},a,void 0);fje(a.O.C,w(a.F.UYa,a.F,b,"doSettings",a.L().getState()||void 0,c))}function vCi(a,b,c,d){yCi(a.C);fje(a.O.C,w(a.F.hOa,a.F,b,c,w(function(e,f){if(f.Er()){var h=a.getExtension(c);h&&L(h,4,!0);qCi(a)}a.C.gO();e&&e(f.Er())},a,d),void 0,a.L().getState()||void 0))}
function uCi(a,b,c,d){yCi(a.C);fje(a.O.C,w(a.F.fjb,a.F,b,c,w(function(e,f){if(f.Er()){O("macros-extension-disabled").pb(b);var h=a.getExtension(c);h&&(L(h,4,!1),L(h,12,!1));qCi(a)}a.C.gO();e&&e(f.Er())},a,d),a.L().getState()||void 0))}function tCi(a,b,c,d,e){oCi(a.F,c,w(function(f,h){if(h.Er()&&b){O("macros-extension-disabled").pb(b);var k=a.D.findIndex(function(m){return HBi(c,m)});-1!=k&&ud(a.D,k);(k=zCi(a.C))&&ge(k.J,b)}qCi(a,function(){return f(h.Er())})},a,d),e)}
p.Q6a=function(a,b,c,d,e){e?mr(e):(ACi(this.C,w(function(f,h){var k=this.F,m=w(this.C.Mtc,this.C,c,h,d),n=w(this.C.Ltc,this.C);f=["ruid",Ia({}),k.C.C,k.D,k.C.F,b,"issuedesc",f,"includeUserInfo",h];null!=a.D&&f.push("storeitemid",a.D);null!=a.C&&f.push("appid",a.C);Zo(Ek(Fk(Dk(ap(A7(k,"/scripts/sendissuereport"),"POST"),1),se(m)),se(n)),f).Yr().Te()},this),c),xCi(this))};
function rCi(a,b,c,d){yCi(a.C);fje(a.O.C,w(a.F.hOa,a.F,b,c,function(e){a.C.gO();e.Er()?qCi(a):(e=Gu("Unable to install add-on","warning",!0),a.C.C.C.postMessage(e),e.getId(),BCi(a))},!0,a.L().getState()||void 0,d))}function qCi(a,b){b=void 0===b?za:b;nCi(a.F,w(function(c,d){d=d.Sfa();pd(this.D);d=ha(d);for(var e=d.next();!e.done;e=d.next())this.D.push(e.value);CCi(this);BCi(this);c()},a,b))}
function CCi(a){var b=a.La,c=wd(a.D);b.C[1]={};b.C[0]={};for(var d=0;d<c.length;++d){var e=c[d],f=y7(e),h=new zBi,k=String(Ia(h));L(h,1,k);h.Lk(e.getName());k=y7(e);L(h,4,k);h.Na(!0);k=e.getName();L(h,10,k);L(h,11,1);k=!(!zi(e,10)&&!zi(e,9));e=new XBi(h,[],!0,k,zi(e,19)||!1);e.setVisible(!0);b.C[K(e.C,11,0)][f]=e}b.dispatchEvent("Hl");if(b=a.C.O)if(od(a.D))!a.J.getValue()&&O("macros-extension-menu-promo").isEnabled()&&(a=a.Aa,Uk(b.F.F,"mae-promo-id")||(a=new DCi(a),a.render(),c=new pt(""),c.Dc("mae-promo-id"),
c.hc("script-promo-menu-item"),c.setContent(a.getElement()),bu(b.O,c,O("macros-extension-menu-promo"),void 0,void 0,OBi(3)),b.C.Pc(),b.F.Pc(),ECi(b.F,c)),FCi(b));else{c=wd(a.D);if(b.J){Cd(c,b.La);f=new Tk;Fya(f,b.C.F);b.F.Pc();b.C.Pc();d=[];for(e=0;e<c.length;++e){k=c[e];var m=y7(k),n=!(!zi(k,10)&&!zi(k,9));d.push(m);h=f.get(m);var q=zi(k,19);if(h)m=h.zb(),n&&!q&&(n=m.Ic(0),q="addon-menu-install-"+y7(k),n&&n.getId()==q&&(m.xn(0).dispose(),2==m.Qb()&&(m.Ic(0),m.xn(0).dispose())));else{h=new At("");
h.Dc(m);h.Na(2==b.R?!1:1==b.R?!!(k&&zi(k,10)&&zi(k,9)):!0);var t=new ut;n||q||GCi(b,t,k);HCi(b,t,m,[],k);h.Be(t)}k=k.getName();n=pm("span");n.appendChild(qm(k));h.setContent(n);ECi(b.C,h)}for(e=0;e<b.ea.length;++e)ECi(b.C,f.get(b.ea[e]));if(b.L)for(f=f.Ye(),e=0;e<f.length;++e)if(0>d.indexOf(f[e])&&0>b.ea.indexOf(f[e])&&(h=b.xa[f[e]])){for(k=0;k<h.length;++k)b.L.JU(h[k]);delete b.xa[f[e]]}O("macros-manage-extensions").Na(!!c.length);FCi(b)}a.ea&&a.ea.C(!!a.D.length)}}
function BCi(a){var b=zCi(a.C);if(b){var c=wd(a.D),d=a.H;b.C=[];for(var e=0;e<c.length;e++){var f=c[e];if(zi(f,12)||zi(f,4))Fd(b.C,f,b.Fnb),b.H&&!zi(f,12)&&(b.H=!1)}O("macros-addon-sidebar-focus").Na(0<b.C.length);b.ea=0==d;b.O=!0;b.L=1==b.C.length&&null!=ICi(b);b.ub()&&JCi(b);a.ma&&a.ma.C(0<b.C.length)}}p.getExtension=function(a){return this.D.find(function(b){return HBi(a,b)})};function KCi(a,b){return a.D.find(function(c){return y7(c)===b})}
function xCi(a){if(!a.J.getValue()&&(a.J.setValue(!0),od(a.D))){var b=a.C.O;if(b){var c=im("docs-menu-superscript",b.H.getElement());c&&Xq(c,0);b.F.Pc();FCi(b);CCi(a)}}};function LCi(a,b,c,d,e,f,h,k,m,n,q,t,u){this.H=a;this.O=b;this.L=c;this.ea=d;this.R=e;this.Aa=h;this.D=k;this.C=m;this.J=n;this.ma=q;this.xa=t;this.F=u}function MCi(a,b){a=a.L;if(b){a=new pl(a);var c=a.F;c+=Jd(c,"/")?"":"/";Jd(c,"/start/")&&(c=c.replace("start/",""));c+=Rga("d/%s/edit",b);tl(a,c);a=a.toString()}return a};function NCi(a){I(this,a,0,-1,null,null)}x(NCi,H);NCi.prototype.V=function(){var a=new D;OCi(this,a);return Y(a)};function OCi(a,b){var c=J(a,1);null!=c&&b.Da(1,c);c=J(a,2);null!=c&&b.Da(2,c);c=J(a,3);null!=c&&fi(b,3,c);c=J(a,4);null!=c&&b.Da(4,c)};function PCi(a){I(this,a,0,-1,null,null)}x(PCi,H);PCi.prototype.V=function(){var a=new D;QCi(this,a);return Y(a)};function QCi(a,b){var c=J(a,1);null!=c&&b.Da(1,c);c=J(a,2);null!=c&&b.Da(2,c);c=J(a,3);null!=c&&b.Da(3,c);c=J(a,5);null!=c&&gi(b,5,c);c=J(a,6);null!=c&&G(b,6,c);c=M(a,NCi,7);null!=c&&b.va(7,c,OCi);c=J(a,8);null!=c&&G(b,8,c);c=J(a,9);null!=c&&gi(b,9,c);c=J(a,10);null!=c&&gi(b,10,c);c=J(a,11);null!=c&&gi(b,11,c)};function RCi(a){I(this,a,"paep",-1,null,null)}x(RCi,H);RCi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Da(1,b);b=J(this,2);null!=b&&a.Da(2,b);b=M(this,PCi,3);null!=b&&a.va(3,b,QCi);b=J(this,4);null!=b&&F(a,4,b);return Y(a)};RCi.messageId="paep";RCi.prototype.getUrl=function(){return J(this,1)};RCi.prototype.Tf=function(){return J(this,2)};function SCi(a){Fl.call(this,"paep");this.D=new RCi(a)}v(SCi,x7);SCi.prototype.C=g("D");function TCi(a){I(this,a,0,-1,null,null)}x(TCi,H);TCi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&G(a,1,b);b=J(this,2);null!=b&&a.Da(2,b);b=J(this,3);null!=b&&F(a,3,b);b=J(this,4);null!=b&&a.Da(4,b);return Y(a)};TCi.prototype.yj=function(){return J(this,2)};function UCi(a){I(this,a,"rfep",-1,null,null)}x(UCi,H);UCi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Da(1,b);b=J(this,2);null!=b&&a.Da(2,b);b=J(this,4);null!=b&&a.Da(4,b);b=J(this,5);null!=b&&a.Da(5,b);return Y(a)};UCi.messageId="rfep";UCi.prototype.getFunctionName=function(){return J(this,2)};UCi.prototype.vr=function(){return J(this,5)};function VCi(a){Fl.call(this,"rfep");this.D=new UCi(a)}v(VCi,x7);VCi.prototype.C=g("D");function WCi(a){I(this,a,"sfep",-1,null,null)}x(WCi,H);WCi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Da(1,b);b=J(this,2);null!=b&&G(a,2,b);b=J(this,3);null!=b&&a.Da(3,b);return Y(a)};WCi.messageId="sfep";WCi.prototype.kF=function(){return J(this,2)};WCi.prototype.Tf=function(){return J(this,3)};function XCi(a){Fl.call(this,"sfep");this.D=new WCi(a)}v(XCi,x7);XCi.prototype.C=g("D");function YCi(a){I(this,a,"step",-1,null,null)}x(YCi,H);YCi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Da(1,b);b=J(this,2);null!=b&&F(a,2,b);return Y(a)};YCi.messageId="step";YCi.prototype.c6=function(){return zi(this,2)};function ZCi(a){Fl.call(this,"step");this.D=new YCi(a)}v(ZCi,x7);ZCi.prototype.C=g("D");function $Ci(a){I(this,a,"scpep",-1,null,null)}x($Ci,H);$Ci.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};$Ci.messageId="scpep";function aDi(a){Fl.call(this,"scpep");this.D=new $Ci(a)}v(aDi,x7);aDi.prototype.C=g("D");function bDi(a){I(this,a,"saep",-1,null,null)}x(bDi,H);bDi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Da(1,b);b=J(this,2);null!=b&&a.Da(2,b);b=J(this,3);null!=b&&a.Da(3,b);b=J(this,4);null!=b&&a.Ja(4,b);b=J(this,5);null!=b&&a.Ja(5,b);b=J(this,6);null!=b&&G(a,6,b);b=J(this,7);null!=b&&a.Da(7,b);b=J(this,8);null!=b&&F(a,8,b);b=M(this,PR,9);null!=b&&a.va(9,b,$se);return Y(a)};bDi.messageId="saep";p=bDi.prototype;p.getTitle=function(){return J(this,2)};
p.setTitle=function(a){return L(this,2,a)};p.getWidth=function(){return J(this,4)};p.setWidth=function(a){return L(this,4,a)};p.getHeight=function(){return J(this,5)};p.setHeight=function(a){return L(this,5,a)};p.Bx=function(){return vi(this,6)};function cDi(a){Fl.call(this,"saep");this.D=new bDi(a)}v(cDi,x7);cDi.prototype.C=g("D");function dDi(a){I(this,a,"snep",-1,null,null)}x(dDi,H);dDi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&G(a,1,b);b=J(this,2);null!=b&&a.Da(2,b);b=J(this,3);null!=b&&a.Da(3,b);b=J(this,4);null!=b&&a.Ua(4,b);return Y(a)};dDi.messageId="snep";p=dDi.prototype;p.getType=function(){return K(this,1,0)};p.setType=function(a){return L(this,1,a)};p.clearType=function(){return L(this,1,void 0)};p.hasType=function(){return vi(this,1)};p.getText=function(){return J(this,2)};
p.hasText=function(){return vi(this,2)};p.getTitle=function(){return J(this,3)};p.setTitle=function(a){return L(this,3,a)};function eDi(a){Fl.call(this,"snep");this.D=new dDi(a)}v(eDi,x7);eDi.prototype.C=g("D");function fDi(a){I(this,a,"spep",-1,gDi,null)}x(fDi,H);var gDi=[4];fDi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Da(1,b);b=J(this,2);null!=b&&a.Da(2,b);b=J(this,3);null!=b&&a.Da(3,b);b=J(this,4);0<b.length&&li(a,4,b);b=J(this,5);null!=b&&F(a,5,b);b=J(this,6);null!=b&&F(a,6,b);b=J(this,7);null!=b&&a.Da(7,b);return Y(a)};fDi.messageId="spep";fDi.prototype.getTitle=function(){return J(this,2)};fDi.prototype.setTitle=function(a){return L(this,2,a)};
fDi.prototype.Df=function(a,b){return Li(this,4,a,b)};function hDi(a){Fl.call(this,"spep");this.D=new fDi(a)}v(hDi,x7);hDi.prototype.C=g("D");function iDi(a){I(this,a,"stbep",-1,null,null)}x(iDi,H);iDi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Da(1,b);b=J(this,2);null!=b&&a.Da(2,b);b=J(this,3);null!=b&&a.Da(3,b);b=J(this,4);null!=b&&a.Da(4,b);b=J(this,5);null!=b&&a.Da(5,b);b=J(this,6);null!=b&&a.Da(6,b);return Y(a)};iDi.messageId="stbep";p=iDi.prototype;p.getFunctionName=function(){return J(this,2)};p.yg=function(){return J(this,3)};p.Lk=function(a){L(this,3,a)};p.getUrl=function(){return J(this,5)};
p.vr=function(){return J(this,6)};function jDi(a){Fl.call(this,"stbep");this.D=new iDi(a)}v(jDi,x7);jDi.prototype.C=g("D");function kDi(a){I(this,a,"sttep",-1,null,null)}x(kDi,H);kDi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Da(1,b);b=J(this,2);null!=b&&a.Da(2,b);return Y(a)};kDi.messageId="sttep";kDi.prototype.getText=function(){return J(this,1)};kDi.prototype.hasText=function(){return vi(this,1)};kDi.prototype.ol=function(){return J(this,2)};kDi.prototype.Wd=function(a){L(this,2,a)};function lDi(a){Fl.call(this,"sttep");this.D=new kDi(a)}v(lDi,x7);lDi.prototype.C=g("D");function mDi(){Pl.call(this);var a=this;this.C=null;this.D=function(b){switch(b[0]){case "amep":b=new DBi(b);a.dispatchEvent(b);break;case "paep":b=new SCi(b);a.dispatchEvent(b);break;case "rfep":b=new VCi(b);a.dispatchEvent(b);break;case "sfep":b=new XCi(b);a.dispatchEvent(b);break;case "step":b=new ZCi(b);a.dispatchEvent(b);break;case "saep":b=new cDi(b);a.dispatchEvent(b);break;case "snep":b=new eDi(b);a.dispatchEvent(b);break;case "spep":b=new hDi(b);a.dispatchEvent(b);break;case "stbep":b=new jDi(b);
a.dispatchEvent(b);break;case "sttep":b=new lDi(b);a.dispatchEvent(b);break;case "scpep":b=new aDi(b),a.dispatchEvent(b)}}}v(mDi,Pl);mDi.prototype.bind=function(a){this.C=a;this.C.subscribe("13",this.D)};mDi.prototype.Ma=function(){this.C&&this.C.unsubscribe("13",this.D);Pl.prototype.Ma.call(this)};function nDi(a,b){Pl.call(this);this.D=new Vl(this);this.qa(this.D);this.C={};this.F=a;this.H=b}v(nDi,Pl);p=nDi.prototype;p.start=function(){this.D.listen(this.H,"sfep",w(this.z0a,this));this.D.listen(this.H,"step",w(this.L4b,this))};function oDi(a,b,c,d){var e=void 0;e=void 0===e?za:e;d=void 0===d?za:d;d=w(a.K4b,a,b,e,d);a=a.F;b=["ruid",Ia({}),a.C.C,a.D,a.C.H,b,a.C.L,c];b=Zo(Dk(ap(A7(a,a.C.Ba),"POST"),2),b).Yr();d&&(Fk(b,w(a.N4b,a,d)),Ek(b,w(a.ySb,a,d)));b.Te()}
p.J4b=function(a,b,c,d,e,f){f.Er()?(a=J(f,2),this.C[a]=new pDi(a,b,d,e),c(a,Bi(f,3,!1))):(b=new WCi,L(b,2,6),e(b))};p.K4b=function(a,b,c,d){d.Er()?b():(c(),b=new WCi,L(b,1,a),L(b,2,6),this.z0a(new XCi(b.Fb())))};p.L4b=function(a){a=a.C();var b=J(a,1);if(ae(this.C,b)){var c=Qea(this.C,b);(0,c.I4b)(a);c.dispose();ge(this.C,b)}};p.z0a=function(a){a=a.C();var b=J(a,1);if(ae(this.C,b)){var c=Qea(this.C,b);(0,c.Wnb)(a);c.dispose();ge(this.C,b)}a="Google Apps Script: "+a.Tf();window.console.log(a)};
p.Ma=function(){Wf(this.C);Pl.prototype.Ma.call(this)};function pDi(a,b,c,d){B.call(this);this.C=b;this.I4b=c;this.Wnb=d}v(pDi,B);pDi.prototype.getFunctionName=g("C");function qDi(a,b){var c=a.oL,d=a.id,e=a.UYb,f=a.Foa,h=a.khb,k=a.YX,m=a.bsa;return T('<div class="'+U(a.uv)+'" aria-labelledby="title'+U(d)+'" tabindex="0"'+(c?' role="complementary"':' role="region"')+'><div class="'+U(e)+'"><div class="'+U(f)+'" id="title'+U(d)+'"></div><div class="'+U(h)+'" tabindex="0" title="'+U("Close sidebar")+'" aria-label="'+U("Close sidebar")+'" role="button">'+Tv({icon:m},b)+'</div></div><div class="'+U(k)+'"></div></div>')}
function rDi(a){a=a.caption;return T('<div class="'+U("docs-script-button-bar-text")+" "+U("docs-titlebar-button")+" "+U("goog-inline-block")+'" tabindex="0">'+vr(a)+"</div>")}function sDi(a){a=a.text;return T('<div class="'+U("docs-script-button-bar-bubble-content")+'">'+vr(a)+"</div>")}
function tDi(a){var b=a.iconName,c=a.title;a=a.description;return T('<div class="'+U("script-promo-menu-item-content")+'"><div class="'+U("script-promo-menu-item-icon")+'" aria-hidden="true"><img src="//ssl.gstatic.com/docs/common/'+U(b)+'.svg"/></div><div class="'+U("script-promo-menu-item-text")+'"><div class="'+U("script-promo-menu-item-title")+'">'+vr(c)+'</div><div class="'+U("script-promo-menu-item-description")+'">'+vr(a)+"</div></div></div>")}
function uDi(a){var b=a.functionName;a=a.AFa;return T('<div class="'+U("func-entry")+'" aria-checked="false" role="radio" tabindex="-1"><div class="'+U("goog-inline-block")+" "+U("func-entry-rb")+'">&nbsp;</div><div class="'+U("goog-inline-block")+" "+U("func-entry-func")+'">'+vr(b)+'</div><div class="'+U("goog-inline-block")+" "+U("func-entry-lib")+'">'+vr(a)+"</div></div>")}
function vDi(a){var b=a.ids,c=a.description;a=a.r_b;var d='<div class="'+U("script-help-dialog-content")+'"><div class="'+U("script-help-dialog-content-left")+" "+U("goog-inline-block")+(a?" "+U("script-help-dialog-content-left-gsm-onhold")+" ":"")+'">';a?(c=d,a='<div class="'+U("script-help-dialog-content-section")+" "+U("script-help-dialog-content-section-gsm-onhold")+'" tabindex="0"><div class="'+U("script-help-dialog-content-title")+'">',d=d={Ada:"script-help-dialog-content-title-caution-icon"},
d=d.Ada,d=T("<div"+(d?' class="'+U(d)+'"':"")+'><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11,15 L13,15 L13,17 L11,17 L11,15 Z M11,7 L13,7 L13,13 L11,13 L11,7 Z M11.99,2 C6.47,2 2,6.48 2,12 C2,17.52 6.47,22 11.99,22 C17.52,22 22,17.52 22,12 C22,6.48 17.52,2 11.99,2 Z M12,20 C7.58,20 4,16.42 4,12 C4,7.58 7.58,4 12,4 C16.42,4 20,7.58 20,12 C20,16.42 16.42,20 12,20 Z" id="path-1"></path></defs><g id="caution" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="alert/error_outline_24px"><mask id="mask-2" fill="white"><use xlink:href="#path-1"></use></mask><g id="ic_error_outline_24px" fill-rule="nonzero"></g><g id="_c/Red/600" mask="url(#mask-2)" fill="#D93025" fill-rule="evenodd"><rect id="swatch" x="0" y="0" width="24" height="24"></rect></g></g></g></svg></div>'),
d=c+(a+d+"<span>Add-on not available in \r\n G Suite Marketplace</span></div><div>The developer of this add-on has not accepted the terms and conditions of G Suite Marketplace.</div></div>")):(d+='<div class="'+U("script-help-dialog-content-section")+'" tabindex="0"><div class="'+U("script-help-dialog-content-title")+'">',d=d+"Getting started</div><div>"+(vr(c)+"</div></div>"));d+='</div><div id="'+U(b.yca)+'" class="'+U("script-help-dialog-buttons")+" "+U("goog-inline-block")+'"></div></div>';return T(d)}
function wDi(a){var b=a.Enb;a='<p class="'+U("script-reportissue-dialog-description-label")+'" tabindex="0">';var c="Describe the issue for the creators of <strong>"+(vr(b)+"</strong>:");a=a+c+('</p><textarea class="'+U("jfk-textinput")+" "+U("script-reportissue-dialog-description")+'"></textarea><p class="'+U("script-reportissue-dialog-disclaimer")+'" tabindex="0">');a=a+'Only this description will be sent, no information from your open document.</p><div class="'+(U("script-reportissue-dialog-nonanonymous")+
'" tabindex="0"><div class="'+U("script-reportissue-dialog-nonanonymous-control")+" "+U("goog-inline-block")+'"><div class="'+U("script-reportissue-dialog-nonanonymous-checkbox")+" "+U("jfk-checkbox")+'"></div></div><div class="'+U("script-reportissue-dialog-nonanonymous-label")+" "+U("goog-inline-block")+'"><div class="'+U("script-reportissue-dialog-nonanonymous-optional-text")+" "+U("goog-inline-block")+'">');a+="(Optional)</div> ";b="Include your name and email address so the creators of <strong>"+
(vr(b)+" </strong>can follow up.");a=a+b+"</div></div>";return T(a)}
function xDi(a,b){a=a||{};a=a.Mb;var c='<div class="'+U("func-actions")+'">';c+=vu({id:"func-action-new",content:zr("New"),style:0},b);c+=vu({id:"func-action-run",content:zr("Run"),style:0,fd:"jfk-button-collapse-right"},b);c+=vu({id:"func-action-edit",content:zr("Edit"),style:0,fd:"jfk-button-collapse-left"},b);c+=vu({id:"func-action-reload",content:zr(""+Tv({icon:a?"docs-icon-img docs-icon-reload-rtl":"docs-icon-img docs-icon-reload"},b)),style:0,width:1,title:"Reload"},b);c+='</div><div class="'+
U("func-header")+'"><div class="'+U("func-header-rb")+" "+U("goog-inline-block")+'"></div><div class="'+U("func-header-func")+" "+U("goog-inline-block")+'">';c=c+'Function</div><div class="'+(U("func-header-lib")+" "+U("goog-inline-block")+'">');c=c+'Script</div></div><div class="'+(U("func-entries")+'" role="radiogroup" tabindex="0"></div>');return T(c)}function yDi(){var a='<div class="'+U("func-loading")+'">';return T(a+"Fetching scripts\u2026</div>")}
function zDi(){var a='<div class="'+U("func-none")+'">';return T(a+"No scripts found</div>")};function ADi(){}v(ADi,Qs);ADi.prototype.Nb=l("func-entry");ADi.prototype.Pg=l(!1);ADi.prototype.Ca=function(a){return sr(uDi,{functionName:a.getFunctionName(),AFa:a.u0b},void 0,a.oa())};Aa(ADi);function BDi(a,b,c,d,e,f){Ts.call(this,null,d||ADi.getInstance(),e);this.PZa=a;this.C=void 0!==f?f:null;this.u0b=b;this.D=c;this.Sf(16,!0);this.Sf(32,!0);Zs(this,16,!0);Vs(this,16,!1)}v(BDi,Ts);BDi.prototype.kq=function(a){Ts.prototype.kq.call(this,a);a&&this.getElement()&&this.getElement().focus()};BDi.prototype.vr=g("C");BDi.prototype.getFunctionName=g("D");BDi.prototype.Sb=function(a){Ts.prototype.Sb.call(this,a);this.Gb(a);this.getElement()&&Fm(this.getElement(),a)};function CDi(a,b){Ev.call(this,void 0,void 0,a);this.O=b||!1;this.Ht=new hZa;this.qa(this.Ht);this.ke=new Ms;this.qa(this.ke);this.H=new wu("");this.qa(this.H);this.C=new wu("");this.qa(this.C);this.F=new wu("");this.qa(this.F);this.L=new wu("");this.qa(this.L);a=new ps(a);a.set("close","Close",!1,!0);os(this,!1);ss(this,a);this.setTitle("Script manager")}v(CDi,Ev);p=CDi.prototype;
p.reset=function(a){this.Ht.clear();this.wd(!0);0===a?(a=sr(yDi,{},void 0,this.oa()),a=new Ts(a),a.Sf(32,!1),this.Ga(a,!0)):1===a&&(a=sr(zDi,{},void 0,this.oa()),a=new Ts(a),a.Sf(32,!1),this.Ga(a,!0))};p.focus=function(){if(this.ub()&&0<this.Ht.$g()){var a=this.Ht.cf();a&&a.kq(!0)}else Ev.prototype.focus.call(this)};p.wd=function(a){a=Ev.prototype.wd.call(this,a);this.Ht.clear();DDi(this);return a};
p.zf=function(a,b,c){Ev.prototype.zf.call(this,a,b,c);a instanceof BDi&&(b=a.isChecked(),this.Ht.Vc(a),1==this.Ht.$g()||b)&&(Lt(this.Ht,a),a.kq(!0));DDi(this)};p.Ca=function(){Ev.prototype.Ca.call(this);var a=this.yb();Ur(a,"script-explorer-contents");qr(a,xDi,{Mb:this.O});a=zm(Am(a));this.H.Va(a[0]);this.F.Va(a[1]);this.C.Va(a[2]);this.L.Va(a[3]);Cs(this,"run")};
p.Ia=function(){Ev.prototype.Ia.call(this);Ns(this.ke,this.yb());DDi(this);this.addEventListener("dialogselect",ne(!0));Jl(this,"action",this.CVa,void 0,this);Jl(this.ke,"key",this.fWa,void 0,this);var a=new qs("new",this.H.getContent());Jl(this.H,"action",w(this.dispatchEvent,this,a));a=new qs("run",this.F.getContent());Jl(this.F,"action",w(this.dispatchEvent,this,a));a=new qs("edit",this.C.getContent());Jl(this.C,"action",w(this.dispatchEvent,this,a));a=new qs("reload",this.L.getContent());Jl(this.L,
"action",w(this.dispatchEvent,this,a))};p.yd=function(){Ev.prototype.yd.call(this);CXa(this.ke);Ml(this,"action",this.CVa,void 0,this);Ml(this.ke,"key",this.fWa,void 0,this);Ol(this.H);Ol(this.F);Ol(this.C);Ol(this.L)};p.yb=function(){var a=Ev.prototype.yb.call(this),b=zm(a);return 0<b.length?b[2]:a};p.CVa=function(a){DDi(this);a.target instanceof BDi&&(Lt(this.Ht,a.target),a.target.kq(!0))};
p.fWa=function(a){var b=this.Ht.$g();if(0<b)switch(a.keyCode){case 38:var c=this.Ht;b=Hk(this.Ht.Ai()-1,b);Lt(c,c.Of(b));a.preventDefault();this.focus();break;case 40:c=this.Ht,b=Hk(this.Ht.Ai()+1,b),Lt(c,c.Of(b)),a.preventDefault(),this.focus()}};function DDi(a){var b=!!a.Ht.cf();a.F.setVisible(b);a.C.setVisible(b)};function EDi(a,b){this.D=a;this.C=b}function FDi(a){a.D.R&&qCi(a.C,function(){if(O("macros-extensions").isEnabled()){a.D.Aa&&!a.D.C&&a.C.hW();var b=a.D.ma;if(b&&(b=a.C.getExtension(new GBi(b))||KCi(a.C,b))){var c=a.C,d=c.C.O;d&&(yCi(c.C),c=w(c.C.gO,c.C),GDi(d,y7(b),c))}}})};function HDi(){B.call(this);this.F=new Tk}v(HDi,Ru);HDi.prototype.C=function(){return this.F.Hd()};function ECi(a,b){a.F.set(b.getId(),b)}HDi.prototype.Pc=function(){this.F.clear()};function DCi(a,b){S.call(this,b);this.C=a}v(DCi,S);
DCi.prototype.Ca=function(){S.prototype.Ca.call(this);var a=this.C==(Du(),Au)?"Do more with Docs":this.C==(Du(),c0a)?"Do more with Forms":this.C==(Du(),Bu)?"Do more with Sheets":this.C==(Du(),Cu)?"Do more with Slides":"Do more with Docs",b=this.C==(Du(),Au)?"Looking for even more Docs features? Get a few add-ons.":this.C==(Du(),c0a)?"Looking for even more Forms features? Get a few add-ons.":this.C==(Du(),Bu)?"Looking for even more Sheets features? Get a few add-ons.":this.C==(Du(),Cu)?"Looking for even more Slides features? Get a few add-ons.":
"Looking for even more Docs features? Get a few add-ons.",c=this.C==(Du(),Au)?"addon_docs_promo":this.C==(Du(),c0a)?"addon_forms_promo":this.C==(Du(),Bu)?"addon_sheets_promo":this.C==(Du(),Cu)?"addon_slides_promo":"addon_docs_promo",d=this.oa();this.Jc(sr(tDi,{title:a,description:b,iconName:c},void 0,d))};function IDi(){}v(IDi,kt);IDi.prototype.Ca=function(a){a=kt.prototype.Ca.call(this,a);Lr(a,"menuitem");return a};IDi.prototype.Nb=l("goog-control");IDi.prototype.Oo=function(a){a=kt.prototype.Oo.call(this,a);a.push("menu-button","goog-inline-block");return a};Aa(IDi);function JDi(a,b,c,d,e){B.call(this);this.O=b;this.R=c;this.H=a;this.D={};this.Aa={};this.xa={};this.ma=[];this.ea=[];this.J=d||null;this.L=e||null;this.C=new HDi;this.F=new HDi;this.Ha=new Vl;this.qa(this.Ha);this.Ba=[]}v(JDi,B);JDi.prototype.Ma=function(){Wf(this.D);B.prototype.Ma.call(this)};JDi.prototype.At=function(a){return ae(this.D,a)};
function KDi(a,b,c){c=c?[c]:Zd(a.D);for(var d=0;d<c.length;d++)for(var e=c[d].zb(),f=0;f<e.Qb();f++){var h=e.Ic(f);if(h instanceof pt&&h.getId()==b||h instanceof At&&(h=KDi(a,b,h)))return h}return null}
function LDi(a,b,c,d,e){if(J(b,3)){var f=zi(b,7)||!1,h=b.yg(),k=J(b,10),m=new pt("");m.Dc(b.Ie()||String(Ia(m)));var n=[qm(h)];d&&b.getKey()&&(d+=b.getKey().toUpperCase(),d=TZa(m,O("macros-exec"),[d]),a.ma.push(d),n.push(d));m.setContent(n);b=new yBi(J(b,4),J(b,3),void 0,J(b,9)||void 0,void 0,b.vr()||void 0);bu(a.O,m,O("macros-exec"),null,ne(b),OBi(3,e));m.Na(f);a.L&&f&&k&&(e=h+(" ("+(k+")")),c.push(a.L.Ls(O("macros-exec"),[b],ne(e),ne(e))[0]));return m}if(!b.yg())return new tt;if(0<b.uh().length){m=
new ut;f=b.uh();for(h=0;h<f.length;h++)m.Ga(LDi(a,f[h],c,d,e),!0);a=new At(b.yg());a.Dc(b.Ie()||String(Ia(a)));a.Be(m);return a}throw Error("Unsupported menu item type.");}JDi.prototype.La=function(a,b){return Md(a.getName(),b.getName())};function HCi(a,b,c,d,e){if(b.Aia()){var f=new zBi,h=String(Ia(f));L(f,1,h);b.Ga(LDi(a,f,d),!0)}d=new pt("Help");d.Dc(String(Ia(d)));bu(a.O,d,O("macros-extension-help"),null,ne(c),OBi(3,e));d.Na(!0);b.Ga(d,!0)}
function GCi(a,b,c){var d=new pt("");d.Dc("addon-menu-install-"+y7(c));bu(a.O,d,O("macros-extension-install-start"),eu,ne(y7(c)),OBi(3,c));d.Na(!0);b.Ga(d,!0)}function FCi(a){R2a(a.J,"docs-macros-extension-promo")||Wu(a.J,"docs-macros-extension-promo",[a.F,null]);R2a(a.J,"docs-macros-extensions")||Wu(a.J,"docs-macros-extensions",[a.C]);a.J.zb("docs-extensions-menu",!0)}
function GDi(a,b,c){var d=c||za;(c=a.C.F.get(b))?-1===a.Ba.indexOf(b)?(b=Gn(w(function(e){e.dispatchEvent("load")},a,c),1E4),b=w(function(e,f,h){this.H.R9("docs-extensions-menu");e.Cg(!0);e.lH();Hn(h);f()},a,c,d,b),a.Ha.Qc(c,"load",b)):(a.H.R9("docs-extensions-menu"),c.hI(),c.Cg(!0),c.lH(),d()):d()};function MDi(a,b){var c=a.bsa,d=a.oL;a='<div class="'+U(a.uv)+'" aria-labelledby="addon-sidebar-title" tabindex="0"'+(d?' role="complementary"':' role="region"')+'><div class="'+U("addon-sidebar-header")+'"><div class="'+U("addon-sidebar-title")+'" id="addon-sidebar-title">';a+="Document add-ons";c=zr(""+Tv({icon:c},b));a+="</div>"+vu({fd:"addon-sidebar-close docs-material",content:c,style:4,title:"Close sidebar"},b)+'</div><div class="'+U("addon-sidebar-content")+'"><div class="'+U("addon-sidebar-banner")+
'"></div><div class="'+U("addon-sidebar-introduction")+'"></div></div><div class="'+U("addon-sidebar-empty-caption")+'"><div class="'+U("addon-sidebar-empty-title")+'">';a=a+'No document add-ons</div><div class="'+(U("addon-sidebar-empty-description")+'">');return T(a+"This document doesn't include any add-ons</div></div></div>")}
function NDi(a){var b=a.xfb;a=a.ufb;return T('<img class="'+U("addon-sidebar-banner-image")+'" src='+cU(Dr(b))+" alt="+cU(a)+' /><div class="'+U("addon-sidebar-banner-image-overlay")+'"></div>')};function ODi(a){var b=a.icon,c=a.title,d=a.category,e=a.summary,f=a.isInstalled,h=a.Dwc;a=T;b='<div class="'+U("addon-sidebar-card")+'" aria-label="'+U(c)+'" tabindex="0" role="region"><div class="'+U("addon-sidebar-card-header")+'"><div class="'+U("addon-sidebar-card-icon")+'">'+(b?'<img class="'+U("addon-sidebar-card-icon-image")+'" src='+cU(Dr(b))+" alt="+cU(c)+" />":"")+'</div><div class="'+U("addon-sidebar-card-header-content")+'"><div class="'+U("addon-sidebar-card-title")+'"><div class="'+
U("addon-sidebar-card-title-caption")+(h?" "+U("addon-sidebar-card-two-line-title-caption"):"")+'">'+vr(c)+"</div>";f?(c=c={Ada:"addon-sidebar-card-check",color:"#455A64"},f=c.Ada,c=c.color,f=T("<div"+(f?' class="'+U(f)+'"':"")+'><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 48 48" fill="'+U(null!=c?c:"#000")+'"><path d="M0 0h48v48H0z" fill="none"/><path d="M24 4C12.95 4 4 12.95 4 24c0 11.04 8.95 20 20 20 11.04 0 20-8.96 20-20 0-11.05-8.96-20-20-20zm-4 30L10 24l2.83-2.83L20 28.34l15.17-15.17L38 16 20 34z"/></svg></div>')):
f="";return a(b+f+'</div><div class="'+U("addon-sidebar-card-category")+'">'+vr(d)+"</div></div></div>"+(e?'<div class="'+U("addon-sidebar-card-summary")+'">'+vr(e)+"</div>":"")+"</div>")};function PDi(){}v(PDi,QC);PDi.prototype.Nb=l("docs-material-menu-button-flat-primary");PDi.prototype.Eo=function(){return sr(Njc,{className:"docs-material-menu-button-flat-primary-dropdown"})};Aa(PDi);function QDi(a,b,c,d,e){c=void 0===c?PDi.getInstance():c;Bt.call(this,a,b,c,d,e)}v(QDi,Bt);function RDi(){}v(RDi,QC);RDi.prototype.Nb=l("docs-material-menu-button-raised-primary");RDi.prototype.Eo=function(){return sr(Njc,{className:"docs-material-menu-button-raised-primary-dropdown"})};Aa(RDi);function SDi(a,b,c,d,e){c=void 0===c?RDi.getInstance():c;Bt.call(this,a,b,c,d,e)}v(SDi,Bt);function TDi(a,b,c,d,e){B.call(this);this.D=a;this.C=b;this.F=c;this.H=d;this.bb=e||bm()}v(TDi,B);
function UDi(a,b){if(!b)return VDi(a);b=b.uh();if(1==b.length&&J(b[0],3)){var c=VDi(a);b=b[0];c.Na(!!zi(b,7));b=new yBi(J(b,4),J(b,3),void 0,J(b,9)||void 0);bu(a.D,c,O("macros-exec"),{enabled:!0},ne(b),a.F);return c}c=new ut(a.bb);for(var d=0;d<b.length;d++)c.Ga(WDi(a,b[d]),!0);b=[qm("Use")];a=a.C?new SDi(b,c,void 0,a.bb):new QDi(b,c,void 0,a.bb);a.ze("Use");a.hc("addon-sidebar-card-menu-button");a.Na(!0);return a}
function WDi(a,b){if(J(b,3)){var c=b.yg(),d=new pt("");d.hc(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");d.setContent([qm(c)]);c=new yBi(J(b,4),J(b,3),void 0,J(b,9)||void 0);bu(a.D,d,O("macros-exec"),{enabled:!0},ne(c),a.F);d.Na(!!zi(b,7));return d}if(!b.yg())return new tt;if(0<b.uh().length){d=new ut(a.bb);c=b.uh();for(var e=0;e<c.length;e++)d.Ga(WDi(a,c[e]),!0);b=new At(b.yg());b.hc(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");
b.Be(d);return b}throw Error("Unsupported menu item type.");}function VDi(a){var b=[qm("Use")];a=a.C?new Gtf(b,a.bb):new CO(b,a.bb);a.ze("Use");a.hc("addon-sidebar-card-button");a.Na(!1);return a};function XDi(a,b,c,d,e){S.call(this,e);this.C=a;this.ma=b;this.R=zi(this.C,19)||!1;this.H=!(!zi(this.C,10)&&!zi(this.C,9));this.L=new $t(void 0,void 0,!0,dw.getInstance());this.qa(this.L);this.ea=OBi(10,this.C);this.J=new Ts(void 0,void 0,e);this.qa(this.J);this.F=new TDi(this.L,c,this.ea,d,e);this.qa(this.F);if(this.H)a=UDi(this.F);else{a=this.F;b=this.C;a:switch(a.H){case Du(),Au:c="Add to Docs";break a;case Du(),Cu:c="Add to Slides";break a;case Du(),Bu:c="Add to Sheets";break a;default:throw Error("Unsupported document type");
}d=[qm(c)];d=a.C?new Gtf(d,a.bb):new CO(d,a.bb);d.ze(c);d.hc("addon-sidebar-card-button");d.Na(!1);bu(a.D,d,O("macros-extension-install-start"),{enabled:!0},ne(y7(b)),a.F);a=d}this.D=a;a=this.F;b=this.C;c=new CO([qm("Help")],a.bb);c.ze("Help");c.hc("addon-sidebar-card-button");c.Na(!1);c.Wd("Help");bu(a.D,c,O("macros-extension-help"),{enabled:!0},ne(y7(b)),a.F);this.O=c}v(XDi,S);
XDi.prototype.Ca=function(){S.prototype.Ca.call(this);var a=J(this.C,15)||"";a&&(a=ql(new pl(a),"https").toString());var b=this.oa();a={icon:a,title:this.C.getName(),category:this.C.Kj(),isInstalled:this.H,summary:J(this.C,14),Dwc:If};b=sr(ODi,a,void 0,b);this.jb(b);this.Jc(b)};XDi.prototype.Jc=function(a){S.prototype.Jc.call(this,a);a=this.Ea("addon-sidebar-card-title-caption");Lr(a,"button");this.Ga(this.J);this.J.Va(a)};
XDi.prototype.Ia=function(){S.prototype.Ia.call(this);bu(this.L,this.J,O("macros-manage-extensions"),{},ne(z7(this.C)),this.ea);YDi(this);!this.H&&this.R&&(this.Ga(this.O,!0),this.O.Na(!0))};XDi.prototype.Ma=function(){Vf(this.D);Vf(this.O);S.prototype.Ma.call(this)};function ZDi(a,b){a.H&&(a.D.getParent()==a&&a.removeChild(a.D,!0),Vf(a.D),a.D=UDi(a.F,b),a.ub()&&YDi(a))}
function YDi(a){a.Ga(a.D,!0);a.H||(a.D.Na(a.ma&&!a.R),a.ma?a.R&&a.D.Wd("Add-on not available in G Suite Marketplace"):a.D.Wd("Disabled for your organization"))};function $Di(a,b,c){iR.call(this,c);this.D={};this.C=[];this.ea=!1;this.H=a;this.ma=b;this.J={};this.F=new KJ(this.oa(),"addon-sidebar-spinner");this.Ga(this.F);this.R=new wu(void 0,this.oa());this.L=this.O=!1}v($Di,iR);p=$Di.prototype;p.Ca=function(){iR.prototype.Ca.call(this);var a={uv:"addon-sidebar",bsa:Qp("close-white"),oL:y(A(),"docs-eal")};a=sr(MDi,a,void 0,this.oa());this.jb(a);this.Jc(a)};
p.Jc=function(a){iR.prototype.Jc.call(this,a);this.F.render(this.yb());a=this.F.Ka();Qr(a,"Loading");Lr(a,"status");Nr(a,"live","polite")};p.Ia=function(){iR.prototype.Ia.call(this);aEi(this,!1);bEi(this,!1);this.R.Va(this.Ea("addon-sidebar-close"));this.getHandler().vf(this.R.Ka(),Ll,w(this.A0a,this)).listen(this.getElement(),"keyup",this.hVb);this.O&&JCi(this)};p.yb=function(){return this.$a("addon-sidebar-content")};
function JCi(a){a.F.setVisible(!1);bEi(a,a.H);aEi(a,0==a.C.length);cEi(a,a.L);dEi(a);dd(a.C,function(b){var c=y7(b);b=new XDi(b,this.ea,this.L,this.ma,this.oa());ZDi(b,this.J[c]);this.Ga(b,!0);this.D[c]=b},a)}function dEi(a){Ud(a.D,function(b){this.removeChild(b,!0);Vf(b)},a);fe(a.D)}function aEi(a,b){if(a.ub()){var c=a.Ea("addon-sidebar-empty-caption");Q(c,b)}b&&bEi(a,!1)}
function bEi(a,b){if(a.ub()){var c=a.Ea("addon-sidebar-introduction");b&&!Gm(c)&&Em(c,1<a.C.length?"This template is optimized to work with these add-ons":"This template is optimized to work with this add-on");Q(c,b)}}function ICi(a){return 0==a.C.length?null:(a=J(a.C[0],16)||J(a.C[0],17))?ql(new pl(a),"https").toString():null}
function cEi(a,b){if(a.ub()){Yr(a.getElement(),"addon-sidebar-with-banner",b);var c=a.Ea("addon-sidebar-banner");b?(b=ICi(a))&&qr(c,NDi,{xfb:b,ufb:a.C[0].getName()}):tm(c)}}p.Fnb=function(a,b){return Md(a.getName(),b.getName())};p.hVb=function(a){27==a.keyCode&&(this.getElement()==a.target&&this.A0a(),a.stopPropagation())};p.A0a=function(){this.setVisible(!1);bEi(this,!1);this.H=!1;O("docs-focus-editor").pb()};p.Pg=l(!1);function eEi(a,b){vR.call(this,a,b)}v(eEi,vR);eEi.prototype.Mo=function(){return O("macros-addon-sidebar-focus")};eEi.prototype.Uf=function(){return O("macros-addon-sidebar")};eEi.prototype.Ks=function(a){var b=this.Mc;b.ub()||b.render();vR.prototype.Ks.call(this,a)};eEi.prototype.B8a=function(a){a&&this.Uf().isVisible()&&this.Ks(!0)};function fEi(a,b,c){this.F=a;this.D=b;this.C=c;Object.defineProperties(this,{path:{get:w(this.y4b,this),set:w(this.ysc,this)},invoke:{get:w(this.aub,this),set:w(this.usc,this)},arity:{get:w(this.Yob,this),set:w(this.Yrc,this)}})}p=fEi.prototype;p.y4b=g("F");p.ysc=da("F");p.aub=g("D");p.usc=da("D");p.Yob=g("C");p.Yrc=da("C");function gEi(a,b,c,d,e){S.call(this,e);this.L=a;this.H=b;this.F=c;this.C=d}v(gEi,S);
gEi.prototype.Ca=function(){var a=Zc(A(),"docs-tfh"),b=this.L;a&&(b=Ae(b,{allow_parent:a}));a=wWa(this.oa());df(a,b);a.width="100%";a.height="100%";a.marginWidth="0";a.marginHeight="0";a.scrolling="no";a.allow="accelerometer ambient-light-sensor autoplay camera encrypted-media fullscreen geolocation gyroscope magnetometer microphone midi payment picture-in-picture speaker usb vr".split(" ").map(function(c){return c+" *;"}).join(" ");this.jb(a);ua("payload",this.H,a);ua("adapter.hostFunctions",this.F,
a);Qa("adapter.getSessionId",w(this.D,this),a);Qa("adapter.getState",w(this.J,this),a)};gEi.prototype.Pg=l(!1);gEi.prototype.D=function(){var a=this.C().C;return null!==a?String(a):null};gEi.prototype.J=function(){return this.C().getState()};function hEi(a,b,c,d,e,f,h,k,m){Ev.call(this,void 0,void 0,m);var n=w(this.setVisible,this,!1),q=w(this.H,this),t=w(this.F,this);e&&this.setTitle(e);this.Og=f||500;this.We=h||300;this.C=new gEi(a,b,[new fEi("google.script.host.close",n,0),new fEi("google.script.host.closeDialog",n,0),new fEi("google.script.host.editor.focus",w(d.Cb,d,3),0),new fEi("google.script.host.setWidth",q,1),new fEi("google.script.host.setHeight",t,1)],c,m);this.Ga(this.C);os(this,!!k);ss(this,null)}v(hEi,Ev);
hEi.prototype.H=function(a){!isFinite(a)||0>a||Tq(this.yb(),Math.min(a,Math.floor(.8*km().width)))};hEi.prototype.F=function(a){!isFinite(a)||0>a||Uq(this.yb(),Math.min(a,Math.floor(.8*km().height)))};hEi.prototype.Ca=function(){Ev.prototype.Ca.call(this);Ur(this.getElement(),"script-app-dialog");var a=this.yb();Ur(a,"script-app-contents");Tq(a,Math.min(this.Og,Math.floor(.8*km().width)));Uq(a,Math.min(this.We,Math.floor(.8*km().height)));this.C.render(a)};hEi.prototype.Pg=l(!1);function iEi(a){iR.call(this,a);this.C=this.F=this.D=this.H=null}v(iEi,iR);p=iEi.prototype;p.Aka=function(){this.C&&(this.removeChild(this.C,!0),this.C.dispose(),this.C=null);this.setVisible(!1)};p.focus=function(){this.C.getElement().focus()};p.yb=g("F");
p.Ca=function(){var a=this.oa(),b={id:this.getId(),uv:"script-application-sidebar",UYb:"script-application-sidebar-header",Foa:"script-application-sidebar-title",khb:"script-application-sidebar-close",YX:"script-application-sidebar-content",bsa:Qp("close-white"),oL:y(A(),"docs-eal")};b=sr(qDi,b,void 0,a);this.jb(b);this.H=a.$a("script-application-sidebar-title",b);this.D=a.$a("script-application-sidebar-close",b);this.F=a.$a("script-application-sidebar-content",b)};
p.Ia=function(){iR.prototype.Ia.call(this);this.getHandler().vf(this.D,Ll,w(this.Aka,this))};p.Pg=l(!1);p.Ma=function(){delete this.H;delete this.D;delete this.F;delete this.C;iR.prototype.Ma.call(this)};function jEi(a,b){vR.call(this,a,b)}v(jEi,vR);jEi.prototype.Mo=function(){return O("macros-application-focus")};jEi.prototype.Uf=function(){return O("macros-application-sidebar")};function kEi(a,b){var c=null;c=c||mr("",{target:"_blank",height:500,width:600,top:(screen.height-500)/2,left:(screen.width-600)/2,scrollbars:!0});ff(c.location,a);b!=za&&(a=new hdc(function(){return c?c.closed:!0}),a.Sx=b,a.start(100,-1))};function lEi(a,b,c,d,e){Ev.call(this,void 0,!0,c);this.H=a;this.F=d||za;ks(this,b);this.setVisible(!0);this.hj=!0;rs(this,!1);ss(this,(new ps).Df(WWa,!0).Df(ws,!1,!0));this.setTitle(e||"Authorization Required");Cs(this,WWa.key)}v(lEi,Ev);lEi.prototype.Ia=function(){Ev.prototype.Ia.call(this);this.addEventListener("dialogselect",this.C)};lEi.prototype.yd=function(){Ev.prototype.yd.call(this);this.removeEventListener("dialogselect",this.C)};
lEi.prototype.C=function(a){"cancel"!=a.key?kEi(this.H,this.F):this.F();this.setVisible(!1)};function mEi(a){Ev.call(this,void 0,void 0,void 0);this.F=a;this.C=null;this.hj=!0;this.setTitle("Message details");ss(this,XWa())}v(mEi,Ev);mEi.prototype.Ca=function(){Ev.prototype.Ca.call(this);var a=this.yb();Ur(a,"script-error-dialog-content");this.C=qm(this.F);a.appendChild(this.C)};mEi.prototype.Ma=function(){Ev.prototype.Ma.call(this);this.C&&xm(this.C)};function nEi(a){B.call(this);this.C=a}v(nEi,B);function oEi(a,b){var c=Pd("Running script ");c=mm("SPAN",null,c);b=b?Hu(c,"Cancel",b,"info",!0):Gu(c,"info",!0);a.C.postMessage(b);return b.getId()}function pEi(a,b,c){var d=(c=void 0===c?null:c)?c:"Script "+(pf(b)+" experienced an error");b=mm("SPAN","script-error-message",d);b.style.maxWidth="600px";a.C.postMessage(Hu([b],"Details",function(){(new mEi(d)).setVisible(!0)},"warning",!0))}nEi.prototype.Ma=function(){delete this.C};function qEi(){B.call(this);this.C=null;this.D=new Vl;this.qa(this.D)}v(qEi,B);qEi.prototype.Ma=function(){rEi();sEi(this);B.prototype.Ma.call(this)};function sEi(a){a.D.Pc();a.C&&(a.C.dispose(),a.C=null);rEi()}function rEi(){var a=em("docs-script-button-bar");a&&tm(a)};var tEi=new vF(["http","https"]);function uEi(a){a=wf(a);if(Od(a)||Qd(a,'"'))return null;var b=al(1,a);return b?tEi.contains(b.toLowerCase())?a:null:null};function vEi(a,b,c,d,e,f,h){h=void 0===h?!1:h;Ev.call(this);this.aj=Od(wf(b))?"You can find "+(a+" in the Add-ons menu."):b;this.ma=c;this.Ba=d;this.H=uEi(e);this.ea=uEi(f);this.L=h;this.R=jr(this,wEi);this.C=DR("Learn more");this.Ga(this.C);this.F=new wu("Report an issue");this.Ga(this.F);this.O=new wu("View in store");this.Ga(this.O);this.setTitle(Pd("Help for "+a));a=new ps;a.Df({key:ws.key,caption:"Close"},!1,!0);ss(this,a);Cs(this,"ok")}v(vEi,Ev);p=vEi.prototype;
p.Ca=function(){Ev.prototype.Ca.call(this);var a=this.yb();qr(a,vDi,{description:this.aj,ids:this.R,r_b:this.L});Ur(a,"script-help-dialog")};
p.Ia=function(){Ev.prototype.Ia.call(this);var a=this.oa().getElement(this.R.yca);this.L?(this.F.render(a),this.getHandler().listen(this.F,"action",this.ZWa),this.C.render(a),this.getHandler().listen(this.C,"action",this.B0a)):(this.H&&(this.C.render(a),this.getHandler().listen(this.C,"action",this.B0a)),this.F.render(a),this.getHandler().listen(this.F,"action",this.ZWa),this.O.render(a),this.getHandler().listen(this.O,"action",this.KXb))};
p.B0a=function(){this.L?mr("https://support.google.com/docs?p=GSM_migration"):this.H&&mr(this.H)};p.ZWa=function(){this.ea?mr(this.ea):(this.ma(),this.dispose())};p.KXb=function(){this.Ba();this.dispose()};var wEi={yca:"script-help-dialog-buttonbar"};function xEi(a,b,c,d){Fl.call(this,"Fl");this.title=d}v(xEi,Fl);function yEi(a,b,c,d,e,f){Ev.call(this,void 0,void 0,f);this.L=b;this.F=d;this.H=e;this.C=null;this.setTitle(a);os(this,!0);a=new ps(f);for(b=0;b<c.length;++b)d=c[b],a.set(d,zEi[d]);a.D="0";ss(this,a)}v(yEi,Ev);p=yEi.prototype;p.Ca=function(){Ev.prototype.Ca.call(this);var a=this.oa(),b=this.yb();Ur(b,"script-prompt-contents");for(var c=a.Ca("DIV"),d=this.L.split("\n"),e=0;e<d.length;++e)0<e&&c.appendChild(a.Ca("BR")),c.appendChild(Om(a,d[e]));b.appendChild(c);this.F&&(this.C=a.Ca("INPUT"),b.appendChild(this.C))};
p.Pg=l(!1);p.Ia=function(){Ev.prototype.Ia.call(this);this.getHandler().listen(this,"dialogselect",w(this.P4b,this))};p.focus=function(){Ev.prototype.focus.call(this);this.C&&this.C.focus()};p.P4b=function(a){this.H(Number(a.key),this.F?this.C.value:null)};var zEi={1:"Ok",4:"Cancel",2:"Yes",3:"No"};function AEi(a,b){Ev.call(this);this.H=a;this.F=b;ss(this,(new ps).Df({key:"send",caption:"Send"},!0).Df({key:"cancel",caption:"Cancel"},!1,!0));this.setTitle("Report an issue");this.C=new tu;this.Ga(this.C)}v(AEi,Ev);p=AEi.prototype;p.Ca=function(){Ev.prototype.Ca.call(this);Cs(this,"send");var a=this.yb();Ur(a,"script-reportissue-dialog-content");qr(a,wDi,{Enb:this.F})};
p.Ia=function(){Ev.prototype.Ia.call(this);this.C.Va(this.Ea("script-reportissue-dialog-nonanonymous-checkbox"));this.qab();var a=this.getHandler();a.listen(this.Ea("script-reportissue-dialog-description"),"input",this.qab);a.listen(this,"dialogselect",this.Q4b)};p.Nd=function(){return this.Ea("script-reportissue-dialog-description").value};p.qab=function(){var a=!Od(this.Nd());us(this.D,"send",a)};p.Q4b=function(a){if("send"!=a.key)return!0;this.H(this.Nd(),this.C.isChecked());return!0};function BEi(a,b){B.call(this);this.D={};this.F={};this.J=0;this.O=b;this.C=a;this.C.EK(w(this.O4b,this))}v(BEi,B);p=BEi.prototype;p.connect=function(a){this.C.isConnected();this.C.connect(a)};p.isConnected=function(){return this.C.isConnected()};function CEi(a,b){b=new JR({role:0,ph:b,cn:"ide.api.ch",tp:1});b.Fz=a;return b}p.WMb=function(a,b){var c=DEi(this,b[0]),d=DEi(this,b[1]);b=yd(b,2);try{var e=a.apply(this,b);"function"===typeof e?e(c,d):c.call(this,e)}catch(f){d.call(this,null)}};
p.O4b=function(a,b){if(Id(a,"callback.")&&ae(this.D,a)){var c=Qea(this.D,a);b=null!=b?JSON.parse(b):null;var d=this.F[a];d&&(ge(this.D,d),ge(this.F,a),ge(this.F,d));ge(this.D,a);c.call(this,b)}};function DEi(a,b){return w(function(c){c=null!=c?nn(c):null;this.C.send(b,c)},a)}p.Ma=function(){B.prototype.Ma.call(this);delete this.O;delete this.D;delete this.F;delete this.J;delete this.C};function EEi(a,b,c,d){BEi.call(this,CEi(b,c),d||5E3);this.H=a;a=w(this.L,this);this.C.Cf("method.getContainerInfo",w(this.WMb,this,a),!0)}v(EEi,BEi);EEi.prototype.L=function(){return JRe(this.H.call())};EEi.prototype.Ma=function(){var a=this.C;BEi.prototype.Ma.call(this);a.dispose();delete this.H};function FEi(a,b,c,d,e){B.call(this);this.H=a;this.L=b;this.R=c;this.F=d||null;this.J=e||null;this.C=this.D=null}v(FEi,B);FEi.prototype.open=function(){if(this.F){if(this.F.closed){this.F=null;return}this.D=this.F;this.F=null;ff(this.D.location,this.H)}else this.D=mr(this.H,{target:this.L});if(this.J)try{this.C=new EEi(this.J,this.D,this.R),this.C.connect(),Gn(w(this.O,this,!0),1E5)}catch(a){this.C=null}};
FEi.prototype.O=function(a){try{!this.C||a&&this.C.isConnected()||(this.C.dispose(),this.C=null)}catch(b){this.C=null}};FEi.prototype.close=function(){this.O();this.D&&!this.D.closed&&(this.D.close(),this.D=null)};FEi.prototype.Ma=function(){B.prototype.Ma.call(this);this.C&&this.C.dispose();delete this.F;delete this.D;delete this.C;delete this.H;delete this.L};function GEi(a,b,c,d,e,f,h,k,m){Pl.call(this);this.R=[];this.Ha=!!k;this.F=a;this.O=b;this.qa(this.O);this.ma=new qEi;this.qa(this.ma);this.C=new nEi(Eu.getInstance());this.qa(this.C);this.D=null;this.Aa=new jEi(new iEi,m);this.ea=null;e&&(this.ea=new eEi(new $Di(f,h),m));this.H=new CDi(void 0,k);this.H.Yd(this);this.qa(this.H);this.F.Qh(this.H);this.xa=c;this.Ba=d;this.L=this.J=null}v(GEi,Pl);function zCi(a){return a.ea?a.ea.Mc:null}p=GEi.prototype;p.Mb=g("Ha");
function HEi(a,b){if(null==b)a.H.reset(0);else{var c=a.H;c.reset(2);for(var d=0;d<b.length;d++)for(var e=b[d],f=Ni(e,bCi,4),h=0;h<f.length;h++){var k=f[h];k=new BDi(e.getId(),e.getName(),k.getName());c.Ga(k,!0)}0===c.Qb()&&c.reset(1);a.H.isVisible()&&a.H.focus()}}function IEi(a,b){var c=em("docs-script-button-bar");c&&(tm(c),Od(wf(a))||(a=new wu(a),a.hc("docs-titlebar-button"),a.render(c),Jl(a,"action",b)))}
function ACi(a,b,c){a.L&&!a.L.isDisposed()&&(Fv(a.F,a.L),a.L.dispose());a.L=new AEi(b,c);a.L.hj=!0;a.F.Qh(a.L);a.L.setVisible(!0)}
p.Mtc=function(a,b,c){var d=this.F,e=c||null;c="<p>";var f="Thanks! Your feedback was sent to the creators of <strong>"+(vr(a)+"</strong>.");c=c+f+"</p>";e&&(c+="<p>",b?(a="You might not receive an individual reply, but if you'd like to learn more, check out <a href=\""+(U(Cr(e))+'" target="_blank">'+(vr(a)+" help</a>.")),c+=a):(a="You won't receive an individual reply, but if you'd like to learn more, check out <a href=\""+(U(Cr(e))+'" target="_blank">'+(vr(a)+" help</a>.")),c+=a),c+="</p>");c=T(c);
rRe(d,"Report an issue",pr(c),void 0,void 0,"Close")};p.Ltc=function(){rRe(this.F,"Report an issue","We're sorry, but we encountered an error sending your issue report. Please try again later.",void 0,void 0,"Close")};function yCi(a){a.dispatchEvent("Il")&&(a=a.Ba,a.C.isVisible()&&a.C.hide(),a.D.ub()||a.D.render(a.F||void 0),a.D.show())}p.gO=function(){this.dispatchEvent("El")&&this.Ba.D.hide()};p.loc=function(a,b,c,d,e){a=new FEi(a,"MacroService"+fha(c),b,e,d);this.R.push(a);a.open()};
p.Ma=function(){Pl.prototype.Ma.call(this);Wf(this.R)};function JEi(a,b,c,d,e,f,h,k,m,n,q,t,u,z,E,N,P,R,ba){u=void 0===u?!1:u;z=void 0===z?null:z;P=void 0===P?!1:P;B.call(this);this.L=a;this.R=m;this.Pa=k;this.xa=n;this.O=b;this.ma=c;this.J=d;this.F=N;this.H=new Vl(this);this.qa(this.H);this.Oa=q;this.Qa=z;this.ea=new nDi(this.ma,this.J);this.qa(this.ea);this.Ha=P;a=this.xa;c=this.Ha;u=void 0===u?!1:u;this.C=new GEi(e,h,q,t,KEi(a),c,a,u,E);this.qa(this.C);this.La=new ZBi;h=0;b.D?b.C&&(h=2):h=1;this.D=new pCi(this.xa,e,f,this.C,this.La,this.L,this.ma,
this.R,h,this.F,R,ba);this.qa(this.D);this.Aa={};this.Ba=null}v(JEi,B);p=JEi.prototype;
p.start=function(){if(bo(this.L.H,1,1)){this.H.listen(this.J,"amep",w(this.z4b,this));this.H.listen(this.J,"stbep",w(this.G4b,this));this.H.listen(this.J,"sttep",w(this.H4b,this));this.H.listen(this.J,"spep",w(this.F4b,this));this.H.listen(this.J,"saep",w(this.D4b,this));this.H.listen(this.J,"snep",w(this.E4b,this));this.H.listen(this.J,"paep",w(this.B4b,this));this.H.listen(this.J,"rfep",w(this.C4b,this));this.H.listen(this.C,"dialogselect",w(this.$Hb,this));this.H.listen(bH.getInstance(),"Yc",w(this.A4b,
this));this.Pa(w(this.WHb,this));var a=this.L.C;O("macros-exec").wb(vp,this.RHb,this);O("macros-resume").wb(vp,this.xSb,this);O("macros-manage").wb(vp,w(a.$t,a,w(this.xMb,this)));O("macros-editor").wb(vp,this.jya,this);O("macros-extensions").wb(vp,w(this.HVa,this));O("macros-manage-extensions").wb(vp,w(this.wMb,this));O("macros-extension-menu-promo").wb(vp,w(this.HVa,this));O("macros-extension-disabled").wb(vp,this.fGb,this);O("macros-extension-help").wb(vp,this.hIb,this);O("macros-extension-install-start").wb(vp,
this.kLb,this);O("macros-trigger-0").wb(vp,w(this.gG,this,"0"));O("macros-trigger-1").wb(vp,w(this.gG,this,"1"));O("macros-trigger-2").wb(vp,w(this.gG,this,"2"));O("macros-trigger-3").wb(vp,w(this.gG,this,"3"));O("macros-trigger-4").wb(vp,w(this.gG,this,"4"));O("macros-trigger-5").wb(vp,w(this.gG,this,"5"));O("macros-trigger-6").wb(vp,w(this.gG,this,"6"));O("macros-trigger-7").wb(vp,w(this.gG,this,"7"));O("macros-trigger-8").wb(vp,w(this.gG,this,"8"));O("macros-trigger-9").wb(vp,w(this.gG,this,"9"));
this.ea.start();LEi(this.xa,this.Ha)&&(O("macros-addon-sidebar-focus").Na(!0),O("macros-addon-sidebar-focus").pb(void 0,OBi(19)));FDi(new EDi(this.O,this.D));a=this.O.J;var b=!this.O.C,c=this.ma,d=this.R().getState()||void 0;d=["ruid",Ia({}),c.C.C,c.D,c.C.D,d];b||d.push("addon_safe_mode",!0);a&&d.push("addon_dry_run",a);Zo(ap(A7(c,c.C.Ha),"POST").setContent(""),d).Yr().Te()}};
function MEi(a){HEi(a.C,null);var b=w(function(c){c.Er()?HEi(this.C,Ni(c,dCi,2)):(this.C.C.C.postMessage(Gu("Could not load scripts.","warning",!0)),HEi(this.C,[]))},a);mCi(a.ma,b)}
function NEi(a,b,c,d,e,f){if(d){yCi(a.C);var h=w(function(){var t=KCi(this.D,b);t&&!zi(t,4)&&(L(t,4,!0),BCi(this.D))},a);var k=w(function(){this.C.gO();this.L.Vm.dispatchEvent(new sn(!0))},a);var m=w(function(t){this.C.gO();8!=t.kF()&&pEi(this.C.C,c,t.Tf())},a);xCi(a.D)}else{var n=oEi(a.C.C),q=w(function(t){this.ea.F.cancel(t);Fu(this.C.C.C,n)},a);h=w(function(t){Fu(this.C.C.C,n);n=oEi(this.C.C,Ja(q,t))},a);k=w(function(t){Fu(this.C.C.C,n);if(t.c6()){t=this.C.C;var u=Pd("Canceled script ");t.C.postMessage(Gu(u,
"info",!1,2500))}else t=this.C.C,u=Pd("Finished script "),t.C.postMessage(Gu(u,"info",!1,2500));this.L.Vm.dispatchEvent(new sn(!0))},a);m=w(function(t){Fu(this.C.C.C,n);8!=t.kF()&&pEi(this.C.C,c,t.Tf())},a)}a.Oa.Cb(3);fje(a.L.C,w(a.$qc,a,b,c,h,k,m,d,e,f))}p.$qc=function(a,b,c,d,e,f,h,k){var m=this.R().getState()||void 0,n=this.ea;c=void 0===c?za:c;d=void 0===d?za:d;e=void 0===e?za:e;e=w(n.J4b,n,a,b,c,d,e);n.F.UYa(a,b,m,e,f,h,k)};
p.A4b=function(a){var b=wd(this.D.D),c={};b=ha(b);for(var d=b.next();!d.done;d=b.next())d=d.value,c["ADD-ON:"+y7(d)]={name:d.getName(),"cws-id":J(d,1),"gsm-application-id":J(d,18),"app-key":y7(d)};ke(a.LG,c)};p.fGb=function(a){a.data==this.Ba&&(a=this.C,a.dispatchEvent("Dl")&&a.Aa.Mc.Aka())};
p.z4b=function(a){a=a.C().zb();var b={},c=OEi(this,a);if(1==K(a,11,0)){var d=J(a,4);d=KCi(this.D,d)}else d=void 0;var e=d,f=e&&(zi(e,10)||zi(e,9))||!1,h=e&&zi(e,19)||!1;d=this.La;var k=c,m=J(a,4),n=1==K(a,11,0);f=new XBi(a,k,n,f,h);f.setVisible(!0);0==K(a,11,0)&&(m=f.getLabel());d.C[K(a,11,0)][m]=f;d.dispatchEvent("Hl");(d=zCi(this.C))&&J(a,9)&&(1==J(a,12)||5==J(a,12))&&(m=J(a,4),d.J[m]=a,m&&m in d.D&&ZDi(d.D[m],a));c=c.reverse();if(d=this.C.O){for(m=0;m<c.length;m++)if(f=c[m],h=f.getKey())if(b[h])L(f,
5,void 0);else{if(this.Aa[h])for(k="Ctrl+Alt+Shift+"+h.toUpperCase(),k=Xt(O("macros-exec"),[k]),n=0;n<d.ma.length;n++){var q=d.ma[n];Gm(q)==k&&Em(q,"")}this.Aa[h]=f.Ie();b[h]=!0}if(1==K(a,11,0)){b=null!=e?e:null;c=[];e=J(a,4);f=!!J(a,9)&&3!=J(a,12);m=d.C.F.get(e);m||(m=new At(""),m.Dc(e),h=J(a,10),m.setContent(qm(h)),m.Na(2==d.R?!1:f&&1==d.R?!1:!0),d.F.Pc(),ECi(d.C,m),FCi(d));f||d.ea.push(e);f=new ut;!b||zi(b,10)||zi(b,9)||zi(b,19)||(GCi(d,f,b),h=new zBi,k=String(Ia(h)),L(h,1,k),f.Ga(LDi(d,h,c),!0));
h=b&&(zi(b,10)||zi(b,9))||!1;if(!b||h||!zi(b,19))for(a=a.uh(),h=0;h<a.length;++h)f.Ga(LDi(d,a[h],c,void 0,b?b:void 0),!0);b&&HCi(d,f,e,c,b);d.xa[e]=c;m.Be(f);m.dispatchEvent("load");d.Ba.push(e)}else{b=a.yg();if(d.At(b)){d.At(b);c=d.D[b];delete d.D[b];d.H.removeChild(c,!0);if(d.L)for(e=d.Aa[b],m=0;m<e.length;++m)d.L.JU(e[m]);delete d.Aa[b];c.dispose()}10<=Yd(d.D)||(b=[],a.uh(),c=a.yg(),a=LDi(d,a,b,"Ctrl+Alt+Shift+").zb(),a=new Pu(c,a,IDi.getInstance(),void 0,!0),e=d.H.Qb()?d.H.Qb()-1:0,d.H.zf(a,e,
!0),d.D[c]=a,d.Aa[c]=b)}}};p.G4b=function(a){a=a.C();var b=a.yg();b?IEi(b,w(function(c){var d=wf(c.getUrl());Od(d)||mr(d);d=wf(c.getFunctionName());Od(d)||NEi(this,J(c,1),d,J(c,4)||void 0,void 0,c.vr()||void 0)},this,a)):rEi()};
p.H4b=function(a){var b=a.C();a=b.getText();b=b.ol();var c=this.C.ma,d=em("docs-script-button-bar");d&&(sEi(c),Od(wf(a))||(a=sr(rDi,{caption:a}),sm(d,a),Od(wf(b))||(c.C=new ht,c.C.hc("docs-script-button-bar-bubble"),c.C.setContent(sr(sDi,{text:b})),c.C.Vi(a),it(c.C,!0),c.C.RJ=!1,c.C.setPosition(1,1),c.C.gr(!1),c.C.render(d),c.D.listen(a,"mouseover",w(c.C.setVisible,c.C,!0)).listen(a,"mouseout",w(c.C.setVisible,c.C,!1)))))};
p.F4b=function(a){this.C.gO();var b=a.C(),c=Bi(b,6,!1);a=c?J(b,3).replace(/\n/g," ").replace(/\\n/g,"\n"):J(b,3);var d=J(b,7),e=this.C,f=b.getTitle(),h=J(b,4),k=Bi(b,5,!1);b=w(this.YQb,this,J(b,1),c,d);e.D&&(e.D.setVisible(!1),Fv(e.F,e.D));e.D=new yEi(f,a,h,k,b);e.D.hj=!0;e.F.Qh(e.D);e.D.setVisible(!0)};p.YQb=function(a,b,c,d,e){var f=new TCi;L(f,1,d);L(f,3,b);L(f,4,c);null!==e&&L(f,2,e);O("macros-resume").pb([a,nn(f.Fb())])};
p.D4b=function(a){a=a.C();var b=ate(M(a,PR,9));var c={};c.mid=this.O.H;b=Ae(b,c);switch(K(a,6,0)){case 1:var d=this.C;c=J(a,3);var e=this.R,f=a.getTitle()||void 0;if(d.dispatchEvent(new xEi(b,c,e,f))){var h=d.xa;d=d.Aa.Mc;d.ub()||(d.render(),d.resize());d.Aka();var k=d.oa();k.Fe(d.H,f||"Apps Script application");f=w(h.Cb,h,3);d.C=new gEi(b,c,[new fEi("google.script.host.close",w(d.Aka,d),0),new fEi("google.script.host.editor.focus",f,0)],e,k);Uf(d.C,f);d.Ga(d.C,!0);O("macros-application-focus").pb()}this.Ba=
J(a,7)||null;break;default:c=this.C,e=J(a,3),f=this.R,h=a.getTitle()||void 0,d=a.getWidth()||void 0,k=a.getHeight()||void 0,a=Bi(a,8,!1),c.D&&(c.D.setVisible(!1),Fv(c.F,c.D)),c.D=new hEi(b,e,f,c.xa,h,d,k,a),c.D.hj=!0,c.F.Qh(c.D),c.D.setVisible(!0)}};p.E4b=function(a){a=a.C();var b=a.getType();this.Qa(b,a.getText(),a.getTitle()||void 0,J(a,4)||void 0)};
p.B4b=function(a){a=a.C();var b=M(a,PCi,3);b&&(vi(b,2)||vi(b,11))?(b=new GBi(J(b,2),J(b,11)),zi(a,4)?(b=this.D.getExtension(b),null!=b&&zi(b,10)?(b="The add-on "+(b.getName()+" needs your permission to run in this document."),a=a.getUrl(),new lEi(a,(new Hw).format(""),void 0,void 0,b)):(a=a.getUrl(),new lEi(a,(new Hw).format("A script attached to this document needs your permission to run."),void 0,void 0,"Updated add-on"))):this.D.hW(b)):(a=a.getUrl(),new lEi(a,(new Hw).format("A script attached to this document needs your permission to run."),
void 0,void 0,void 0))};p.C4b=function(a){a=a.C();NEi(this,J(a,1),a.getFunctionName(),J(a,4)||void 0,void 0,a.vr()||void 0)};p.RHb=function(a){a=a.data;var b=KCi(this.D,a.C);!b||zi(b,9)?NEi(this,a.C,a.functionName,a.F||void 0,1,a.D||void 0):this.D.hW(z7(b))};p.xSb=function(a){yCi(this.C);var b=a.data;a=b[0];b=b[1];var c=w(function(){this.C.C.C.postMessage(Gu("Error resuming script execution","warning",!0))},this);oDi(this.ea,a,b,c)};p.xMb=function(){this.C.H.setVisible(!0);MEi(this)};
p.jya=function(a){var b=a.data;a=b?b.scriptId:void 0;a=new pl(MCi(this.O,a?a:void 0));b&&(a=b.editorUri?new pl(b.editorUri):a,b.filename&&a.qc("f",b.filename),b.lineNumber&&(a.qc("l",b.lineNumber),a.qc("s",b.lineNumber)));b=this.L.D;var c=null;Ho(this.L.C)||(c=Mce("Loading\u2026",{target:"MacroService"+fha(b)}));this.L.C.$t(w(this.C.loc,this.C,a.toString(),this.O.O,b,this.R,c))};p.HVa=function(){this.D.hW()};
p.wMb=function(a){if(a.data)this.D.hW(a.data);else{a=this.D;var b=wCi(a,!0),c=a.R;var d=c.D;b=TBi(d,d.C,b,void 0,!0);d=UBi(d,b);c.C=d;d=c.C;c.F.Qh(d);d.setVisible(!0);xCi(a)}};
p.hIb=function(a){var b=this.D,c=KCi(b,a.data);if(c){var d=z7(c);a=w(b.Q6a,b,d,y7(c),c.getName(),J(c,6)||void 0,J(c,11)||void 0);d=w(b.hW,b,d);var e=zi(c,19)||void 0,f=b.C,h=c.getName(),k=wf(J(c,7)),m=J(c,6)||void 0;c=J(c,11)||void 0;e=void 0===e?!1:e;f.J&&!f.J.isDisposed()&&(Fv(f.F,f.J),f.J.dispose());f.J=new vEi(h,k,a,d,m,c,e);f.J.hj=!0;f.F.Qh(f.J);f.J.setVisible(!0);xCi(b)}};
p.kLb=function(a){if(a.data){var b=KCi(this.D,a.data);if(null!=b)if(a=this.D,b=z7(b),a.H){a:{if(1==a.H)b="Add-ons aren't allowed in your domain. Talk to your domain administrator for more information.";else if(2==a.H)b="Add-ons aren't allowed while in safe mode.";else break a;rRe(a.xa,"Oops",b,void 0,void 0,"Close")}BCi(a)}else{var c=a.getExtension(b);c&&zi(c,9)?(b=a.getExtension(b).getName(),b=Pd(b+" is already installed"),a.C.C.C.postMessage(Gu(b,"info",!1,2500)),BCi(a)):a.hW(b)}}};
p.$Hb=function(a){"edit"==a.key?(a=a.target.Ht.cf(),a=MCi(this.O,a?a.PZa:void 0),this.jya(new wp({editorUri:a}))):"new"==a.key?this.jya(new wp({editorUri:this.O.ea})):"reload"==a.key?MEi(this):"run"==a.key&&(a=a.target.Ht.cf(),NEi(this,a.PZa,a.getFunctionName(),void 0,void 0,a.vr()))};p.gG=function(a){(a=this.Aa[a])&&(a=KDi(this.C.O,a))&&a.isEnabled()&&a.dispatchEvent("action")};p.WHb=function(){for(var a=this.C,b=0;b<a.R.length;b++){var c=a.R[b];c.close();c.dispose()}a.R=[]};
function OEi(a,b){var c=[];J(b,3)&&c.push(b);b=b.uh();for(var d=0;d<b.length;d++)c=c.concat(OEi(a,b[d]));return c}p.getView=g("C");function KEi(a){return a==(Du(),Au)||a==(Du(),Cu)||a==(Du(),Bu)}function LEi(a,b){return b&&(a==(Du(),Au)||a==(Du(),Bu))};function PEi(a,b,c,d,e,f,h){B.call(this);var k=this;this.D=a;this.L=b;this.bb=e;this.F=d;this.ma=new Rl;this.C=f;this.xa=h;this.R=new Yt(this);this.qa(this.R);this.R.wb($kb,op,this.J);this.ea=new Vl(this);this.qa(this.ea);this.ma.Ab(this.F.F,function(){return k.J()});this.H=new f2a(this.bb.Jb(),!0);this.qa(this.H);this.O={};this.J()}v(PEi,B);PEi.prototype.J=function(){var a=QEi(this),b=this.L.zb(Kz.getId(),!0);b.wd(!0);Xu(this.L,b,[new zJe(a)]);Ur(b.getElement(),"waffle-action-menu")};
function QEi(a){var b=Array.from(a.F.C.values());LAi(b,function(t){return ph(t,8)});var c=Array.from(a.F.D.values());hv(a.xa,pcd(0<b.length,0<c.length));Jz.setProperty("visible",!0);Iz.setProperty("visible",!0);var d={};c={};b=ha(b);for(var e=b.next();!e.done;c={Apa:c.Apa},e=b.next()){e=e.value;var f=ph(e,1),h=e.getFunctionName(),k=ph(e,8),m=kh(e,9)?ph(e,9):null,n="recorded-action-"+f+":"+h,q=a.D.nf(n);q||(q=(new Up(n)).enabled(!0),q.Fa(29583),q=q.build(),c.Apa=new yBi(f,h,void 0,void 0,void 0,kh(e,
12)?e.vr():void 0),q.wb(vp,function(t){return function(){O("macros-exec").pb(t.Apa)}}(c)),H1a(a.H,[q]),a.D.hq(q),a.C&&a.C.Di(q));q.setProperty("label",k);REi(a,m)&&q.setProperty("keys",[m]);null==m&&null!=q.getProperty("keys")&&q.setProperty("keys",null);d[n]=q}Ud(a.O,function(t,u){d[u]||(t.setProperty("keys",null),a.D.TP(u),a.C&&a.C.JU(u),Vf(t))});a.O=d;return Zd(d)}function REi(a,b){return!$kb.Dd()&&null!=b&&/^Ctrl\+Alt\+Shift\+\d$/i.test(b)&&0==(a.H.C[gc(b)]||[]).length};function SEi(a,b){this.AFa=a;this.boa=b};function TEi(a,b){a='<div class="waffle-recording-toast" role="complementary" tabIndex="0" aria-describedby="waffle-recording-toast-content"><div class="waffle-recording-toast-top"><div class="waffle-recording-toast-icon"><div class="waffle-recording-toast-outer-circle"><div class="waffle-recording-toast-inner-circle"></div></div></div><div class="waffle-recording-toast-content"><div class="waffle-recording-toast-new-content"></div><div class="waffle-recording-toast-default-content">Recording new macro\u2026</div></div><div class="waffle-recording-toast-right"><div class="waffle-recording-toast-cancel">Cancel</div><div class="waffle-recording-toast-stop">Save</div><div class="waffle-recording-toast-expand-section"><div class="waffle-recording-toast-expand"><div class="waffle-recording-toast-expand-icon"></div></div></div></div></div><div class="waffle-recording-toast-bottom" role="radiogroup"><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-absolute">'+
cO({label:zr('Use absolute references<div class="waffle-recording-toast-label-description">When applying macro use exact location as recorded</div>')},b);a=a+'</div></div><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-relative">'+cO({label:zr('Use relative references<div class="waffle-recording-toast-label-description">When applying macro use active selection</div>')},b);return T(a+"</div></div></div></div>")};function UEi(a){S.call(this,a);this.J=new lt("",new Sv,this.oa());this.Ga(this.J);this.F=new lt("",new Sv,this.oa());this.Ga(this.F);this.D=new $t;this.qa(this.D);this.H=null;this.C=0}v(UEi,S);p=UEi.prototype;p.Ca=function(){this.jb(sr(TEi))};
p.Ia=function(){S.prototype.Ia.call(this);this.O=new SU(this.oa(),void 0,"relative");this.L=new SU(this.oa(),void 0,"absolute");this.O.Va(this.Ea("waffle-recording-toast-relative"));this.L.Va(this.Ea("waffle-recording-toast-absolute"));var a=ie(cu);he(a,"selected",!0);var b=kq(new jq,6).build();bu(this.D,this.O,Mz,a,void 0,b);bu(this.D,this.L,Nz,a,void 0,b);bu(this.D,this.J,O("recorded-action-stop"),void 0,void 0,b);bu(this.D,this.F,Hz,void 0,void 0,b);this.H=new jJ(this.Ea("waffle-recording-toast-expand"),
this.Ea("waffle-recording-toast-bottom"),blb.isVisible(),void 0,this.oa());this.qa(this.H);this.getHandler().listen(this.H,"toggle",this.KRb);this.J.Va(this.Ea("waffle-recording-toast-stop"));this.F.Va(this.Ea("waffle-recording-toast-cancel"))};p.setVisible=function(a){var b=this.Ka();Q(b,a);Nr(b,"hidden",!a);a&&(a=this.oa().Jb(),a=lm(a)||window,b=Vq(this.Ka()),this.Ka().style.left=Math.max(Math.floor(km(a).width/2-b.width/2),0)+"px")};
function VEi(a,b){a.Ea("waffle-recording-toast-default-content").style.opacity=0;var c=a.Ea("waffle-recording-toast-new-content");a.oa().Fe(c,b);0!=a.C?WEi(a):(Hn(a.C),a.C=Gn(function(){return WEi(a)},400))}function WEi(a){var b=a.Ea("waffle-recording-toast-new-content");Wr(b,"waffle-recording-toast-slide-in");Hn(a.C);a.C=Gn(function(){Ur(b,"waffle-recording-toast-slide-in");Hn(a.C);a.C=Gn(function(){return XEi(a)},2200)})}
function XEi(a){var b=a.Ea("waffle-recording-toast-default-content"),c=a.Ea("waffle-recording-toast-new-content");Wr(c,"waffle-recording-toast-slide-in");b.style.opacity=1;Hn(a.C);a.C=Gn(function(){a.C=0},400)}p.KRb=function(a){blb.setVisible(a.gF)};p.Ma=function(){Hn(this.C);S.prototype.Ma.call(this)};function YEi(a,b,c,d){B.call(this);var e=this;this.O=a;this.L=c;this.D=d;this.C=tj().hyb()(tj().Cu()(),tj().Jwb()(),B7(this),Mz.Dd(),function(f){f="Action "+(tj().gyb()(e.C)+(": "+f));ZEi(e,f)},tj().CSa()());tj().USa()(this.C);this.H=new UEi;this.qa(this.H);this.Ba=new Yt(this);this.qa(this.Ba);this.Ba.wb(Mz,vp,this.FXb,this).wb(Nz,vp,this.EXb,this).wb(O("docs-doc-copy-made"),vp,this.wGb,this).wb(O("macros-exec"),vp,this.WSb,this).wb(afb,vp,function(f){return $Ei(e,f.data,2)},this).wb(gfb,vp,function(f){return $Ei(e,
f.data,3)},this).wb($eb,vp,function(f){return $Ei(e,f.data,1)},this).wb(bfb,vp,function(f){return $Ei(e,f.data,5)},this).wb(Vfb,vp,function(f){return $Ei(e,f.data,4)},this).wb(tfb,vp,function(f){f=f.data;switch(f.F){case "all-objects-for-all-datasources":tj().Xxb()(e.C,B7(e));break;case "all-objects-for-single-datasource":tj().Yxb()(e.C,B7(e),f.D);break;case "specific-ids":var h=f.C[0];f=tj().jF()(h);var k=null;switch(f){case 4:k=aFi(e,h,!1);break;case 1:case 3:case 5:(h=tj().XPa()(h,GT(e.L)))&&0<
h.length&&(k=fo(h[0]),k=qo(po(oo(mo(),k.eb()),k.Ob()),k.Lb()).build(),h=OAi(),3==f?(PAi(h),Fh(h,6,k)):1==f?(PAi(h),Fh(h,5,k)):5==f&&(PAi(h),Fh(h,4,k)),k=h.build().qb());break;case 2:(h=tj().WPa()(h))&&0<h.length&&(k=NAi(h[0]).build().qb())}k&&tj().XSa()(e.C,B7(e),f,k)}}).wb(lfb,vp,function(){return tj().Zxb()(e.C,B7(e),!1)},this).wb(Zeb,vp,this.UEb,this).wb(cfb,vp,function(f){return tj().Txb()(e.C,B7(e),f.data.qb())},this);this.F=new Rl;this.qa(this.F);this.F.Ab(a.Ta,function(){tj().myb()(e.C,!0,
B7(e))});this.F.Ab(a.La,function(f){if(f.D){var h=f.C.D();"docs-edit"==h?"ritz-waffle"==f.C.C&&tj().jyb()(e.C,B7(e)):"docs-undo"==h?(ZEi(e,"Undo previous action"),tj().nyb()(e.C)):"docs-redo"==h&&(ZEi(e,"Redo previous action"),tj().kyb()(e.C))}});this.F.Ab(b.ma,function(f){f.C||tj().dyb()(e.C,B7(e),f.D)});this.F.Ab(this.D.tb,function(f){return bFi(e,f)});this.F.Ab(this.D.tc,function(){e.ma=B7(e)});this.F.Ab(this.D.Pb,function(f){switch(f.D){case "find-next-occurrence":tj().Uxb()(e.C,e.ma,B7(e),f.C.qb());
break;case "replace-current-occurrence":tj().$xb()(e.C,B7(e),f.C.qb())}e.ma=null});this.F.Ab(this.D.Za.D,function(f){tj().cyb()(e.C,B7(e),f.F,f.H,f.J,f.L,f.id,f.C,f.D)});this.F.Ab(b.Vm,function(){tj().Rxb()(e.C,e.Aa,B7(e),e.xa);e.Aa=null;e.xa=null});this.F.Ab(this.D.Nc,function(f){tj().Sxb()(e.C,e.J.D.C.qb(),f.getSelection().C.qb(),e.J.C.qb());e.J=null});this.ea=new Vl(this);this.qa(this.ea);this.J=this.ma=this.xa=this.Aa=this.R=null;this.ea.listen(this.D.C,"pa",this.yec).listen(this.D.C,"va",this.xec);
this.H.render();this.H.setVisible(!0);cFi(this);setTimeout(function(){return qG("All actions are now being recorded. Please use the Tools menu to cancel or save recording.")})}v(YEi,B);p=YEi.prototype;p.xec=function(){this.R=B7(this)};p.yec=function(a){!a.JG&&LI(this.D)&&(void 0!==a.xX?(a=a.xX,tj().eyb()(this.C,this.R,B7(this),a)):(a=this.D.C.C.Zd(),VEi(this.H,"Activating sheet "+a),tj().fyb()(this.C,this.R,B7(this),a)),this.R=null)};function ZEi(a,b){VEi(a.H,b);qG("Macro recorder "+b)}
function dFi(a){return tj().iyb()(a.C,B7(a))}p.WSb=function(a){this.xa=a.data.functionName;this.Aa=B7(this)};function bFi(a,b){var c=B7(a);a.ea.Qc(a.D,"gc",function(){var d=B7(a);switch(b.H){case "adjust-next-data-region-edge":tj().Qxb()(a.C,c,d,b.D,b.C);break;case "move-next-data-region-edge":tj().Wxb()(a.C,c,d,b.D,b.C);break;case "select-all":tj().ayb()(a.C,c,d);break;case "select-rows-columns":tj().byb()(a.C,c,d,"c"==b.F)}})}p.wGb=function(a){a=a.data;tj().Vxb()(this.C,B7(this),a.C)};
p.UEb=function(a){a=a.data;var b=this.O.C.getSelection();this.J=new eFi(a,b)};
function $Ei(a,b,c){var d=tj().XSa(),e=a.C,f=B7(a);a:switch(c){case 4:b=aFi(a,b,!0);break a;case 3:case 1:case 5:var h=yG(a.L);h?(a=uo(a.O.C.getSelection()),fFi(b,a,h)?b=null:(a=Qzc(h),fFi(b,a,h)?(b=FF(h.Sa().vg(a.y,a.x)),b=null!=b?b:qo(po(oo(mo(),h.O.C.C.eb()),a.y),a.x).build(),h=OAi(),3==c?(PAi(h),Fh(h,6,b)):1==c?(PAi(h),Fh(h,5,b)):5==c&&(PAi(h),Fh(h,4,b)),b=h.build().qb()):b=null)):b=null;break a;case 2:if(h=yG(a.L)){a=a.O.C.getSelection();var k=SXe(h);b=k&&qh(a.C,6).Fb().includes(k)?null:(a=QXe(h))&&
b==RXe(h)?NAi(a).build().qb():null}else b=null;break a;default:b=null}d(e,f,c,b)}function fFi(a,b,c){if(!b)return!1;b=c.Sa().vg(b.y,b.x);c=Pzc(c,b);return a==c}function aFi(a,b,c){if(c&&(a=a.D.C.C)&&dC(a))return null;b=tj().gN()(b);if(!b)return null;(b=tj().KS()(b))?(a=OAi(),PAi(a),b=Ah(a,2,b).build().qb()):b=null;return b}p.FXb=function(){var a=!tj().YSa()(this.C);gFi(this,!0);a&&(VEi(this.H,"Using relative references"),qG("Recording with relative references"))};
p.EXb=function(){var a=tj().YSa()(this.C);gFi(this,!1);a&&(VEi(this.H,"Using absolute references"),qG("Recording with absolute references"))};function gFi(a,b){tj().lyb()(a.C,b);Mz.Sb(b);Nz.Sb(!b)}function cFi(a){(a=yG(a.L))&&pL(a)}function B7(a){return a.O.C.getSelection().C.qb()}p.Ma=function(){tj().gSa()();B.prototype.Ma.call(this)};function eFi(a,b){this.C=a;this.D=b};function hFi(a,b,c,d){Uv.call(this,"Macro saved",bm(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-saved"]);this.Pa=a;this.Aa=b;this.O=c;this.Ha=d}v(hFi,Uv);hFi.prototype.Ca=function(){Uv.prototype.Ca.call(this);var a=ir(this,"script-recorder-edit-link-id");this.Qw("EDIT SCRIPT",a)};hFi.prototype.Ia=function(){Uv.prototype.Ia.call(this);this.getHandler().vf(kr(this,"script-recorder-edit-link-id"),Ll,w(this.L,this,this.Pa,this.Aa,this.O))};
hFi.prototype.L=function(a,b,c){this.Ha.C(29645);O("macros-editor").pb(b?{scriptId:a,filename:b,lineNumber:c}:void 0)};function iFi(a,b,c,d,e,f,h,k,m,n){ev.call(this);var q=this;this.xa=a;this.ea=b;this.Qa=c;this.Ha=d;this.R=e;this.H=f;this.Ba=h;this.ma=k;this.L=n;this.Aa=new Yt(this);this.qa(this.Aa);this.F=null;this.J=!1;this.C=null;this.La=m;this.Aa.subscribe(Lz,"action",this.Ksc).subscribe(O("recorded-action-stop"),"action",this.zuc).subscribe(clb,"action",this.frc).subscribe(Hz,"action",this.Dgb).subscribe(Iz,"action",this.mtc).subscribe(Jz,"action",this.stc);gv(this,jFi(this));uq(this.H,this);a=["not-revisions",
"sheet-access-edit",jv()];var t=new tq(a.concat(["docs-script-recording"]));dd([Hz,O("recorded-action-stop"),clb,alb,Nz,Mz],function(u){q.H.C(u,t);q.H.D(u,t)});a=new tq(a.concat(["not-docs-script-recording"]));this.H.C(Lz,a);Iw()||this.H.D(Lz,a)}v(iFi,ev);p=iFi.prototype;p.Ksc=function(){var a=this;this.F=new YEi(this.Qa,this.Ha,this.R,this.Ba);hv(this,jFi(this));this.Ba.D.C.$t(function(){$o(Dk(ap(a.xa.Se("/startrecordingscript"),"POST"),1).setTimeout(18E4)).Te()})};
p.zuc=function(){zG(this.R)&&vK(yG(this.R),!0);this.F.H.setVisible(!1);tj().gSa()();HAi(this.ea)};
p.frc=function(a){var b=this,c=a.AFa;a=a.boa;var d=dFi(this.F).sourceCode();kFi(this,Wv(this.L,"Saving new macro",bm(),!0,0,!1,void 0,!0,["waffle-recording-toast-saving"]),!0);this.J=!0;hv(this,jFi(this));$o(Ek(Fk(Dk(ap(Bk(Bk(Ro(this.xa.Se("/saverecordedscript"),["script",d]),"name",c),"shortcut",""!=a?"Ctrl+Alt+Shift+"+a:""),"POST"),1),function(e){var f=e.tT("scriptId"),h=e.tT("filename");e=Number(wG(e,"lineNumber"));f=new hFi(f,h,e,b.La);Xv(b.L,f);kFi(b,f);b.J=!1;lFi(b)}),function(){kFi(b,Wv(b.L,
"Failed to save macro",bm(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-save-failed"]));b.J=!1;if(b.F){var e=b.F;tj().USa()(e.C);e.H.setVisible(!0)}hv(b,jFi(b))}).setTimeout(18E4)).Te()};function lFi(a){Vf(a.F);a.F=null;hv(a,jFi(a))}p.Dgb=function(){lFi(this);setTimeout(function(){return qG("Script recording canceled")})};function jFi(a){var b={},c=!!a.F;a=a.J;b["docs-script-recording"]=c&&!a;b["not-docs-script-recording"]=!c&&!a;return b}p.mtc=function(){IAi(this.ea,this.ma)};
p.stc=function(){JAi(this.ea,this.ma)};function kFi(a,b,c){a.C&&(Yv(a.L,a.C),a.C.setVisible(!1),Vf(a.C));a.C=b;a.C.render();c&&(new Itf(!0,bm())).render(im("docs-ui-toast-content",b.getElement()));a.C.setVisible(!0)}p.Ma=function(){Vf(this.F);this.F=null;this.C&&(Vf(this.C),this.C=null);ev.prototype.Ma.call(this)};function mFi(a,b,c,d){1==a&&IOb(pf(c||""),pf(b),void 0!==d?d:-1,!0)};function nFi(a,b,c,d,e,f,h,k,m,n,q,t,u,z,E,N,P,R,ba){B.call(this);this.R=a;this.ma=b;this.Aa=c;this.Ba=d;this.O=e;this.Pa=f;this.Qa=h;this.C=k;this.F=m;this.Oa=n;this.L=q;this.ea=t;this.Ta=u;this.J=new Vl(this);this.qa(this.J);this.xa=new YAi(this.Aa,this.F);this.Ya=new iFi(this.Aa,this.O,this.ma,this.R,this.C.D,E,this.F,this.xa,N,P);this.qa(this.Ya);this.Wa=new PEi(E.F,this.C.Aa.C,m,this.xa,z,this.C.Aa.La,R);this.qa(this.Wa);this.D=null;this.H=ba}v(nFi,B);
nFi.prototype.init=function(){var a=this.C.Aa.La;a.Di(Lz);a.Di(Hz);a.Di(O("recorded-action-stop"));a.Di(Mz);a.Di(Nz);a.Di(Iz);a.Di(Jz);a=this.F.xb.D;var b=this.F.xb.C;b&&(b+=a?"_"+a:"");a=A();var c=y(a,"docs-tintd")&&y(a,"docs-thtea");this.D=new Yze(this.Ba,this.ma.C,this.C.D);this.qa(this.D);var d=this.R,e=ZLa(this.L),f=$La(this.L),h=this.O,k=this.Pa,m=this.Qa,n=w(this.ea.O,this.ea),q=w(this.D.C,this.D),t=(Du(),Bu),u=this.Oa,z=this.Ta,E=this.Ba,N=Ow(Jw.getInstance()),P=this.C.Aa.C;N=void 0===N?!1:
N;c=void 0===c?!1:c;var R=A();R=new LCi(Zc(R,"maestro_container_token"),Zc(R,"maestro_domain"),Zc(R,"maestro_script_editor_uri"),Zc(R,"maestro_new_project_uri"),y(R,"docs-emae"),Zc(R,"mae-pai"),y(R,"mae-cwssw"),y(R,"mae-aoeba"),y(R,"mae-esme"),Zc(R,"mae-dret"),Zc(R,"mae-ses"),y(R,"docs-tdd"),y(R,"mae-seitd"));e=new kCi(d.D,String(E),e,void 0);E=new mDi;E.bind(f);f=R.C?2:R.D?0:1;var ba=new $t(void 0,void 0,!0,dw.getInstance());m=m?new JDi(m,ba,f,P,void 0):null;d=new JEi(d,R,e,E,h,k,m,n,q,t,u,z,N,mFi,
cPc,b,c);d.qa(e);d.qa(E);d.start();O("macros-addon-sidebar").Na(KEi(t));O("macros-addon-sidebar-focus").Na(LEi(t,c||!1));O("macros-application-focus").Na(!0);O("macros-application-sidebar").Na(!0);O("macros-editor").Na(!R.xa||R.F);O("macros-exec").Na(!0);O("macros-extension-disabled").Na(!0);O("macros-extension-help").Na(!0);O("macros-extension-install-start").Na(!0);O("macros-extension-menu-promo").Na(!0);O("macros-manage").Na(!0);O("macros-resume").Na(!0);O("macros-trigger-0").Na(!0);O("macros-trigger-1").Na(!0);
O("macros-trigger-2").Na(!0);O("macros-trigger-3").Na(!0);O("macros-trigger-4").Na(!0);O("macros-trigger-5").Na(!0);O("macros-trigger-6").Na(!0);O("macros-trigger-7").Na(!0);O("macros-trigger-8").Na(!0);O("macros-trigger-9").Na(!0);null!=this.H&&(a=y(a,"docs-isctp"),this.H.ea=a,this.J.listen(d.J,"scpep",w(this.La,this)));this.J.listen(oG,"runMacro",w(this.Ha,this))};nFi.prototype.La=function(a){null!=this.H&&(a=zi(a.C(),1),this.H.ea=a)};
nFi.prototype.Ha=function(a){var b=a.payload;a=gd(tj().pT()(),Boa);a=kd(a,function(c){return c.getFunctionName()==b});null!=a&&kh(a,1)?O("macros-exec").pb(new yBi(ph(a,1),b,void 0,void 0,void 0,kh(a,12)?a.vr():void 0)):pG("Script function "+(b+" could not be found"))};function oFi(a){var b=a.yGa;a='<div class="waffle-record-script-dialog-name-section"><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-name-input" id="waffle-record-script-name-input-label">Name</label></div><div class="waffle-record-script-name"><input class="waffle-record-script-name-input jfk-textinput" id="waffle-record-script-name-input" maxlength="50" aria-labelledby="waffle-record-script-dialog-description-id waffle-record-script-name-input-label"/></div></div><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-shortcut-input">Shortcut (optional)</label></div><div class="waffle-record-script-shortcut"><label for="waffle-record-script-shortcut-input" id="waffle-record-script-shortcut-input-label">'+
(vr(b)+'</label><input class="waffle-record-script-shortcut-input jfk-textinput" id="waffle-record-script-shortcut-input" maxlength="1" aria-labelledby="waffle-record-script-shorcut-description-id"/><div id="waffle-record-script-shorcut-description-id" style="display:none;">');b="Optional numeric shortcut key, use with "+(vr(b)+" to run macro.");return T(a+b+"</div></div>")};function pFi(a,b){Ev.call(this,void 0,void 0,b);this.qr=!1;rs(this,!1);this.F=new kv;this.Ga(this.F);this.H=new yV(this.oa());this.Ga(this.H);this.L=new kv("Number");this.Ga(this.L);this.C=new yV(this.oa());this.Ga(this.C);ss(this,(new ps).Df({key:"discard",caption:"Discard"},!1).Df(VWa,!0))}v(pFi,Ev);p=pFi.prototype;
p.Ca=function(){Ev.prototype.Ca.call(this);y(A(),"docs-egmd")?(Ur(ns(this),"waffle-record-script-dialog-gm"),Cs(this,"save")):Ur(ns(this),"waffle-record-script-dialog");this.setTitle("Save new macro");this.yb().appendChild(sr(oFi,{yGa:Np?"\u2318 + Option + Shift +":"Ctrl + Alt + Shift +"}))};
p.Ia=function(){Ev.prototype.Ia.call(this);this.F.Va(this.Ea("waffle-record-script-name-input"));y(A(),"docs-egmd")||Ur(this.Ea("waffle-record-script-name"),Uof.getInstance().Nb());this.F.setValue("Untitled Macro");var a=this.F.Ka();this.H.setPosition(3,2);this.H.render();this.H.Vi(a);BV(this.H,a);AV(this.H);this.L.Va(this.Ea("waffle-record-script-shortcut-input"));y(A(),"docs-egmd")||Ur(this.Ea("waffle-record-script-shortcut"),Uof.getInstance().Nb());var b=this.L.Ka();this.C.setPosition(3,2);this.C.render();
this.C.Vi(b);BV(this.C,b);AV(this.C);this.getHandler().listen(this,"dialogselect",this.zec).listen(a,["focus","blur","change"],this.hOb).listen(b,["focus","blur","change"],this.vUb)};p.focus=function(){Ev.prototype.focus.call(this);nv(this.F)};p.hOb=function(){""!=this.F.getValue()&&AV(this.H)};p.vUb=function(){qFi(this)&&AV(this.C)};
p.zec=function(a){var b=this,c=kq(new jq,12).build();if("discard"==a.key)Hz.pb(void 0,c);else if("save"==a.key)if(""!=this.F.getValue()||zV(this.H,"Must not be empty.",!0),qFi(this)||setTimeout(function(){zV(b.C,"Must be a number from 0 to 9 or blank.",!0)}),rFi(this)&&setTimeout(function(){zV(b.C,"Conflicts with another shortcut.",!0)}),""!=this.F.getValue()&&qFi(this)&&!rFi(this)){a=this.F.getValue();var d=this.L.getValue();clb.pb(new SEi(a,d),c)}else a.preventDefault()};
function qFi(a){a=a.L.getValue();return""==a||/^\d$/.test(a)}function rFi(a){var b="Ctrl+Alt+Shift+"+a.L.getValue();return tj().pT()().map(Boa).some(function(c){return kh(c,9)&&ph(c,9)==b})};function sFi(){Un.apply(this,arguments)}v(sFi,Un);sFi.prototype.F=function(){return nFi};sFi.prototype.H=function(){return pFi};sFi.prototype.C=function(a,b,c){return new cBi(a,b,c,void 0)};sFi.prototype.D=function(a,b,c){return new sBi(a,b,c,void 0)};Do("ritzmaestro",sFi);
