w_j.prototype.ufa=x(4176,function(a){this.C.C.w$(a)});E_j.prototype.ufa=x(4175,function(a){this.D.ufa(a)});UYa.prototype.hwa=x(227,function(){return uk(this,3)});h3a.prototype.hwa=x(226,function(){return uk(this,3)});wJa.prototype.QB=x(217,function(){return uk(this,2)});iRa.prototype.QB=x(216,function(){return uk(this,1)});Kua.prototype.EB=x(190,function(){return jj(this,12)});Mua.prototype.EB=x(189,function(){return this.message.EB()});uXj.prototype.EB=x(188,function(){return Q(this,2)});
AXj.prototype.EB=x(187,function(){return Q(this,2)});function ggs(a){nz(a,function(b){b=new (b.H())(a.H,a.Hb);mz(a,b);b.setVisible(!0)},"ritzmaestro")}function hgs(a,b){nz(a,function(c){c=c.C(b,this.H,this.zb);mz(this,c);c.setVisible(!0)},"ritzmaestro")}function igs(a,b){nz(a,function(c){c=c.D(b,this.H,this.zb);mz(this,c);c.setVisible(!0)},"ritzmaestro")}function jgs(a,b){a.D=b}function kgs(a,b){var c=gg;kg(a,function(d,e){return c(b(d),b(e))})}function lgs(a){sj.call(this,a)}y(lgs,sj);
lgs.prototype.Lg=function(){return this.message.Lg()};function mgs(a){var b=ngs();ogs(b);return vj(b,3,a)}function ogs(a){a.Rp(1,2,3,4,5,6)}function pgs(a){this.Jb=$i(a,-1,0)}y(pgs,aj);pgs.prototype.Ab=function(){return new lgs(this)};pgs.prototype.Lg=function(){return jj(this,1)};function ngs(){var a=void 0===a?dj(pgs):a;return new lgs(a)}function qgs(a){sj.call(this,a)}y(qgs,sj);qgs.prototype.getFunctionName=function(){return this.message.getFunctionName()};function rgs(a){this.Jb=$i(a,-1,0)}
y(rgs,aj);rgs.prototype.Ab=function(){return new qgs(this)};rgs.prototype.getFunctionName=function(){return jj(this,2)};function sgs(){var a=void 0===a?dj(rgs):a;return new qgs(a)}function tgs(a){sj.call(this,a)}y(tgs,sj);function ugs(a,b){return zj(a,1,b)}function vgs(a){this.Jb=$i(a,-1,0)}y(vgs,aj);vgs.prototype.Ab=function(){return new tgs(this)};function wgs(){var a=void 0===a?dj(vgs):a;return new tgs(a)}
function xgs(a,b){var c=this;this.J=a;this.F=new fi;this.C=new Map;this.D=new Map;this.H=new Mm(this);this.H.listen(b,"external_data_change",function(){ygs(c);c.F.dispatchEvent(null)});ygs(this)}
function zgs(a,b,c){for(var d=da(qj(b,1,rgs).Oc()),e=d.next();!e.done;e=d.next()){var f=e.value;ej(f,2);e=f.getFunctionName();var h=a.C.get(e);if(h)if(gj(f,5))a.C.delete(e),a.D.set(e,h);else{h=h.Ab();ej(f,3);var k=jj(f,3);vj(h,8,k);ej(f,4)?(f=jj(f,4),vj(h,9,f)):tj(h,9);a.C.set(e,h.build())}else h=a.D.get(e).Ab(),ej(f,3),f=jj(f,3),vj(h,8,f),a.C.set(e,h.build()),a.D.delete(e)}a.F.dispatchEvent(null);Xl(Po(Eo(a.J.Hi("/editactions"),{data:JSON.parse(b.Ob())}),"POST"),c).Ii()}
function ygs(a){var b=il().Pca()().map(Lua),c=new Map,d=new Map;b=da(b);for(var e=b.next();!e.done;e=b.next())e=e.value,ej(e,8)?c.set(e.getFunctionName(),e):gj(e,11)||d.set(e.getFunctionName(),e);a.C=c;a.D=d}function Ags(){return Mq('<div class="waffle-edit-actions-dialog-scroll"><div class="waffle-edit-actions-dialog-actions-row-container"></div><div class="waffle-edit-actions-empty" role="alert">There are no macros</div></div>')}
function Bgs(a){return Mq('<div class="waffle-edit-actions-row"><div class="waffle-edit-actions-row-name"><input class="waffle-edit-actions-name-input jfk-textinput" maxlength="50"/><div class="waffle-edit-actions-shortcut-conflict-message"></div></div><div class="waffle-edit-actions-options"><div class="waffle-edit-actions-row-shortcut-prefix">'+Lq(a.Lnb)+'</div><div class="waffle-edit-actions-row-shortcut"><input class="waffle-edit-actions-row-shortcut-input jfk-textinput" maxlength="1"/></div><div class="waffle-edit-actions-row-menu"></div></div></div>')}
;function Cgs(a,b,c,d){ut.call(this,void 0,!1,d);var e=this;this.V=a;this.R=Array.from(this.V.C.values());kgs(this.R,function(f){return f.getFunctionName()});this.F=b;this.X=c;this.C=new Map;this.O=null;this.H=new P9c("Macro removed","UNDO",function(){return Dgs(e)},void 0,this.Ea(),"off");this.Fa(this.H);fXb(this.X,this.H);Cr(this,(new Ar).Hj(Er,!1,!0).set("save","Update",!0))}y(Cgs,ut);
Cgs.prototype.Ia=function(){ut.prototype.Ia.call(this);this.AB=!1;Br(this,!1);Egs(this,!1);lr(yr(this),"waffle-edit-actions-dialog-gm");Hr(this,"save");this.setTitle("Manage macros");this.Lc().appendChild(Jq(Ags));for(var a=this.Ka("waffle-edit-actions-dialog-actions-row-container"),b=da(this.R),c=b.next();!c.done;c=b.next()){c=c.value;var d=new Fgs(c,this.F);this.Na(d);this.C.set(c.getFunctionName(),d);d.render(a)}oq(this.Ka("waffle-edit-actions-empty"),!1);this.H.render();lr(this.H.Sa(),"waffle-edit-actions-undo-remove-toast")};
function Egs(a,b){Dr(a.D,"save").disabled=!b}Cgs.prototype.Oa=function(){var a=this;ut.prototype.Oa.call(this);Ggs(this);this.getHandler().listen(this,"dialogselect",this.ma).listen(this.Sa(),"keydown",function(b){13==b.keyCode&&"INPUT"==b.target.tagName&&(b.target.setSelectionRange(0,0),b.target.blur(),b.preventDefault());90==b.keyCode&&b.ctrlKey&&Dgs(a)});Hgs(this)};
function Ggs(a){for(var b={},c=da(a.C.values()),d=c.next();!d.done;b={Caa:b.Caa},d=c.next())b.Caa=d.value,a.getHandler().listen(b.Caa.X,"action",function(e){return function(){return Igs(a,e.Caa)}}(b)).listen(Jgs(b.Caa),"input",function(e){return function(){var f=e.Caa;Kgs(f)?JY(f.g9):IY(f.g9,"Must be a number from 0 to 9 or blank.",!0);f=!Hgs(a)&&Kgs(f);Egs(a,f)}}(b)).listen(Lgs(b.Caa),"input",function(){a.F.C(29573);Egs(a,!0)})}
function Hgs(a){var b=new Map;a=da(a.C.values());for(var c=a.next();!c.done;c=a.next())c=c.value,b.has(Mgs(c))?b.get(Mgs(c)).push(c):b.set(Mgs(c),[c]);a=!1;c=null;b=da(b);for(var d=b.next();!d.done;d=b.next()){var e=da(d.value);d=e.next().value;e=e.next().value;1<e.length&&""!=d?(a=!0,c=d,e.forEach(function(h){h=h.Ka("waffle-edit-actions-shortcut-conflict-message");on(h,"Conflicts with another shortcut");oq(h,!0)})):e.forEach(function(h){h=h.Ka("waffle-edit-actions-shortcut-conflict-message");oq(h,
!1)})}if(a){var f="Can't save conflicting shortcut "+c;setTimeout(function(){return gx(f)})}return a}function Igs(a,b){Egs(a,!0);a.O=b;a.C.delete(b.Aa);oq(b.Sa(),!1);Hgs(a);a.H.setVisible(!0);0==a.C.size&&oq(a.Ka("waffle-edit-actions-empty"),!0);a.Sa().focus();var c="Macro "+(b.C.getValue()+" was removed, Ctrl-Z to Undo");setTimeout(function(){return gx(c)});a.F.C(29572)}
function Dgs(a){if(null!=a.O){var b=a.O;a.C.set(b.Aa,b);oq(b.Sa(),!0);oq(a.Ka("waffle-edit-actions-empty"),!1);Hgs(a);a.O=null;var c="Macro "+(b.C.getValue()+" is restored.");setTimeout(function(){return gx(c)});a.F.C(29577)}}
Cgs.prototype.ma=function(a){var b=this;if("cancel"==a.key)this.F.C(29569);else if("save"==a.key){for(var c=da(this.C.values()),d=c.next();!d.done;d=c.next())if(d=d.value,!Kgs(d)||""!=Ngs(d)){a.preventDefault();return}Hgs(this)?a.preventDefault():(a=Ogs(this),zgs(this.V,a,function(){var e=Gt(b.X,"Failed to update macros.",Tm(),!0,0,!0,void 0,!0,["waffle-edit-actions-update-failed"]);e.C=!0;e.render();e.setVisible(!0)}),this.F.C(29574),setTimeout(function(){return gx("Macros updated")}))}};
function Ogs(a){for(var b=wgs(),c=da(a.R),d=c.next();!d.done;d=c.next()){var e=d.value;d=sgs();var f=!1,h=a.C.get(e.getFunctionName()),k=jj(e,9),l=jj(e,8);h?(k!=Mgs(h)&&(k=Mgs(h),f=!0),l!=h.C.getValue()&&(l=h.C.getValue(),f=!0)):(uj(d,5,!0),f=!0);f&&(f=jj(e,1),vj(d,1,f),e=e.getFunctionName(),vj(d,2,e),vj(d,3,l),k&&vj(d,4,k),d=d.build(),yj(b,1,d))}return b.build()}
function Fgs(a,b,c){uq.call(this,c);this.oa=a;this.Ga=jj(a,8);this.Aa=a.getFunctionName();this.J=(a=jj(a,9))?a.split("+"):[];this.D=new it;this.Na(this.D);this.O=this.R=null;this.C=new it;this.Na(this.C);this.ma=new xt;this.Fa(this.ma);this.Ca=b;b=Sr(fs,"waffle-overflow-menu-material");this.H=new ss(void 0,void 0,b,this.Ea());this.Fa(this.H);this.V=new ks("Edit script");this.Fa(this.V);this.X=new ks("Remove");this.Fa(this.X);this.g9=new HY(this.Ea());this.Fa(this.g9);this.F=new HY(this.Ea());this.Fa(this.F)}
y(Fgs,uq);Fgs.prototype.Ia=function(){var a=(Pf(this.J)?Pgs:this.J.slice(0,this.J.length-1)).join(" + ")+" + ";a=Jq(Bgs,{Lnb:lp?a.replace(/Ctrl/g,"\u2318").replace(/Alt/g,"Option"):a});this.Qb(a)};
Fgs.prototype.Oa=function(){var a=this;this.D.xb(this.Ka("waffle-edit-actions-row-shortcut-input"));this.D.setValue(yf(this.J)||"");var b=this.Ka("waffle-edit-actions-name-input");this.C.xb(b);this.C.setValue(this.Ga);this.ma.xb(b);this.g9.setPosition(3,2);this.g9.render();b=this.D.Sa();this.g9.kp(b);KY(this.g9,b);JY(this.g9);this.F.setPosition(0,2);this.F.render();b=this.C.Sa();this.F.kp(b);KY(this.F,b);JY(this.F);b=new er(this.H.Lc(),13);qMb(this.H,b);this.H.$V=!0;this.H.ze(this.V);this.H.ze(this.X);
b=this.Ka("waffle-edit-actions-row-menu");this.H.xb(b);"black"==vs()&&lr(b,"waffle-overflow-menu-material-white");this.getHandler().listen(this.V,"action",function(){U("macros-editor").qc({scriptId:jj(a.oa,1),filename:jj(a.oa,10)});a.Ca.C(29570)}).listen(this.C.Sa(),"blur",function(){""==Ngs(a)?JY(a.F):IY(a.F,Ngs(a),!0)}).listen(this.D.Sa(),"click",function(){return a.D.Sa().select()}).listen(Jgs(this),"input",function(){return a.Ca.C(29571)});ir(this.Ka("waffle-edit-actions-name-input"),"Macro name");
ir(this.D.Sa(),"Numeric shortcut key");ir(b,"More options button")};function Mgs(a){var b=a.D.getValue();return""==b?"":(Pf(a.J)?Pgs:a.J.slice(0,a.J.length-1)).join("+")+"+"+b}function Jgs(a){null==a.R&&(a.R=new wt(a.D.Sa()),a.Fa(a.R));return a.R}function Lgs(a){null==a.O&&(a.O=new wt(a.C.Sa()),a.Fa(a.O));return a.O}function Kgs(a){a=a.D.getValue();return""==a||/^\d$/.test(a)}
function Ngs(a){a=a.C.getValue();return""==a?"Macro name must be not be empty.":/\r|\n/.test(a)?"Macro name must not contain line-break characters.":""}var Pgs=["Ctrl","Alt","Shift"];function Qgs(){return Mq('<div class="waffle-import-custom-function-actions-title-separator"></div><div class="waffle-import-custom-function-actions-dialog-scroll"><div class="waffle-import-custom-functions-row-container"></div></div>')}
function Rgs(a){var b=a.Ked,c=a.fileName;a='<div class="waffle-import-custom-function-row" tabindex="0"><div class="waffle-import-custom-function-name">'+Lq(a.functionName)+'</div><div class="waffle-import-custom-function-metadata"><div class="waffle-import-custom-function-project-name"><span class="waffle-import-custom-function-description-label">';a=a+'Project:</span><span class="function-description-seperator"></span>'+(Lq(b)+'</div><div class="waffle-import-custom-function-file-name"><span class="waffle-import-custom-function-description-label">');
a=a+'File:</span><span class="function-description-seperator"></span>'+(Lq(c)+'</div></div><div class="waffle-import-custom-function-view-script"></div><div class="waffle-import-custom-function-add-function"></div></div>');return Mq(a)};function Sgs(a,b,c,d){ut.call(this,void 0,!1,d);this.ma=a;this.H=Array.from(this.ma.D.values());kgs(this.H,function(e){return e.getFunctionName()});this.X=b;this.Ca=c;this.V=[];this.F=[];this.C=Gt(this.Ca,"Function added.",Tm(),!1,3E3,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);this.Fa(this.C);this.Ga=new zt(this.Ea());this.Fa(this.Ga);this.O=new go(this.R,3E3,this);this.Fa(this.O)}y(Sgs,ut);
Sgs.prototype.Ia=function(){ut.prototype.Ia.call(this);lr(yr(this),"waffle-import-custom-function-actions-dialog");this.setTitle("Import");var a=this.Ea().Ia("DIV","waffle-import-custom-function-title-description",Yt()?"Added functions will appear in the menu under Extensions > Macros":"Added functions will appear in the menu under Tools > Macros");ZJb(this).appendChild(a);this.Lc().appendChild(Jq(Qgs));a=this.Ka("waffle-import-custom-functions-row-container");for(var b=da(this.H),c=b.next();!c.done;c=
b.next())c=new Tgs(c.value,this.X),this.Na(c),c.render(a),this.V.push(c);this.C.render();this.C.setVisible(!1);Cr(this,null)};Sgs.prototype.Oa=function(){var a=this;ut.prototype.Oa.call(this);for(var b={},c=da(this.V),d=c.next();!d.done;b={HHa:b.HHa},d=c.next())b.HHa=d.value,this.getHandler().listen(b.HHa.D,"action",function(e){return function(){return Ugs(a,e.HHa)}}(b));this.getHandler().listen(this,"hide",function(){return a.R()})};
function Ugs(a,b){Vgs(b);var c=Wgs(b.C);Xgs(a,c);b=b.Ka("waffle-import-custom-function-add-function");b.setAttribute("tabindex","0");ir(b,"This function has been added.");b.focus();a.X.C(29576);setTimeout(function(){return a.C.setVisible(!0)})}function Wgs(a){var b=sgs();var c=jj(a,1);b=vj(b,1,c);c=a.getFunctionName();b=vj(b,2,c);a=a.getFunctionName();return vj(b,3,a).build()}function Xgs(a,b){a.F.push(b);a.O.start()}
Sgs.prototype.R=function(){var a=this;if(0<this.F.length){var b=ugs(wgs(),this.F).build();zgs(this.ma,b,function(){var c=Gt(a.Ca,"Failed to add function.",Tm(),!1,1E4,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);c.C=!0;c.render();c.setVisible(!0)});this.F=[]}};function Tgs(a,b,c){uq.call(this,c);this.C=a;this.H=b;a=Bt.rb();this.D=new gs("Add Function",a,c);this.Na(this.D);this.F=new gs("Edit Script",a,c);this.Na(this.F)}y(Tgs,uq);
Tgs.prototype.Ia=function(){uq.prototype.Ia.call(this);var a=Jq(Rgs,{functionName:this.C.getFunctionName(),Ked:jj(this.C,2),fileName:jj(this.C,10)});this.Qb(a);this.D.render(this.Ka("waffle-import-custom-function-add-function"));this.F.render(this.Ka("waffle-import-custom-function-view-script"))};
Tgs.prototype.Oa=function(){var a=this;uq.prototype.Oa.call(this);this.getHandler().listen(this.F,"action",function(){U("macros-editor").qc({scriptId:jj(a.C,1),filename:jj(a.C,10)});a.H.C(29575)});var b="Function: "+(this.C.getFunctionName()+(", from project: "+(jj(this.C,2)+(", defined in file: "+jj(this.C,10)))));ir(this.Sa(),b)};function Vgs(a){oq(a.D.Sa(),!1);lr(a.Ka("waffle-import-custom-function-add-function"),"waffle-import-custom-function-actions-checkmark")};function Ygs(a,b,c,d,e,f){ii.call(this);this.C=a;this.functionName=b;this.F=d||null;this.D=void 0!==f?f:null}y(Ygs,ii);function Zgs(a){P(this,a,0,-1,$gs,null)}z(Zgs,O);var $gs=[6];u=Zgs.prototype;u.Ba=function(){var a=new K;ahs(this,a);return L(a)};
function ahs(a,b){var c=Q(a,1);null!=c&&b.Ha(1,c);c=Q(a,2);null!=c&&b.Ha(2,c);c=Q(a,3);null!=c&&b.Ha(3,c);c=Q(a,4);null!=c&&b.Ha(4,c);c=Q(a,5);null!=c&&b.Ha(5,c);c=a.Em();0<c.length&&kk(b,6,c,ahs);c=Q(a,7);null!=c&&N(b,7,c);c=Q(a,9);null!=c&&b.Ha(9,c);c=Q(a,10);null!=c&&b.Ha(10,c);c=Q(a,11);null!=c&&dk(b,11,c);c=Q(a,12);null!=c&&dk(b,12,c);c=Q(a,13);null!=c&&b.Ha(13,c)}u.Xh=function(){return Q(this,1)};u.Vk=function(){return Q(this,2)};u.ys=function(a){R(this,2,a)};
u.getKey=function(){return Q(this,5)};u.Em=function(){return Kk(this,Zgs,6)};u.ze=function(a,b){return Ok(this,6,a,Zgs,b)};u.Xa=function(a){return R(this,7,a)};u.EB=function(){return Q(this,13)};function bhs(a){P(this,a,"amep",-1,null,null)}z(bhs,O);bhs.prototype.Ba=function(){var a=new K;var b=this.Nc();null!=b&&a.xa(1,b,ahs);return L(a)};bhs.messageId="amep";bhs.prototype.Nc=function(){return S(this,Zgs,1,1)};bhs.prototype.Lh=function(a){return Lk(this,1,a)};bhs.prototype.Oua=function(){R(this,1,void 0)};bhs.prototype.nE=function(){return rk(this,1)};function chs(a){Bm.call(this,a)}y(chs,Bm);function dhs(a){Bm.call(this,"amep");this.D=new bhs(a)}y(dhs,chs);dhs.prototype.C=n("D");function ehs(a){P(this,a,0,-1,null,null)}z(ehs,O);ehs.prototype.Ba=function(){var a=new K;fhs(this,a);return L(a)};
function fhs(a,b){var c=Q(a,1);null!=c&&b.Ha(1,c);c=Q(a,2);null!=c&&b.Ha(2,c);c=Q(a,3);null!=c&&b.Ha(3,c);c=Q(a,4);null!=c&&N(b,4,c);c=Q(a,5);null!=c&&b.Ha(5,c);c=Q(a,6);null!=c&&b.Ha(6,c);c=Q(a,7);null!=c&&b.Ha(7,c);c=Q(a,8);null!=c&&N(b,8,c);c=Q(a,9);null!=c&&N(b,9,c);c=Q(a,10);null!=c&&N(b,10,c);c=Q(a,11);null!=c&&b.Ha(11,c);c=Q(a,12);null!=c&&N(b,12,c);c=Q(a,13);null!=c&&b.Ha(13,c);c=Q(a,14);null!=c&&b.Ha(14,c);c=Q(a,15);null!=c&&b.Ha(15,c);c=Q(a,16);null!=c&&b.Ha(16,c);c=Q(a,17);null!=c&&b.Ha(17,
c);c=Q(a,18);null!=c&&Yj(b,18,c);c=Q(a,19);null!=c&&N(b,19,c)}function N9(a){return Q(a,2)}ehs.prototype.getName=function(){return Q(this,3)};ehs.prototype.Gq=function(){return Q(this,13)};function ghs(a,b){this.D=void 0===a?null:a;this.C=(void 0===b?null:b)||null}ghs.prototype.F=n("C");function hhs(a,b){return of(vf(),"docs-emgsmw")?null==a.F||null==Q(b,18)?!1:a.C===Q(b,18):a.D===Q(b,1)}function ihs(a){return new ghs(Q(a,1),Q(a,18))};function jhs(a){P(this,a,"der",-1,null,null)}z(jhs,O);jhs.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);return L(a)};jhs.messageId="der";jhs.prototype.QB=function(){return uk(this,1)};function khs(a){P(this,a,"eer",-1,null,null)}z(khs,O);khs.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);return L(a)};khs.messageId="eer";khs.prototype.QB=function(){return uk(this,1)};function lhs(a,b,c){this.D=a;this.C=b;this.F=c}lhs.prototype.getVersionInfo=n("F");function mhs(a,b){this.C=a;this.D=b}mhs.prototype.getVersionInfo=n("D");function nhs(a,b){this.C=a;this.Ng=b}nhs.prototype.getExtension=n("C");nhs.prototype.isEnabled=n("Ng");function ohs(a){ut.call(this);this.C=a;zr(this,!0);this.aN(!1);Cr(this,null);Br(this,!1)}y(ohs,ut);ohs.prototype.Ia=function(){ut.prototype.Ia.call(this);this.C.render(this.Lc())};ohs.prototype.Oa=function(){ut.prototype.Oa.call(this);var a=this.Sa();hr(a,"labelledby");ir(a,"Add-ons");lr(yr(this),"gsm-widget")};function phs(a,b){var c=new Wk,d=new XBa;if(b){if(Q(b,1)){var e=Q(b,1);R(d,1,e)}e=uk(b,12);R(d,2,e);rk(b,18)&&(e=Q(b,18),R(d,5,e));b=uk(b,19);R(d,6,b)}b=pf(vf(),"docs-tcmt");e=!!b;R(d,3,e);e&&R(d,4,b);Lk(c,73,d);return Fp(Gp(new Ep,c),a).build()}function qhs(a){var b=new Wk,c=new XBa;null!=a.D&&R(c,1,a.D);null!=a.C&&R(c,5,a.C);Lk(b,73,c);return Fp(Gp(new Ep,b),90).build()};function rhs(a,b,c){mSk.call(this,a);this.D=b;this.F=c;this.D.Qp=!0}y(rhs,mSk);u=rhs.prototype;u.aib=function(){U("macros-extension-store-render").qc()};u.eVa=function(a,b,c){a=new ghs(null,a);U("macros-extension-store-install").qc(new lhs(a,String(b),c),qhs(a))};u.$hb=function(a,b){a=new ghs(null,a);U("macros-extension-store-uninstall-item").qc(new mhs(a,b),qhs(a))};
u.iQb=function(a){var b=new iSk,c=this.F(new ghs(null,a));if(!c)return b;a=c.getExtension();c=c.isEnabled();var d=new kSk;d.ys("Use in this document");R(d,3,"useInDoc");d.Yc(!!uk(a,4)||!!uk(a,12));d.Xa(c);var e=new kSk;e.ys("Help");R(e,3,"help");d=[d,e];uk(a,9)&&(e=new kSk,R(e,1,!0),d.push(e),uk(a,8)&&(a=new kSk,a.Xa(c),a.ys("Settings"),R(a,3,"settings"),d.push(a)),a=new kSk,a.ys("Report an issue"),R(a,3,"reportIssue"),d.push(a));Nk(b,1,d);return b};
u.hQb=function(a,b){var c=new ghs(null,a);a=qhs(c);switch(b){case "help":b=this.F(c);if(!b)break;b=b.getExtension();U("macros-extension-help").qc(N9(b),a);break;case "reportIssue":U("macros-extension-store-report").qc(c,a);break;case "settings":U("macros-extension-store-settings").qc(c,a);ki(this.D);break;case "useInDoc":U("macros-extension-store-use-in-doc").qc(c,a)}};u.NWa=function(){this.D.setVisible(!1)};function shs(a,b,c){ii.call(this);this.C=ths(a);this.F=b;this.D=c}y(shs,ii);function uhs(a,b,c,d,e){b=new VZk(b,null,e);WZk(b,rf(vf(),"docs-gsmd"));a.D&&ZZk(b,a.D);jgs(b,c.map(function(f){return f.C}));d&&d.C&&(b.F=d.C);a=rf(vf(),"gaia_session_id");a=sg(a)?NaN:Number(a);isNaN(a)||XZk(b,a);return b.build()}function vhs(a,b){var c=new ohs(b);a=new rhs(b,c,a.F);c.Fa(a);return c}
function ths(a){if(a==(Ls(),KPb))return"docs_addon";if(a==(Ls(),LPb))return"sheets_addon";if(a==(Ls(),MPb))return"slides_addon";if(a==(Ls(),OPb))return"forms_addon";throw Error("Unsupported document type for GSM  ["+a+"]");};function whs(a,b,c,d,e,f){ii.call(this);this.F=b;this.D=new shs(a,d,f);this.C=null}y(whs,ii);function xhs(a){P(this,a,"iar",-1,null,null)}z(xhs,O);xhs.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);b=Q(this,2);null!=b&&a.Ha(2,b);b=Q(this,3);null!=b&&N(a,3,b);return L(a)};xhs.messageId="iar";xhs.prototype.QB=function(){return uk(this,1)};function yhs(a,b,c,d){var e=Q(a,4)+"-polymorphic-"+(a.Xh()||"");HEb.call(this,e);this.C=a;this.R=Df(b,function(f){return new yhs(f,[],!1)},this);this.Xa(this.isEnabled());this.Aa=c;this.oa="boolean"===typeof d?d:!0}y(yhs,HEb);yhs.prototype.isInstalled=n("oa");yhs.prototype.qc=function(){U("macros-polymorphic-item").qc(this)};yhs.prototype.isEnabled=function(){return this.R&&(0<this.R.length?!0:!!uk(this.C,7))};yhs.prototype.getLabel=function(){return this.C.Vk()||Q(this.C,10)||""};function zhs(){Bm.call(this,"Jl")}y(zhs,Bm);function Ahs(){Jm.call(this);this.C={};this.C[1]={};this.C[0]={};this.D=new Bs(this);this.Fa(this.D);this.D.subscribe(U("macros-polymorphic-item"),"action",this.F)}y(Ahs,Jm);Ahs.prototype.F=function(a){a.Aa||0<a.R.length?this.dispatchEvent(new zhs(a)):(a=new Ygs(Q(a.C,4),Q(a.C,3),void 0,Q(a.C,9)||void 0,void 0,a.C.EB()||void 0),U("macros-exec").qc(a))};function Bhs(a){P(this,a,"ger",-1,Chs,null)}z(Bhs,O);var Chs=[1];Bhs.prototype.Ba=function(){var a=new K;var b=this.oLa();0<b.length&&kk(a,1,b,fhs);return L(a)};Bhs.messageId="ger";Bhs.prototype.oLa=function(){return Kk(this,ehs,1)};function Dhs(a){P(this,a,0,-1,null,null)}z(Dhs,O);Dhs.prototype.Ba=function(){var a=new K;Ehs(this,a);return L(a)};function Ehs(a,b){var c=Q(a,1);null!=c&&b.Ha(1,c);c=Q(a,2);null!=c&&b.Ha(2,c)}Dhs.prototype.getName=function(){return Q(this,1)};function Fhs(a){P(this,a,0,-1,Ghs,null)}z(Fhs,O);var Ghs=[4];u=Fhs.prototype;u.Ba=function(){var a=new K;Hhs(this,a);return L(a)};function Hhs(a,b){var c=Q(a,1);null!=c&&b.Ha(1,c);c=Q(a,2);null!=c&&b.Ha(2,c);c=Q(a,3);null!=c&&b.Ha(3,c);c=Kk(a,Dhs,4);0<c.length&&kk(b,4,c,Ehs)}u.getId=function(){return Q(this,1)};u.qd=function(a){return R(this,1,a)};u.getName=function(){return Q(this,2)};u.Mg=function(){return Q(this,3)};u.Zn=function(a){return R(this,3,a)};function Ihs(a){P(this,a,"llr",-1,Jhs,null)}z(Ihs,O);var Jhs=[2];Ihs.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);b=Kk(this,Fhs,2);0<b.length&&kk(a,2,b,Hhs);return L(a)};Ihs.messageId="llr";Ihs.prototype.QB=function(){return uk(this,1)};function Khs(a){P(this,a,"rar",-1,null,null)}z(Khs,O);Khs.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);b=Q(this,2);null!=b&&a.Ha(2,b);return L(a)};Khs.messageId="rar";Khs.prototype.QB=function(){return uk(this,1)};function Lhs(a){P(this,a,"uer",-1,null,null)}z(Lhs,O);Lhs.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);return L(a)};Lhs.messageId="uer";Lhs.prototype.QB=function(){return uk(this,1)};function Mhs(a,b,c,d){ii.call(this);this.D=a;this.F=c;this.C=d||new Nhs}y(Mhs,ii);u=Mhs.prototype;u.fHb=function(a,b,c,d,e,f,h){a=["ruid",ta({}),this.C.C,this.D,this.C.F,a,this.C.R,b,this.C.D,c,this.C.oa,e,this.C.Aa,f,this.C.ma,h];a=No(Wl(Po(Ohs(this,this.C.V),"POST"),2),a).wC();d&&(Zl(a,va(this.VUc,this,d)),Xl(a,va(this.tAc,this,d)));a.Ii()};u.cancel=function(a){a=["ruid",ta({}),this.C.C,this.D,this.C.H,a];No(Wl(Po(Ohs(this,this.C.J),"POST"),2),a).wC().Ii()};
function Phs(a,b){var c=["ruid",ta({}),a.C.C,a.D];c=No(Wl(Ohs(a,a.C.X),2),c);b&&(Zl(c,va(a.$Ac,a,b)),Xl(c,va(a.ZAc,a,b)));c.Ii()}u.VUc=function(a,b){b=b.yh();b=new xhs(b[0]);a(b)};u.tAc=function(a){var b=new xhs;R(b,1,!1);a(b)};u.$Ac=function(a,b){b=b.yh();b=new Ihs(b[0]);a(b)};u.ZAc=function(a){var b=new Ihs;R(b,1,!1);a(b)};u.WUc=function(a,b){b=b.yh();b=new Khs(b[0]);a(b)};u.DHc=function(a){var b=new Khs;R(b,1,!1);a(b)};
function Qhs(a,b){var c=["ruid",ta({}),a.C.C,a.D];Xl(Zl(No(Wl(Ohs(a,"/scripts/getitems"),1),c),va(a.Byc,a,b)),pa).Ii()}u.Byc=function(a,b){b=b.yh();b=new Bhs(b[0]);a(b)};function Rhs(a,b,c,d){function e(h,k){k=k.yh();k=new Lhs(k[0]);h(k)}var f=["ruid",ta({}),a.C.C,a.D];null!=b.D&&f.push("storeitemid",b.D);null!=b.C&&f.push("appid",b.C);d&&f.push("versioninfo",d);b=No(Po(Ohs(a,"/scripts/uninstallitem"),"POST"),f).wC();c&&(Zl(b,va(e,a,c)),a=new Lhs,R(a,1,!1),Xl(b,wa(c,a)));b.Ii()}
u.dwb=function(a,b,c,d,e,f){a=["ruid",ta({}),this.C.C,this.D,this.C.D,e,"extensionid",a,"justInstalled",d];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);f&&a.push("versioninfo",f);b=No(Wl(Po(Ohs(this,"/scripts/enableitem"),"POST"),1),a).wC();c&&(Zl(b,va(this.Jwc,this,c)),Xl(b,va(this.Iwc,this,c)));b.Ii()};u.Jwc=function(a,b){b=b.yh();b=new khs(b[0]);a(b)};u.Iwc=function(a){var b=new khs;R(b,1,!1);a(b)};
u.D8b=function(a,b,c,d){a=["ruid",ta({}),this.C.C,this.D,this.C.D,d,"extensionid",a];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);b=No(Wl(Po(Ohs(this,"/scripts/disableitem"),"POST"),1),a).wC();c&&(Zl(b,va(this.gvc,this,c)),Xl(b,va(this.fvc,this,c)));b.Ii()};u.gvc=function(a,b){b=b.yh();b=new jhs(b[0]);a(b)};u.fvc=function(a){var b=new jhs;R(b,1,!1);a(b)};function Ohs(a,b){return Oo(a.F.Hi(b)).setTimeout(4E4)}
function Nhs(a,b,c,d,e,f,h,k,l,m,p,r,t,v,A,G,M,T){ii.call(this);this.C=a||"id";this.F=c||"lib";this.R=d||"func";this.D=e||"ctx";this.H=f||"pid";this.oa=G||"eei";this.Aa=M||"usit";this.ma=void 0!==T?T:"did";this.O=h||"ca";this.V=k||"/scripts/invoke";this.J=l||"/scripts/cancel";this.X=m||"/scripts/libraries";this.Ca=p||"/scripts/resume";this.Ga=t||"/scripts/uiready"}y(Nhs,ii);function Shs(a,b,c,d,e,f,h,k,l,m,p,r){ii.call(this);var t=this;this.Ga=m?H8c(m):void 0;this.Ca=m?I8c(m):void 0;this.Aa=a;this.C=d;this.Ja=e;this.oa=b;this.R=f;this.F=h;this.O=k;this.D=[];this.H=l;this.J=new RKb("mae-show_addons_menu_promo");Nr(c,this.J,"mae-show_addons_menu_promo");this.ma=p||null;this.X=r||null;this.V=new whs(this.Aa,this.oa,this,function(v){if(v=t.getExtension(v)){var A=2==t.H?!1:1==t.H?!(!uk(v,10)||!uk(v,9)):!0;v=new nhs(v,A)}else v=void 0;return v},this.Ca,this.Ga);this.Fa(this.V);
U("macros-extension-store-install").Kc(cp,this.cxc,this);U("macros-extension-store-install").Xa(!0);U("macros-extension-store-render").Kc(cp,this.dxc,this);U("macros-extension-store-render").Xa(!0);U("macros-extension-store-report").Kc(cp,this.exc,this);U("macros-extension-store-report").Xa(!0);U("macros-extension-store-settings").Kc(cp,this.fxc,this);U("macros-extension-store-settings").Xa(!0);U("macros-extension-store-uninstall-item").Kc(cp,this.gxc,this);U("macros-extension-store-uninstall-item").Xa(!0);
U("macros-extension-store-use-in-doc").Kc(cp,this.hxc,this);U("macros-extension-store-use-in-doc").Xa(!0)}y(Shs,ii);u=Shs.prototype;u.dxc=function(){Ths(this)};u.cxc=function(a){a=a.data;Uhs(this,a.C,a.D,a.getVersionInfo())};u.exc=function(a){a=this.getExtension(a.data);var b=ihs(a);this.PVb(b,N9(a),a.getName(),Q(a,6)||void 0,Q(a,11)||void 0)};u.fxc=function(a){a=this.getExtension(a.data);Vhs(this,N9(a))};
u.gxc=function(a){a=a.data;var b=this.getExtension(a.C),c=b&&N9(b);b=ihs(b);Whs(this,c,b,pa,a.getVersionInfo())};u.hxc=function(a){var b=this.getExtension(a.data);a=ihs(b);uk(b,4)||uk(b,12)?Xhs(this,N9(b),a,function(c){c&&(R(b,4,!1),R(b,12,!1))}):Yhs(this,N9(b),a,function(c){c&&R(b,4,!0)})};u.Iha=function(a){var b=Zhs(this,!1),c=this.V;var d=c.D;a=uhs(d,d.C,b,a,!1);d=vhs(d,a);c.C=d;d=c.C;c.F.Dn(d);d.setVisible(!0);$hs(this)};
function Zhs(a,b){return(void 0===b?0:b)?a.D.map(function(c){return ihs(c)}):a.D.filter(function(c){return uk(c,10)&&uk(c,9)}).map(function(c){return ihs(c)})}function Vhs(a,b){ais(a.C);var c=va(function(d,e){this.C.v7();d&&d(e)},a,void 0);VUj(a.R.C,va(a.F.fHb,a.F,b,"doSettings",a.O().getState()||void 0,c))}
function Yhs(a,b,c,d){ais(a.C);VUj(a.R.C,va(a.F.dwb,a.F,b,c,va(function(e,f){if(f.QB()){var h=a.getExtension(c);h&&R(h,4,!0);Ths(a)}a.C.v7();e&&e(f.QB())},a,d),void 0,a.O().getState()||void 0))}function Xhs(a,b,c,d){ais(a.C);VUj(a.R.C,va(a.F.D8b,a.F,b,c,va(function(e,f){if(f.QB()){U("macros-extension-disabled").qc(b);var h=a.getExtension(c);h&&(R(h,4,!1),R(h,12,!1));Ths(a)}a.C.v7();e&&e(f.QB())},a,d),a.O().getState()||void 0))}
function Whs(a,b,c,d,e){Rhs(a.F,c,va(function(f,h){if(h.QB()&&b){U("macros-extension-disabled").qc(b);var k=a.D.findIndex(function(l){return hhs(c,l)});-1!=k&&Yf(a.D,k);(k=bis(a.C))&&Qg(k.J,b)}Ths(a,function(){return f(h.QB())})},a,d),e)}
u.PVb=function(a,b,c,d,e){e?Eq(e):(cis(this.C,va(function(f,h){var k=this.F,l=va(this.C.Pjd,this.C,c,h,d),m=va(this.C.Ojd,this.C);f=["ruid",ta({}),k.C.C,k.D,k.C.F,b,"issuedesc",f,"includeUserInfo",h];null!=a.D&&f.push("storeitemid",a.D);null!=a.C&&f.push("appid",a.C);No(Xl(Zl(Wl(Po(Ohs(k,"/scripts/sendissuereport"),"POST"),1),$g(l)),$g(m)),f).wC().Ii()},this),c),$hs(this))};
function Uhs(a,b,c,d){ais(a.C);VUj(a.R.C,va(a.F.dwb,a.F,b,c,function(e){a.C.v7();e.QB()?Ths(a):(e=Os("Unable to install add-on","warning",!0),a.C.C.C.postMessage(e),e.getId(),dis(a))},!0,a.O().getState()||void 0,d))}function Ths(a,b){b=void 0===b?pa:b;Qhs(a.F,va(function(c,d){d=d.oLa();Qf(this.D);d=da(d);for(var e=d.next();!e.done;e=d.next())this.D.push(e.value);eis(this);dis(this);c()},a,b))}
function eis(a){var b=a.Ja,c=bg(a.D);b.C[1]={};b.C[0]={};for(var d=0;d<c.length;++d){var e=c[d],f=N9(e),h=new Zgs,k=String(ta(h));R(h,1,k);h.ys(e.getName());k=N9(e);R(h,4,k);h.Xa(!0);k=e.getName();R(h,10,k);R(h,11,1);k=!(!uk(e,10)&&!uk(e,9));e=new yhs(h,[],!0,k,uk(e,19)||!1);e.setVisible(!0);b.C[wk(e.C,11,0)][f]=e}b.dispatchEvent("Hl");if(b=a.C.R)if(Pf(a.D))!a.J.getValue()&&U("macros-extension-menu-promo").isEnabled()&&(a=a.Aa,xib(b.F.F,"mae-promo-id")||(a=new fis(a),a.render(),c=new ks(""),c.qd("mae-promo-id"),
c.Id("script-promo-menu-item"),c.setContent(a.getElement()),Ds(b.R,c,U("macros-extension-menu-promo"),void 0,void 0,phs(3)),b.C.Ad(),b.F.Ad(),gis(b.F,c)),his(b));else{c=bg(a.D);if(b.J){kg(c,b.Ja);f=new mm;vib(f,b.C.F);b.F.Ad();b.C.Ad();d=[];for(e=0;e<c.length;++e){k=c[e];var l=N9(k),m=!(!uk(k,10)&&!uk(k,9));d.push(l);h=f.get(l);var p=uk(k,19);if(h)l=h.Nc(),m&&!p&&(m=l.Ud(0),p="addon-menu-install-"+N9(k),m&&m.getId()==p&&(l.uw(0).dispose(),2==l.Dd()&&(l.Ud(0),l.uw(0).dispose())));else{h=new rs("");
h.qd(l);h.Xa(2==b.V?!1:1==b.V?!!(k&&uk(k,10)&&uk(k,9)):!0);var r=new os;m||p||iis(b,r,k);jis(b,r,l,[],k);h.Lh(r)}k=k.getName();m=dn("span");m.appendChild(en(k));h.setContent(m);gis(b.C,h)}for(e=0;e<b.X.length;++e)gis(b.C,f.get(b.X[e]));if(b.O)for(f=f.Ri(),e=0;e<f.length;++e)if(0>d.indexOf(f[e])&&0>b.X.indexOf(f[e])&&(h=b.oa[f[e]])){for(k=0;k<h.length;++k)b.O.ufa(h[k]);delete b.oa[f[e]]}U("macros-manage-extensions").Xa(!!c.length);his(b)}a.X&&a.X.C(!!a.D.length)}}
function dis(a){var b=bis(a.C);if(b){var c=bg(a.D),d=a.H;b.C=[];for(var e=0;e<c.length;e++){var f=c[e];if(uk(f,12)||uk(f,4))Yha(b.C,f,b.bcc),b.H&&!uk(f,12)&&(b.H=!1)}U("macros-addon-sidebar-focus").Xa(0<b.C.length);b.X=0==d;b.R=!0;b.O=1==b.C.length&&null!=kis(b);b.Ic()&&lis(b);a.ma&&a.ma.C(0<b.C.length)}}u.getExtension=function(a){return this.D.find(function(b){return hhs(a,b)})};function mis(a,b){return a.D.find(function(c){return N9(c)===b})}
function $hs(a){if(!a.J.getValue()&&(a.J.setValue(!0),Pf(a.D))){var b=a.C.R;if(b){var c=$m("docs-menu-superscript",b.H.getElement());c&&mHb(c,0);b.F.Ad();his(b);eis(a)}}};function nis(a,b,c,d,e,f,h,k,l,m,p,r,t){this.H=a;this.R=b;this.O=c;this.X=d;this.V=e;this.Aa=h;this.D=k;this.C=l;this.J=m;this.ma=p;this.oa=r;this.F=t}function ois(a,b){a=a.O;if(b){a=new tm(a);var c=a.F;c+=ng(c,"/")?"":"/";ng(c,"/start/")&&(c=c.replace("start/",""));c+=Rka("d/%s/edit",b);wm(a,c);a=a.toString()}return a};function pis(a){P(this,a,0,-1,null,null)}z(pis,O);pis.prototype.Ba=function(){var a=new K;qis(this,a);return L(a)};function qis(a,b){var c=Q(a,1);null!=c&&b.Ha(1,c);c=Q(a,2);null!=c&&b.Ha(2,c);c=Q(a,3);null!=c&&Xj(b,3,c);c=Q(a,4);null!=c&&b.Ha(4,c)};function ris(a){P(this,a,0,-1,null,null)}z(ris,O);ris.prototype.Ba=function(){var a=new K;sis(this,a);return L(a)};function sis(a,b){var c=Q(a,1);null!=c&&b.Ha(1,c);c=Q(a,2);null!=c&&b.Ha(2,c);c=Q(a,3);null!=c&&b.Ha(3,c);c=Q(a,5);null!=c&&Yj(b,5,c);c=Q(a,6);null!=c&&dk(b,6,c);c=S(a,pis,7);null!=c&&b.xa(7,c,qis);c=Q(a,8);null!=c&&dk(b,8,c);c=Q(a,9);null!=c&&Yj(b,9,c);c=Q(a,10);null!=c&&Yj(b,10,c);c=Q(a,11);null!=c&&Yj(b,11,c)};function tis(a){P(this,a,"paep",-1,null,null)}z(tis,O);tis.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ha(1,b);b=Q(this,2);null!=b&&a.Ha(2,b);b=S(this,ris,3);null!=b&&a.xa(3,b,sis);b=Q(this,4);null!=b&&N(a,4,b);return L(a)};tis.messageId="paep";tis.prototype.getUrl=function(){return Q(this,1)};tis.prototype.$j=function(){return Q(this,2)};function uis(a){Bm.call(this,"paep");this.D=new tis(a)}y(uis,chs);uis.prototype.C=n("D");function vis(a){P(this,a,0,-1,null,null)}z(vis,O);vis.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&dk(a,1,b);b=Q(this,2);null!=b&&a.Ha(2,b);b=Q(this,3);null!=b&&N(a,3,b);b=Q(this,4);null!=b&&a.Ha(4,b);return L(a)};vis.prototype.qq=function(){return Q(this,2)};function wis(a){P(this,a,"rfep",-1,null,null)}z(wis,O);wis.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ha(1,b);b=Q(this,2);null!=b&&a.Ha(2,b);b=Q(this,4);null!=b&&a.Ha(4,b);b=Q(this,5);null!=b&&a.Ha(5,b);return L(a)};wis.messageId="rfep";wis.prototype.getFunctionName=function(){return Q(this,2)};wis.prototype.EB=function(){return Q(this,5)};function xis(a){Bm.call(this,"rfep");this.D=new wis(a)}y(xis,chs);xis.prototype.C=n("D");function yis(a){P(this,a,"sfep",-1,null,null)}z(yis,O);yis.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ha(1,b);b=Q(this,2);null!=b&&dk(a,2,b);b=Q(this,3);null!=b&&a.Ha(3,b);return L(a)};yis.messageId="sfep";yis.prototype.sX=function(){return Q(this,2)};yis.prototype.$j=function(){return Q(this,3)};function zis(a){Bm.call(this,"sfep");this.D=new yis(a)}y(zis,chs);zis.prototype.C=n("D");function Ais(a){P(this,a,"step",-1,null,null)}z(Ais,O);Ais.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ha(1,b);b=Q(this,2);null!=b&&N(a,2,b);return L(a)};Ais.messageId="step";Ais.prototype.hwa=function(){return uk(this,2)};function Bis(a){Bm.call(this,"step");this.D=new Ais(a)}y(Bis,chs);Bis.prototype.C=n("D");function Cis(a){P(this,a,"scpep",-1,null,null)}z(Cis,O);Cis.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);return L(a)};Cis.messageId="scpep";function Dis(a){Bm.call(this,"scpep");this.D=new Cis(a)}y(Dis,chs);Dis.prototype.C=n("D");function Eis(a){P(this,a,"saep",-1,null,null)}z(Eis,O);Eis.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ha(1,b);b=Q(this,2);null!=b&&a.Ha(2,b);b=Q(this,3);null!=b&&a.Ha(3,b);b=Q(this,4);null!=b&&a.Ma(4,b);b=Q(this,5);null!=b&&a.Ma(5,b);b=Q(this,6);null!=b&&dk(a,6,b);b=Q(this,7);null!=b&&a.Ha(7,b);b=Q(this,8);null!=b&&N(a,8,b);b=S(this,AX,9);null!=b&&a.xa(9,b,j4j);return L(a)};Eis.messageId="saep";u=Eis.prototype;u.getTitle=function(){return Q(this,2)};
u.setTitle=function(a){return R(this,2,a)};u.zc=function(){return Q(this,4)};u.setWidth=function(a){return R(this,4,a)};u.Ec=function(){return Q(this,5)};u.setHeight=function(a){return R(this,5,a)};u.fG=function(){return rk(this,6)};function Fis(a){Bm.call(this,"saep");this.D=new Eis(a)}y(Fis,chs);Fis.prototype.C=n("D");function Gis(a){P(this,a,"snep",-1,null,null)}z(Gis,O);Gis.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&dk(a,1,b);b=Q(this,2);null!=b&&a.Ha(2,b);b=Q(this,3);null!=b&&a.Ha(3,b);b=Q(this,4);null!=b&&a.sb(4,b);return L(a)};Gis.messageId="snep";u=Gis.prototype;u.getType=function(){return wk(this,1,0)};u.hc=function(a){return R(this,1,a)};u.Bd=function(){R(this,1,void 0)};u.wd=function(){return rk(this,1)};u.getText=function(){return Q(this,2)};u.Ek=function(){return rk(this,2)};
u.getTitle=function(){return Q(this,3)};u.setTitle=function(a){return R(this,3,a)};function His(a){Bm.call(this,"snep");this.D=new Gis(a)}y(His,chs);His.prototype.C=n("D");function Iis(a){P(this,a,"spep",-1,Jis,null)}z(Iis,O);var Jis=[4];Iis.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ha(1,b);b=Q(this,2);null!=b&&a.Ha(2,b);b=Q(this,3);null!=b&&a.Ha(3,b);b=Q(this,4);0<b.length&&hk(a,4,b);b=Q(this,5);null!=b&&N(a,5,b);b=Q(this,6);null!=b&&N(a,6,b);b=Q(this,7);null!=b&&a.Ha(7,b);return L(a)};Iis.messageId="spep";Iis.prototype.getTitle=function(){return Q(this,2)};Iis.prototype.setTitle=function(a){return R(this,2,a)};
Iis.prototype.Hj=function(a,b){return Ik(this,4,a,b)};function Kis(a){Bm.call(this,"spep");this.D=new Iis(a)}y(Kis,chs);Kis.prototype.C=n("D");function Lis(a){P(this,a,"stbep",-1,null,null)}z(Lis,O);Lis.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ha(1,b);b=Q(this,2);null!=b&&a.Ha(2,b);b=Q(this,3);null!=b&&a.Ha(3,b);b=Q(this,4);null!=b&&a.Ha(4,b);b=Q(this,5);null!=b&&a.Ha(5,b);b=Q(this,6);null!=b&&a.Ha(6,b);return L(a)};Lis.messageId="stbep";u=Lis.prototype;u.getFunctionName=function(){return Q(this,2)};u.Vk=function(){return Q(this,3)};u.ys=function(a){R(this,3,a)};u.getUrl=function(){return Q(this,5)};
u.EB=function(){return Q(this,6)};function Mis(a){Bm.call(this,"stbep");this.D=new Lis(a)}y(Mis,chs);Mis.prototype.C=n("D");function Nis(a){P(this,a,"sttep",-1,null,null)}z(Nis,O);Nis.prototype.Ba=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ha(1,b);b=Q(this,2);null!=b&&a.Ha(2,b);return L(a)};Nis.messageId="sttep";Nis.prototype.getText=function(){return Q(this,1)};Nis.prototype.Ek=function(){return rk(this,1)};Nis.prototype.Zs=function(){return Q(this,2)};Nis.prototype.Zg=function(a){R(this,2,a)};function Ois(a){Bm.call(this,"sttep");this.D=new Nis(a)}y(Ois,chs);Ois.prototype.C=n("D");function Pis(){Jm.call(this);var a=this;this.C=null;this.D=function(b){switch(b[0]){case "amep":b=new dhs(b);a.dispatchEvent(b);break;case "paep":b=new uis(b);a.dispatchEvent(b);break;case "rfep":b=new xis(b);a.dispatchEvent(b);break;case "sfep":b=new zis(b);a.dispatchEvent(b);break;case "step":b=new Bis(b);a.dispatchEvent(b);break;case "saep":b=new Fis(b);a.dispatchEvent(b);break;case "snep":b=new His(b);a.dispatchEvent(b);break;case "spep":b=new Kis(b);a.dispatchEvent(b);break;case "stbep":b=new Mis(b);
a.dispatchEvent(b);break;case "sttep":b=new Ois(b);a.dispatchEvent(b);break;case "scpep":b=new Dis(b),a.dispatchEvent(b)}}}y(Pis,Jm);Pis.prototype.bind=function(a){this.C=a;this.C.subscribe("13",this.D)};Pis.prototype.Va=function(){this.C&&this.C.unsubscribe("13",this.D);Jm.prototype.Va.call(this)};function Qis(a,b){Jm.call(this);this.D=new Mm(this);this.Fa(this.D);this.C={};this.F=a;this.H=b}y(Qis,Jm);u=Qis.prototype;u.start=function(){this.D.listen(this.H,"sfep",va(this.ENb,this));this.D.listen(this.H,"step",va(this.UUc,this))};function Ris(a,b,c,d){var e=void 0;e=void 0===e?pa:e;d=void 0===d?pa:d;d=va(a.TUc,a,b,e,d);a=a.F;b=["ruid",ta({}),a.C.C,a.D,a.C.H,b,a.C.O,c];b=No(Wl(Po(Ohs(a,a.C.Ca),"POST"),2),b).wC();d&&(Zl(b,va(a.WUc,a,d)),Xl(b,va(a.DHc,a,d)));b.Ii()}
u.SUc=function(a,b,c,d,e,f){f.QB()?(a=Q(f,2),this.C[a]=new Sis(a,b,d,e),c(a,xk(f,3,!1))):(b=new yis,R(b,2,6),e(b))};u.TUc=function(a,b,c,d){d.QB()?b():(c(),b=new yis,R(b,1,a),R(b,2,6),this.ENb(new zis(b.Oc())))};u.UUc=function(a){a=a.C();var b=Q(a,1);if(Jg(this.C,b)){var c=xia(this.C,b);(0,c.RUc)(a);c.dispose();Qg(this.C,b)}};u.ENb=function(a){a=a.C();var b=Q(a,1);if(Jg(this.C,b)){var c=xia(this.C,b);(0,c.scc)(a);c.dispose();Qg(this.C,b)}a="Google Apps Script: "+a.$j();window.console.log(a)};
u.Va=function(){li(this.C);Jm.prototype.Va.call(this)};function Sis(a,b,c,d){ii.call(this);this.C=b;this.RUc=c;this.scc=d}y(Sis,ii);Sis.prototype.getFunctionName=n("C");function Tis(a,b){var c=a.Y4,d=a.id,e=a.ZNc,f=a.tZa,h=a.H6b,k=a.wja,l=a.v2a;return Mq('<div class="'+V(a.jH)+'" aria-labelledby="title'+V(d)+'" tabindex="0"'+(c?' role="complementary"':' role="region"')+'><div class="'+V(e)+'"><div class="'+V(f)+'" id="title'+V(d)+'"></div><div class="'+V(h)+'" tabindex="0" title="'+V("Close sidebar")+'" aria-label="'+V("Close sidebar")+'" role="button">'+Ct({icon:l},b)+'</div></div><div class="'+V(k)+'"></div></div>')}
function Uis(a){a=a.caption;return Mq('<div class="'+V("docs-script-button-bar-text")+" "+V("docs-titlebar-button")+" "+V("goog-inline-block")+'" tabindex="0">'+Lq(a)+"</div>")}function Vis(a){a=a.text;return Mq('<div class="'+V("docs-script-button-bar-bubble-content")+'">'+Lq(a)+"</div>")}
function Wis(a){var b=a.iconName,c=a.title;a=a.description;return Mq('<div class="'+V("script-promo-menu-item-content")+'"><div class="'+V("script-promo-menu-item-icon")+'" aria-hidden="true"><img src="//ssl.gstatic.com/docs/common/'+V(b)+'.svg"/></div><div class="'+V("script-promo-menu-item-text")+'"><div class="'+V("script-promo-menu-item-title")+'">'+Lq(c)+'</div><div class="'+V("script-promo-menu-item-description")+'">'+Lq(a)+"</div></div></div>")}
function Xis(a){var b=a.functionName;a=a.gmb;return Mq('<div class="'+V("func-entry")+'" aria-checked="false" role="radio" tabindex="-1"><div class="'+V("goog-inline-block")+" "+V("func-entry-rb")+'">&nbsp;</div><div class="'+V("goog-inline-block")+" "+V("func-entry-func")+'">'+Lq(b)+'</div><div class="'+V("goog-inline-block")+" "+V("func-entry-lib")+'">'+Lq(a)+"</div></div>")}
function Yis(a){var b=a.ids,c=a.description;a=a.xPc;var d='<div class="'+V("script-help-dialog-content")+'"><div class="'+V("script-help-dialog-content-left")+" "+V("goog-inline-block")+(a?" "+V("script-help-dialog-content-left-gsm-onhold")+" ":"")+'">';a?(c=d,a='<div class="'+V("script-help-dialog-content-section")+" "+V("script-help-dialog-content-section-gsm-onhold")+'" tabindex="0"><div class="'+V("script-help-dialog-content-title")+'">',d=d={VIa:"script-help-dialog-content-title-caution-icon"},
d=d.VIa,d=Mq("<div"+(d?' class="'+V(d)+'"':"")+'><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11,15 L13,15 L13,17 L11,17 L11,15 Z M11,7 L13,7 L13,13 L11,13 L11,7 Z M11.99,2 C6.47,2 2,6.48 2,12 C2,17.52 6.47,22 11.99,22 C17.52,22 22,17.52 22,12 C22,6.48 17.52,2 11.99,2 Z M12,20 C7.58,20 4,16.42 4,12 C4,7.58 7.58,4 12,4 C16.42,4 20,7.58 20,12 C20,16.42 16.42,20 12,20 Z" id="path-1"></path></defs><g id="caution" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="alert/error_outline_24px"><mask id="mask-2" fill="white"><use xlink:href="#path-1"></use></mask><g id="ic_error_outline_24px" fill-rule="nonzero"></g><g id="_c/Red/600" mask="url(#mask-2)" fill="#D93025" fill-rule="evenodd"><rect id="swatch" x="0" y="0" width="24" height="24"></rect></g></g></g></svg></div>'),
d=c+(a+d+"<span>Add-on not available in \r\n G Suite Marketplace</span></div><div>The developer of this add-on has not accepted the terms and conditions of G Suite Marketplace.</div></div>")):(d+='<div class="'+V("script-help-dialog-content-section")+'" tabindex="0"><div class="'+V("script-help-dialog-content-title")+'">',d=d+"Getting started</div><div>"+(Lq(c)+"</div></div>"));d+='</div><div id="'+V(b.THa)+'" class="'+V("script-help-dialog-buttons")+" "+V("goog-inline-block")+'"></div></div>';return Mq(d)}
function Zis(a){var b=a.acc;a='<p class="'+V("script-reportissue-dialog-description-label")+'" tabindex="0">';var c="Describe the issue for the creators of <strong>"+(Lq(b)+"</strong>:");a=a+c+('</p><textarea class="'+V("jfk-textinput")+" "+V("script-reportissue-dialog-description")+'"></textarea><p class="'+V("script-reportissue-dialog-disclaimer")+'" tabindex="0">');a=a+'Only this description will be sent, no information from your open document.</p><div class="'+(V("script-reportissue-dialog-nonanonymous")+
'" tabindex="0"><div class="'+V("script-reportissue-dialog-nonanonymous-control")+" "+V("goog-inline-block")+'"><div class="'+V("script-reportissue-dialog-nonanonymous-checkbox")+" "+V("jfk-checkbox")+'"></div></div><div class="'+V("script-reportissue-dialog-nonanonymous-label")+" "+V("goog-inline-block")+'"><div class="'+V("script-reportissue-dialog-nonanonymous-optional-text")+" "+V("goog-inline-block")+'">');a+="(Optional)</div> ";b="Include your name and email address so the creators of <strong>"+
(Lq(b)+" </strong>can follow up.");a=a+b+"</div></div>";return Mq(a)}
function $is(a,b){a=a||{};a=a.ud;var c='<div class="'+V("func-actions")+'">';c+=Js({id:"func-action-new",content:Qq("New"),style:0},b);c+=Js({id:"func-action-run",content:Qq("Run"),style:0,Le:"jfk-button-collapse-right"},b);c+=Js({id:"func-action-edit",content:Qq("Edit"),style:0,Le:"jfk-button-collapse-left"},b);c+=Js({id:"func-action-reload",content:Qq(""+Ct({icon:a?"docs-icon-img docs-icon-reload-rtl":"docs-icon-img docs-icon-reload"},b)),style:0,width:1,title:"Reload"},b);c+='</div><div class="'+
V("func-header")+'"><div class="'+V("func-header-rb")+" "+V("goog-inline-block")+'"></div><div class="'+V("func-header-func")+" "+V("goog-inline-block")+'">';c=c+'Function</div><div class="'+(V("func-header-lib")+" "+V("goog-inline-block")+'">');c=c+'Script</div></div><div class="'+(V("func-entries")+'" role="radiogroup" tabindex="0"></div>');return Mq(c)}function ajs(){var a='<div class="'+V("func-loading")+'">';return Mq(a+"Fetching scripts\u2026</div>")}
function bjs(){var a='<div class="'+V("func-none")+'">';return Mq(a+"No scripts found</div>")};function cjs(){}y(cjs,Rr);cjs.prototype.xd=q("func-entry");cjs.prototype.Fl=q(!1);cjs.prototype.Ia=function(a){return Jq(Xis,{functionName:a.getFunctionName(),gmb:a.zQc},void 0,a.Ea())};qa(cjs);function djs(a,b,c,d,e,f){Ur.call(this,null,d||cjs.rb(),e);this.bIb=a;this.C=void 0!==f?f:null;this.zQc=b;this.D=c;this.ek(16,!0);this.ek(32,!0);Wr(this,16,!0);Vr(this,16,!1)}y(djs,Ur);djs.prototype.kA=function(a){Ur.prototype.kA.call(this,a);a&&this.getElement()&&this.getElement().focus()};djs.prototype.EB=n("C");djs.prototype.getFunctionName=n("D");djs.prototype.Gd=function(a){Ur.prototype.Gd.call(this,a);this.Yc(a);this.getElement()&&pn(this.getElement(),a)};function ejs(a,b){ut.call(this,void 0,void 0,a);this.R=b||!1;this.FE=new VMb;this.Fa(this.FE);this.lh=new Or;this.Fa(this.lh);this.H=new Ks("");this.Fa(this.H);this.C=new Ks("");this.Fa(this.C);this.F=new Ks("");this.Fa(this.F);this.O=new Ks("");this.Fa(this.O);a=new Ar(a);a.set("close","Close",!1,!0);zr(this,!1);Cr(this,a);this.setTitle("Script manager")}y(ejs,ut);u=ejs.prototype;
u.reset=function(a){this.FE.clear();this.Vf(!0);0===a?(a=Jq(ajs,{},void 0,this.Ea()),a=new Ur(a),a.ek(32,!1),this.Na(a,!0)):1===a&&(a=Jq(bjs,{},void 0,this.Ea()),a=new Ur(a),a.ek(32,!1),this.Na(a,!0))};u.focus=function(){if(this.Ic()&&0<this.FE.Xl()){var a=this.FE.Wi();a&&a.kA(!0)}else ut.prototype.focus.call(this)};u.Vf=function(a){a=ut.prototype.Vf.call(this,a);this.FE.clear();fjs(this);return a};
u.yj=function(a,b,c){ut.prototype.yj.call(this,a,b,c);a instanceof djs&&(b=a.Ne(),this.FE.ze(a),1==this.FE.Xl()||b)&&(YMb(this.FE,a),a.kA(!0));fjs(this)};u.Ia=function(){ut.prototype.Ia.call(this);var a=this.Lc();lr(a,"script-explorer-contents");Hq(a,$is,{ud:this.R});a=kn(Elb(a));this.H.xb(a[0]);this.F.xb(a[1]);this.C.xb(a[2]);this.O.xb(a[3]);Hr(this,"run")};
u.Oa=function(){ut.prototype.Oa.call(this);Pr(this.lh,this.Lc());fjs(this);this.addEventListener("dialogselect",Wg(!0));Dm(this,"action",this.IDb,void 0,this);Dm(this.lh,"key",this.lEb,void 0,this);var a=new gKb("new",this.H.getContent());Dm(this.H,"action",va(this.dispatchEvent,this,a));a=new gKb("run",this.F.getContent());Dm(this.F,"action",va(this.dispatchEvent,this,a));a=new gKb("edit",this.C.getContent());Dm(this.C,"action",va(this.dispatchEvent,this,a));a=new gKb("reload",this.O.getContent());
Dm(this.O,"action",va(this.dispatchEvent,this,a))};u.Yf=function(){ut.prototype.Yf.call(this);bLb(this.lh);Gm(this,"action",this.IDb,void 0,this);Gm(this.lh,"key",this.lEb,void 0,this);Im(this.H);Im(this.F);Im(this.C);Im(this.O)};u.Lc=function(){var a=ut.prototype.Lc.call(this),b=kn(a);return 0<b.length?b[2]:a};u.IDb=function(a){fjs(this);a.target instanceof djs&&(YMb(this.FE,a.target),a.target.kA(!0))};
u.lEb=function(a){var b=this.FE.Xl();if(0<b)switch(a.keyCode){case 38:var c=this.FE;b=am(this.FE.oo()-1,b);YMb(c,c.Xj(b));a.preventDefault();this.focus();break;case 40:c=this.FE,b=am(this.FE.oo()+1,b),YMb(c,c.Xj(b)),a.preventDefault(),this.focus()}};function fjs(a){var b=!!a.FE.Wi();a.F.setVisible(b);a.C.setVisible(b)};function gjs(a,b){this.D=a;this.C=b}function hjs(a){a.D.V&&Ths(a.C,function(){if(U("macros-extensions").isEnabled()){a.D.Aa&&!a.D.C&&a.C.Iha();var b=a.D.ma;if(b&&(b=a.C.getExtension(new ghs(b))||mis(a.C,b))){var c=a.C,d=c.C.R;d&&(ais(c.C),c=va(c.C.v7,c.C),ijs(d,N9(b),c))}}})};function jjs(){ii.call(this);this.F=new mm}y(jjs,Ws);jjs.prototype.C=function(){return this.F.Ag()};function gis(a,b){a.F.set(b.getId(),b)}jjs.prototype.Ad=function(){this.F.clear()};function fis(a,b){uq.call(this,b);this.C=a}y(fis,uq);
fis.prototype.Ia=function(){uq.prototype.Ia.call(this);var a=this.C==(Ls(),KPb)?"Do more with Docs":this.C==(Ls(),OPb)?"Do more with Forms":this.C==(Ls(),LPb)?"Do more with Sheets":this.C==(Ls(),MPb)?"Do more with Slides":"Do more with Docs",b=this.C==(Ls(),KPb)?"Looking for even more Docs features? Get a few add-ons.":this.C==(Ls(),OPb)?"Looking for even more Forms features? Get a few add-ons.":this.C==(Ls(),LPb)?"Looking for even more Sheets features? Get a few add-ons.":this.C==(Ls(),MPb)?"Looking for even more Slides features? Get a few add-ons.":
"Looking for even more Docs features? Get a few add-ons.",c=this.C==(Ls(),KPb)?"addon_docs_promo":this.C==(Ls(),OPb)?"addon_forms_promo":this.C==(Ls(),LPb)?"addon_sheets_promo":this.C==(Ls(),MPb)?"addon_slides_promo":"addon_docs_promo",d=this.Ea();this.Wd(Jq(Wis,{title:a,description:b,iconName:c},void 0,d))};function kjs(){}y(kjs,fs);kjs.prototype.Ia=function(a){a=fs.prototype.Ia.call(this,a);fr(a,"menuitem");return a};kjs.prototype.xd=q("goog-control");kjs.prototype.iy=function(a){a=fs.prototype.iy.call(this,a);a.push("menu-button","goog-inline-block");return a};qa(kjs);function ljs(a,b,c,d,e){ii.call(this);this.R=b;this.V=c;this.H=a;this.D={};this.Aa={};this.oa={};this.ma=[];this.X=[];this.J=d||null;this.O=e||null;this.C=new jjs;this.F=new jjs;this.Ga=new Mm;this.Fa(this.Ga);this.Ca=[]}y(ljs,ii);ljs.prototype.Va=function(){li(this.D);ii.prototype.Va.call(this)};ljs.prototype.nE=function(a){return Jg(this.D,a)};
function mjs(a,b,c){c=c?[c]:Fg(a.D);for(var d=0;d<c.length;d++)for(var e=c[d].Nc(),f=0;f<e.Dd();f++){var h=e.Ud(f);if(h instanceof ks&&h.getId()==b||h instanceof rs&&(h=mjs(a,b,h)))return h}return null}
function njs(a,b,c,d,e){if(Q(b,3)){var f=uk(b,7)||!1,h=b.Vk(),k=Q(b,10),l=new ks("");l.qd(b.Xh()||String(ta(l)));var m=[en(h)];d&&b.getKey()&&(d+=b.getKey().toUpperCase(),d=rOb(l,U("macros-exec"),[d]),a.ma.push(d),m.push(d));l.setContent(m);b=new Ygs(Q(b,4),Q(b,3),void 0,Q(b,9)||void 0,void 0,b.EB()||void 0);Ds(a.R,l,U("macros-exec"),null,Wg(b),phs(3,e));l.Xa(f);a.O&&f&&k&&(e=h+(" ("+(k+")")),c.push(a.O.qD(U("macros-exec"),[b],Wg(e),Wg(e))[0]));return l}if(!b.Vk())return new ns;if(0<b.Em().length){l=
new os;f=b.Em();for(h=0;h<f.length;h++)l.Na(njs(a,f[h],c,d,e),!0);a=new rs(b.Vk());a.qd(b.Xh()||String(ta(a)));a.Lh(l);return a}throw Error("Unsupported menu item type.");}ljs.prototype.Ja=function(a,b){return qg(a.getName(),b.getName())};function jis(a,b,c,d,e){if(b.sOa()){var f=new Zgs,h=String(ta(f));R(f,1,h);b.Na(njs(a,f,d),!0)}d=new ks("Help");d.qd(String(ta(d)));Ds(a.R,d,U("macros-extension-help"),null,Wg(c),phs(3,e));d.Xa(!0);b.Na(d,!0)}
function iis(a,b,c){var d=new ks("");d.qd("addon-menu-install-"+N9(c));Ds(a.R,d,U("macros-extension-install-start"),xOb,Wg(N9(c)),phs(3,c));d.Xa(!0);b.Na(d,!0)}function his(a){JSb(a.J,"docs-macros-extension-promo")||Ys(a.J,"docs-macros-extension-promo",[a.F,null]);JSb(a.J,"docs-macros-extensions")||Ys(a.J,"docs-macros-extensions",[a.C]);a.J.Nc("docs-extensions-menu",!0)}
function ijs(a,b,c){var d=c||pa;(c=a.C.F.get(b))?-1===a.Ca.indexOf(b)?(b=Wn(va(function(e){e.dispatchEvent("load")},a,c),1E4),b=va(function(e,f,h){this.H.XCa("docs-extensions-menu");e.Yk(!0);e.C_();Xn(h);f()},a,c,d,b),a.Ga.qe(c,"load",b)):(a.H.XCa("docs-extensions-menu"),c.t0(),c.Yk(!0),c.C_(),d()):d()};function ojs(a,b){var c=a.v2a,d=a.Y4;a='<div class="'+V(a.jH)+'" aria-labelledby="addon-sidebar-title" tabindex="0"'+(d?' role="complementary"':' role="region"')+'><div class="'+V("addon-sidebar-header")+'"><div class="'+V("addon-sidebar-title")+'" id="addon-sidebar-title">';a+="Document add-ons";c=Qq(""+Ct({icon:c},b));a+="</div>"+Js({Le:"addon-sidebar-close docs-material",content:c,style:4,title:"Close sidebar"},b)+'</div><div class="'+V("addon-sidebar-content")+'"><div class="'+V("addon-sidebar-banner")+
'"></div><div class="'+V("addon-sidebar-introduction")+'"></div></div><div class="'+V("addon-sidebar-empty-caption")+'"><div class="'+V("addon-sidebar-empty-title")+'">';a=a+'No document add-ons</div><div class="'+(V("addon-sidebar-empty-description")+'">');return Mq(a+"This document doesn't include any add-ons</div></div></div>")}
function pjs(a){var b=a.U4b;a=a.R4b;return Mq('<img class="'+V("addon-sidebar-banner-image")+'" src='+JAk(Uq(b))+" alt="+JAk(a)+' /><div class="'+V("addon-sidebar-banner-image-overlay")+'"></div>')};function qjs(a){var b=a.icon,c=a.title,d=a.category,e=a.summary,f=a.isInstalled,h=a.Imd;a=Mq;b='<div class="'+V("addon-sidebar-card")+'" aria-label="'+V(c)+'" tabindex="0" role="region"><div class="'+V("addon-sidebar-card-header")+'"><div class="'+V("addon-sidebar-card-icon")+'">'+(b?'<img class="'+V("addon-sidebar-card-icon-image")+'" src='+JAk(Uq(b))+" alt="+JAk(c)+" />":"")+'</div><div class="'+V("addon-sidebar-card-header-content")+'"><div class="'+V("addon-sidebar-card-title")+'"><div class="'+
V("addon-sidebar-card-title-caption")+(h?" "+V("addon-sidebar-card-two-line-title-caption"):"")+'">'+Lq(c)+"</div>";f?(c=c={VIa:"addon-sidebar-card-check",color:"#455A64"},f=c.VIa,c=c.color,f=Mq("<div"+(f?' class="'+V(f)+'"':"")+'><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 48 48" fill="'+V(null!=c?c:"#000")+'"><path d="M0 0h48v48H0z" fill="none"/><path d="M24 4C12.95 4 4 12.95 4 24c0 11.04 8.95 20 20 20 11.04 0 20-8.96 20-20 0-11.05-8.96-20-20-20zm-4 30L10 24l2.83-2.83L20 28.34l15.17-15.17L38 16 20 34z"/></svg></div>')):
f="";return a(b+f+'</div><div class="'+V("addon-sidebar-card-category")+'">'+Lq(d)+"</div></div></div>"+(e?'<div class="'+V("addon-sidebar-card-summary")+'">'+Lq(e)+"</div>":"")+"</div>")};function rjs(){}y(rjs,Hv);rjs.prototype.xd=q("docs-material-menu-button-flat-primary");rjs.prototype.Rx=function(){return Jq(Kkd,{className:"docs-material-menu-button-flat-primary-dropdown"})};qa(rjs);function sjs(a,b,c,d,e){c=void 0===c?rjs.rb():c;ss.call(this,a,b,c,d,e)}y(sjs,ss);function tjs(){}y(tjs,Hv);tjs.prototype.xd=q("docs-material-menu-button-raised-primary");tjs.prototype.Rx=function(){return Jq(Kkd,{className:"docs-material-menu-button-raised-primary-dropdown"})};qa(tjs);function ujs(a,b,c,d,e){c=void 0===c?tjs.rb():c;ss.call(this,a,b,c,d,e)}y(ujs,ss);function vjs(a,b,c,d,e){ii.call(this);this.D=a;this.C=b;this.F=c;this.H=d;this.Hb=e||Tm()}y(vjs,ii);
function wjs(a,b){if(!b)return xjs(a);b=b.Em();if(1==b.length&&Q(b[0],3)){var c=xjs(a);b=b[0];c.Xa(!!uk(b,7));b=new Ygs(Q(b,4),Q(b,3),void 0,Q(b,9)||void 0);Ds(a.D,c,U("macros-exec"),{enabled:!0},Wg(b),a.F);return c}c=new os(a.Hb);for(var d=0;d<b.length;d++)c.Na(yjs(a,b[d]),!0);b=[en("Use")];a=a.C?new ujs(b,c,void 0,a.Hb):new sjs(b,c,void 0,a.Hb);a.Kh("Use");a.Id("addon-sidebar-card-menu-button");a.Xa(!0);return a}
function yjs(a,b){if(Q(b,3)){var c=b.Vk(),d=new ks("");d.Id(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");d.setContent([en(c)]);c=new Ygs(Q(b,4),Q(b,3),void 0,Q(b,9)||void 0);Ds(a.D,d,U("macros-exec"),{enabled:!0},Wg(c),a.F);d.Xa(!!uk(b,7));return d}if(!b.Vk())return new ns;if(0<b.Em().length){d=new os(a.Hb);c=b.Em();for(var e=0;e<c.length;e++)d.Na(yjs(a,c[e]),!0);b=new rs(b.Vk());b.Id(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");
b.Lh(d);return b}throw Error("Unsupported menu item type.");}function xjs(a){var b=[en("Use")];a=a.C?new m7k(b,a.Hb):new Wse(b,a.Hb);a.Kh("Use");a.Id("addon-sidebar-card-button");a.Xa(!1);return a};function zjs(a,b,c,d,e){uq.call(this,e);this.C=a;this.ma=b;this.V=uk(this.C,19)||!1;this.H=!(!uk(this.C,10)&&!uk(this.C,9));this.O=new Cs(void 0,void 0,!0,Kt.rb());this.Fa(this.O);this.X=phs(10,this.C);this.J=new Ur(void 0,void 0,e);this.Fa(this.J);this.F=new vjs(this.O,c,this.X,d,e);this.Fa(this.F);if(this.H)a=wjs(this.F);else{a=this.F;b=this.C;a:switch(a.H){case Ls(),KPb:c="Add to Docs";break a;case Ls(),MPb:c="Add to Slides";break a;case Ls(),LPb:c="Add to Sheets";break a;default:throw Error("Unsupported document type");
}d=[en(c)];d=a.C?new m7k(d,a.Hb):new Wse(d,a.Hb);d.Kh(c);d.Id("addon-sidebar-card-button");d.Xa(!1);Ds(a.D,d,U("macros-extension-install-start"),{enabled:!0},Wg(N9(b)),a.F);a=d}this.D=a;a=this.F;b=this.C;c=new Wse([en("Help")],a.Hb);c.Kh("Help");c.Id("addon-sidebar-card-button");c.Xa(!1);c.Zg("Help");Ds(a.D,c,U("macros-extension-help"),{enabled:!0},Wg(N9(b)),a.F);this.R=c}y(zjs,uq);
zjs.prototype.Ia=function(){uq.prototype.Ia.call(this);var a=Q(this.C,15)||"";a&&(a=um(new tm(a),"https").toString());var b=this.Ea();a={icon:a,title:this.C.getName(),category:this.C.Gq(),isInstalled:this.H,summary:Q(this.C,14),Imd:Qh};b=Jq(qjs,a,void 0,b);this.Qb(b);this.Wd(b)};zjs.prototype.Wd=function(a){uq.prototype.Wd.call(this,a);a=this.Ka("addon-sidebar-card-title-caption");fr(a,"button");this.Na(this.J);this.J.xb(a)};
zjs.prototype.Oa=function(){uq.prototype.Oa.call(this);Ds(this.O,this.J,U("macros-manage-extensions"),{},Wg(ihs(this.C)),this.X);Ajs(this);!this.H&&this.V&&(this.Na(this.R,!0),this.R.Xa(!0))};zjs.prototype.Va=function(){ki(this.D);ki(this.R);uq.prototype.Va.call(this)};function Bjs(a,b){a.H&&(a.D.getParent()==a&&a.removeChild(a.D,!0),ki(a.D),a.D=wjs(a.F,b),a.Ic()&&Ajs(a))}
function Ajs(a){a.Na(a.D,!0);a.H||(a.D.Xa(a.ma&&!a.V),a.ma?a.V&&a.D.Zg("Add-on not available in G Suite Marketplace"):a.D.Zg("Disabled for your organization"))};function Cjs(a,b,c){wX.call(this,c);this.D={};this.C=[];this.X=!1;this.H=a;this.ma=b;this.J={};this.F=new Cfd(this.Ea(),"addon-sidebar-spinner");this.Na(this.F);this.V=new Ks(void 0,this.Ea());this.O=this.R=!1}y(Cjs,wX);u=Cjs.prototype;u.Ia=function(){wX.prototype.Ia.call(this);var a={jH:"addon-sidebar",v2a:op("close-white"),Y4:of(vf(),"docs-eal")};a=Jq(ojs,a,void 0,this.Ea());this.Qb(a);this.Wd(a)};
u.Wd=function(a){wX.prototype.Wd.call(this,a);this.F.render(this.Lc());a=this.F.Sa();ir(a,"Loading");fr(a,"status");gr(a,"live","polite")};u.Oa=function(){wX.prototype.Oa.call(this);Djs(this,!1);Ejs(this,!1);this.V.xb(this.Ka("addon-sidebar-close"));this.getHandler().pj(this.V.Sa(),Fm,va(this.FNb,this)).listen(this.getElement(),"keyup",this.mKc);this.R&&lis(this)};u.Lc=function(){return this.Eb("addon-sidebar-content")};
function lis(a){a.F.setVisible(!1);Ejs(a,a.H);Djs(a,0==a.C.length);Fjs(a,a.O);Gjs(a);Bf(a.C,function(b){var c=N9(b);b=new zjs(b,this.X,this.O,this.ma,this.Ea());Bjs(b,this.J[c]);this.Na(b,!0);this.D[c]=b},a)}function Gjs(a){Ag(a.D,function(b){this.removeChild(b,!0);ki(b)},a);wia(a.D)}function Djs(a,b){if(a.Ic()){var c=a.Ka("addon-sidebar-empty-caption");oq(c,b)}b&&Ejs(a,!1)}
function Ejs(a,b){if(a.Ic()){var c=a.Ka("addon-sidebar-introduction");b&&!qn(c)&&on(c,1<a.C.length?"This template is optimized to work with these add-ons":"This template is optimized to work with this add-on");oq(c,b)}}function kis(a){return 0==a.C.length?null:(a=Q(a.C[0],16)||Q(a.C[0],17))?um(new tm(a),"https").toString():null}
function Fjs(a,b){if(a.Ic()){pr(a.getElement(),"addon-sidebar-with-banner",b);var c=a.Ka("addon-sidebar-banner");b?(b=kis(a))&&Hq(c,pjs,{U4b:b,R4b:a.C[0].getName()}):hn(c)}}u.bcc=function(a,b){return qg(a.getName(),b.getName())};u.mKc=function(a){27==a.keyCode&&(this.getElement()==a.target&&this.FNb(),a.stopPropagation())};u.FNb=function(){this.setVisible(!1);Ejs(this,!1);this.H=!1;U("docs-focus-editor").qc()};u.Fl=q(!1);function Hjs(a,b){yX.call(this,a,b)}y(Hjs,yX);Hjs.prototype.by=function(){return U("macros-addon-sidebar-focus")};Hjs.prototype.gk=function(){return U("macros-addon-sidebar")};Hjs.prototype.pD=function(a){var b=this.Zd;b.Ic()||b.render();yX.prototype.pD.call(this,a)};Hjs.prototype.TXb=function(a){a&&this.gk().isVisible()&&this.pD(!0)};function Ijs(a,b,c){this.F=a;this.D=b;this.C=c;Object.defineProperties(this,{path:{get:va(this.HUc,this),set:va(this.eid,this)},invoke:{get:va(this.vic,this),set:va(this.Uhd,this)},arity:{get:va(this.udc,this),set:va(this.xhd,this)}})}u=Ijs.prototype;u.HUc=n("F");u.eid=ba("F");u.vic=n("D");u.Uhd=ba("D");u.udc=n("C");u.xhd=ba("C");function Jjs(a,b,c,d,e){uq.call(this,e);this.O=a;this.H=b;this.F=c;this.C=d}y(Jjs,uq);
Jjs.prototype.Ia=function(){var a=rf(vf(),"docs-tfh"),b=this.O;a&&(b=sja(b,{allow_parent:a}));a=GJb(this.Ea());rh(a,b);a.width="100%";a.height="100%";a.marginWidth="0";a.marginHeight="0";a.scrolling="no";a.allow="accelerometer ambient-light-sensor autoplay camera encrypted-media fullscreen geolocation gyroscope magnetometer microphone midi payment picture-in-picture speaker usb vr".split(" ").map(function(c){return c+" *;"}).join(" ");this.Qb(a);na("payload",this.H,a);na("adapter.hostFunctions",this.F,
a);aba("adapter.getSessionId",va(this.D,this),a);aba("adapter.getState",va(this.J,this),a)};Jjs.prototype.Fl=q(!1);Jjs.prototype.D=function(){var a=this.C().C;return null!==a?String(a):null};Jjs.prototype.J=function(){return this.C().getState()};function Kjs(a,b,c,d,e,f,h,k,l){ut.call(this,void 0,void 0,l);var m=va(this.setVisible,this,!1),p=va(this.H,this),r=va(this.F,this);e&&this.setTitle(e);this.El=f||500;this.Mi=h||300;this.C=new Jjs(a,b,[new Ijs("google.script.host.close",m,0),new Ijs("google.script.host.closeDialog",m,0),new Ijs("google.script.host.editor.focus",va(d.Qc,d,3),0),new Ijs("google.script.host.setWidth",p,1),new Ijs("google.script.host.setHeight",r,1)],c,l);this.Na(this.C);zr(this,!!k);Cr(this,null)}y(Kjs,ut);
Kjs.prototype.H=function(a){!isFinite(a)||0>a||fq(this.Lc(),Math.min(a,Math.floor(.8*an().width)))};Kjs.prototype.F=function(a){!isFinite(a)||0>a||gq(this.Lc(),Math.min(a,Math.floor(.8*an().height)))};Kjs.prototype.Ia=function(){ut.prototype.Ia.call(this);lr(this.getElement(),"script-app-dialog");var a=this.Lc();lr(a,"script-app-contents");fq(a,Math.min(this.El,Math.floor(.8*an().width)));gq(a,Math.min(this.Mi,Math.floor(.8*an().height)));this.C.render(a)};Kjs.prototype.Fl=q(!1);function Ljs(a){wX.call(this,a);this.C=this.F=this.D=this.H=null}y(Ljs,wX);u=Ljs.prototype;u.ZTa=function(){this.C&&(this.removeChild(this.C,!0),this.C.dispose(),this.C=null);this.setVisible(!1)};u.focus=function(){this.C.getElement().focus()};u.Lc=n("F");
u.Ia=function(){var a=this.Ea(),b={id:this.getId(),jH:"script-application-sidebar",ZNc:"script-application-sidebar-header",tZa:"script-application-sidebar-title",H6b:"script-application-sidebar-close",wja:"script-application-sidebar-content",v2a:op("close-white"),Y4:of(vf(),"docs-eal")};b=Jq(Tis,b,void 0,a);this.Qb(b);this.H=a.Eb("script-application-sidebar-title",b);this.D=a.Eb("script-application-sidebar-close",b);this.F=a.Eb("script-application-sidebar-content",b)};
u.Oa=function(){wX.prototype.Oa.call(this);this.getHandler().pj(this.D,Fm,va(this.ZTa,this))};u.Fl=q(!1);u.Va=function(){delete this.H;delete this.D;delete this.F;delete this.C;wX.prototype.Va.call(this)};function Mjs(a,b){yX.call(this,a,b)}y(Mjs,yX);Mjs.prototype.by=function(){return U("macros-application-focus")};Mjs.prototype.gk=function(){return U("macros-application-sidebar")};function Njs(a,b){var c=null;c=c||Eq("",{target:"_blank",height:500,width:600,top:(screen.height-500)/2,left:(screen.width-600)/2,scrollbars:!0});sh(c.location,a);b!=pa&&(a=new idd(function(){return c?c.closed:!0}),a.pL=b,a.start(100,-1))};function Ojs(a,b,c,d,e){ut.call(this,void 0,!0,c);this.H=a;this.F=d||pa;xr(this,b);this.setVisible(!0);this.Qp=!0;Br(this,!1);Cr(this,(new Ar).Hj(nKb,!0).Hj(Er,!1,!0));this.setTitle(e||"Authorization Required");Hr(this,nKb.key)}y(Ojs,ut);Ojs.prototype.Oa=function(){ut.prototype.Oa.call(this);this.addEventListener("dialogselect",this.C)};Ojs.prototype.Yf=function(){ut.prototype.Yf.call(this);this.removeEventListener("dialogselect",this.C)};
Ojs.prototype.C=function(a){"cancel"!=a.key?Njs(this.H,this.F):this.F();this.setVisible(!1)};function Pjs(a){ut.call(this,void 0,void 0,void 0);this.F=a;this.C=null;this.Qp=!0;this.setTitle("Message details");Cr(this,oKb())}y(Pjs,ut);Pjs.prototype.Ia=function(){ut.prototype.Ia.call(this);var a=this.Lc();lr(a,"script-error-dialog-content");this.C=en(this.F);a.appendChild(this.C)};Pjs.prototype.Va=function(){ut.prototype.Va.call(this);this.C&&jn(this.C)};function Qjs(a){ii.call(this);this.C=a}y(Qjs,ii);function Rjs(a,b){var c=ug("Running script ");c=cn("SPAN",null,c);b=b?Qs(c,"Cancel",b,"info",!0):Os(c,"info",!0);a.C.postMessage(b);return b.getId()}function Sjs(a,b,c){var d=(c=void 0===c?null:c)?c:"Script "+(wh(b)+" experienced an error");b=cn("SPAN","script-error-message",d);b.style.maxWidth="600px";a.C.postMessage(Qs([b],"Details",function(){(new Pjs(d)).setVisible(!0)},"warning",!0))}Qjs.prototype.Va=function(){delete this.C};function Tjs(){ii.call(this);this.C=null;this.D=new Mm;this.Fa(this.D)}y(Tjs,ii);Tjs.prototype.Va=function(){Ujs();Vjs(this);ii.prototype.Va.call(this)};function Vjs(a){a.D.Ad();a.C&&(a.C.dispose(),a.C=null);Ujs()}function Ujs(){var a=Wm("docs-script-button-bar");a&&hn(a)};var Wjs=new AIc(["http","https"]);function Xjs(a){a=Bh(a);if(sg(a)||vg(a,'"'))return null;var b=Gib(1,a);return b?Wjs.contains(b.toLowerCase())?a:null:null};function Yjs(a,b,c,d,e,f,h){h=void 0===h?!1:h;ut.call(this);this.Dp=sg(Bh(b))?"You can find "+(a+" in the Add-ons menu."):b;this.ma=c;this.Ca=d;this.H=Xjs(e);this.X=Xjs(f);this.O=h;this.V=HHb(this,Zjs);this.C=NZj("Learn more");this.Na(this.C);this.F=new Ks("Report an issue");this.Na(this.F);this.R=new Ks("View in store");this.Na(this.R);this.setTitle(ug("Help for "+a));a=new Ar;a.Hj({key:Er.key,caption:"Close"},!1,!0);Cr(this,a);Hr(this,"ok")}y(Yjs,ut);u=Yjs.prototype;
u.Ia=function(){ut.prototype.Ia.call(this);var a=this.Lc();Hq(a,Yis,{description:this.Dp,ids:this.V,xPc:this.O});lr(a,"script-help-dialog")};
u.Oa=function(){ut.prototype.Oa.call(this);var a=this.Ea().getElement(this.V.THa);this.O?(this.F.render(a),this.getHandler().listen(this.F,"action",this.eFb),this.C.render(a),this.getHandler().listen(this.C,"action",this.GNb)):(this.H&&(this.C.render(a),this.getHandler().listen(this.C,"action",this.GNb)),this.F.render(a),this.getHandler().listen(this.F,"action",this.eFb),this.R.render(a),this.getHandler().listen(this.R,"action",this.PMc))};
u.GNb=function(){this.O?Eq("https://support.google.com/docs?p=GSM_migration"):this.H&&Eq(this.H)};u.eFb=function(){this.X?Eq(this.X):(this.ma(),this.dispose())};u.PMc=function(){this.Ca();this.dispose()};var Zjs={THa:"script-help-dialog-buttonbar"};function $js(a,b,c,d){Bm.call(this,"Fl");this.title=d}y($js,Bm);function aks(a,b,c,d,e,f){ut.call(this,void 0,void 0,f);this.O=b;this.F=d;this.H=e;this.C=null;this.setTitle(a);zr(this,!0);a=new Ar(f);for(b=0;b<c.length;++b)d=c[b],a.set(d,bks[d]);a.D="0";Cr(this,a)}y(aks,ut);u=aks.prototype;u.Ia=function(){ut.prototype.Ia.call(this);var a=this.Ea(),b=this.Lc();lr(b,"script-prompt-contents");for(var c=a.Ia("DIV"),d=this.O.split("\n"),e=0;e<d.length;++e)0<e&&c.appendChild(a.Ia("BR")),c.appendChild(xn(a,d[e]));b.appendChild(c);this.F&&(this.C=a.Ia("INPUT"),b.appendChild(this.C))};
u.Fl=q(!1);u.Oa=function(){ut.prototype.Oa.call(this);this.getHandler().listen(this,"dialogselect",va(this.YUc,this))};u.focus=function(){ut.prototype.focus.call(this);this.C&&this.C.focus()};u.YUc=function(a){this.H(Number(a.key),this.F?this.C.value:null)};var bks={1:"Ok",4:"Cancel",2:"Yes",3:"No"};function cks(a,b){ut.call(this);this.H=a;this.F=b;Cr(this,(new Ar).Hj({key:"send",caption:"Send"},!0).Hj({key:"cancel",caption:"Cancel"},!1,!0));this.setTitle("Report an issue");this.C=new Hs;this.Na(this.C)}y(cks,ut);u=cks.prototype;u.Ia=function(){ut.prototype.Ia.call(this);Hr(this,"send");var a=this.Lc();lr(a,"script-reportissue-dialog-content");Hq(a,Zis,{acc:this.F})};
u.Oa=function(){ut.prototype.Oa.call(this);this.C.xb(this.Ka("script-reportissue-dialog-nonanonymous-checkbox"));this.Q_b();var a=this.getHandler();a.listen(this.Ka("script-reportissue-dialog-description"),"input",this.Q_b);a.listen(this,"dialogselect",this.ZUc)};u.Mg=function(){return this.Ka("script-reportissue-dialog-description").value};u.Q_b=function(){var a=!sg(this.Mg());iKb(this.D,"send",a)};u.ZUc=function(a){if("send"!=a.key)return!0;this.H(this.Mg(),this.C.Ne());return!0};function dks(a,b){ii.call(this);this.D={};this.F={};this.J=0;this.R=b;this.C=a;this.C.u4(va(this.XUc,this))}y(dks,ii);u=dks.prototype;u.connect=function(a){this.C.isConnected();this.C.connect(a)};u.isConnected=function(){return this.C.isConnected()};function eks(a,b){b=new U0j({role:0,ph:b,cn:"ide.api.ch",tp:1});b.bP=a;return b}u.$Bc=function(a,b){var c=fks(this,b[0]),d=fks(this,b[1]);b=dg(b,2);try{var e=a.apply(this,b);"function"===typeof e?e(c,d):c.call(this,e)}catch(f){d.call(this,null)}};
u.XUc=function(a,b){if(mg(a,"callback.")&&Jg(this.D,a)){var c=xia(this.D,a);b=null!=b?JSON.parse(b):null;var d=this.F[a];d&&(Qg(this.D,d),Qg(this.F,a),Qg(this.F,d));Qg(this.D,a);c.call(this,b)}};function fks(a,b){return va(function(c){c=null!=c?Pn(c):null;this.C.send(b,c)},a)}u.Va=function(){ii.prototype.Va.call(this);delete this.R;delete this.D;delete this.F;delete this.J;delete this.C};function gks(a,b,c,d){dks.call(this,eks(b,c),d||5E3);this.H=a;a=va(this.O,this);this.C.Gj("method.getContainerInfo",va(this.$Bc,this,a),!0)}y(gks,dks);gks.prototype.O=function(){return Fsk(this.H.call())};gks.prototype.Va=function(){var a=this.C;dks.prototype.Va.call(this);a.dispose();delete this.H};function hks(a,b,c,d,e){ii.call(this);this.H=a;this.O=b;this.V=c;this.F=d||null;this.J=e||null;this.C=this.D=null}y(hks,ii);hks.prototype.open=function(){if(this.F){if(this.F.closed){this.F=null;return}this.D=this.F;this.F=null;sh(this.D.location,this.H)}else this.D=Eq(this.H,{target:this.O});if(this.J)try{this.C=new gks(this.J,this.D,this.V),this.C.connect(),Wn(va(this.R,this,!0),1E5)}catch(a){this.C=null}};
hks.prototype.R=function(a){try{!this.C||a&&this.C.isConnected()||(this.C.dispose(),this.C=null)}catch(b){this.C=null}};hks.prototype.close=function(){this.R();this.D&&!this.D.closed&&(this.D.close(),this.D=null)};hks.prototype.Va=function(){ii.prototype.Va.call(this);this.C&&this.C.dispose();delete this.F;delete this.D;delete this.C;delete this.H;delete this.O};function iks(a,b,c,d,e,f,h,k,l){Jm.call(this);this.V=[];this.Ga=!!k;this.F=a;this.R=b;this.Fa(this.R);this.ma=new Tjs;this.Fa(this.ma);this.C=new Qjs(Ms.rb());this.Fa(this.C);this.D=null;this.Aa=new Mjs(new Ljs,l);this.X=null;e&&(this.X=new Hjs(new Cjs(f,h),l));this.H=new ejs(void 0,k);this.H.ah(this);this.Fa(this.H);this.F.Dn(this.H);this.oa=c;this.Ca=d;this.O=this.J=null}y(iks,Jm);function bis(a){return a.X?a.X.Zd:null}u=iks.prototype;u.ud=n("Ga");
function jks(a,b){if(null==b)a.H.reset(0);else{var c=a.H;c.reset(2);for(var d=0;d<b.length;d++)for(var e=b[d],f=Kk(e,Dhs,4),h=0;h<f.length;h++){var k=f[h];k=new djs(e.getId(),e.getName(),k.getName());c.Na(k,!0)}0===c.Dd()&&c.reset(1);a.H.isVisible()&&a.H.focus()}}function kks(a,b){var c=Wm("docs-script-button-bar");c&&(hn(c),sg(Bh(a))||(a=new Ks(a),a.Id("docs-titlebar-button"),a.render(c),Dm(a,"action",b)))}
function cis(a,b,c){a.O&&!a.O.isDisposed()&&(nVb(a.F,a.O),a.O.dispose());a.O=new cks(b,c);a.O.Qp=!0;a.F.Dn(a.O);a.O.setVisible(!0)}
u.Pjd=function(a,b,c){var d=this.F,e=c||null;c="<p>";var f="Thanks! Your feedback was sent to the creators of <strong>"+(Lq(a)+"</strong>.");c=c+f+"</p>";e&&(c+="<p>",b?(a="You might not receive an individual reply, but if you'd like to learn more, check out <a href=\""+(V(Tq(e))+'" target="_blank">'+(Lq(a)+" help</a>.")),c+=a):(a="You won't receive an individual reply, but if you'd like to learn more, check out <a href=\""+(V(Tq(e))+'" target="_blank">'+(Lq(a)+" help</a>.")),c+=a),c+="</p>");c=Mq(c);
msk(d,"Report an issue",Gq(c),void 0,void 0,"Close")};u.Ojd=function(){msk(this.F,"Report an issue","We're sorry, but we encountered an error sending your issue report. Please try again later.",void 0,void 0,"Close")};function ais(a){a.dispatchEvent("Il")&&(a=a.Ca,a.C.isVisible()&&a.C.hide(),a.D.Ic()||a.D.render(a.F||void 0),a.D.show())}u.v7=function(){this.dispatchEvent("El")&&this.Ca.D.hide()};u.Pdd=function(a,b,c,d,e){a=new hks(a,"MacroService"+kla(c),b,e,d);this.V.push(a);a.open()};
u.Va=function(){Jm.prototype.Va.call(this);li(this.V)};function lks(a,b,c,d,e,f,h,k,l,m,p,r,t,v,A,G,M,T,Y){t=void 0===t?!1:t;v=void 0===v?null:v;M=void 0===M?!1:M;ii.call(this);this.O=a;this.V=l;this.Ta=k;this.oa=m;this.R=b;this.ma=c;this.J=d;this.F=G;this.H=new Mm(this);this.Fa(this.H);this.Pa=p;this.Ra=v;this.X=new Qis(this.ma,this.J);this.Fa(this.X);this.Ga=M;a=this.oa;c=this.Ga;t=void 0===t?!1:t;this.C=new iks(e,h,p,r,mks(a),c,a,t,A);this.Fa(this.C);this.Ja=new Ahs;h=0;b.D?b.C&&(h=2):h=1;this.D=new Shs(this.oa,e,f,this.C,this.Ja,this.O,this.ma,this.V,
h,this.F,T,Y);this.Fa(this.D);this.Aa={};this.Ca=null}y(lks,ii);u=lks.prototype;
u.start=function(){if(no(this.O.J,1,1)){this.H.listen(this.J,"amep",va(this.IUc,this));this.H.listen(this.J,"stbep",va(this.PUc,this));this.H.listen(this.J,"sttep",va(this.QUc,this));this.H.listen(this.J,"spep",va(this.OUc,this));this.H.listen(this.J,"saep",va(this.MUc,this));this.H.listen(this.J,"snep",va(this.NUc,this));this.H.listen(this.J,"paep",va(this.KUc,this));this.H.listen(this.J,"rfep",va(this.LUc,this));this.H.listen(this.C,"dialogselect",va(this.axc,this));this.H.listen(ETc.rb(),"Yc",
va(this.JUc,this));this.Ta(va(this.Xwc,this));var a=this.O.C;U("macros-exec").Kc(cp,this.Swc,this);U("macros-resume").Kc(cp,this.CHc,this);U("macros-manage").Kc(cp,va(a.tF,a,va(this.BBc,this)));U("macros-editor").Kc(cp,this.L8a,this);U("macros-extensions").Kc(cp,va(this.NDb,this));U("macros-manage-extensions").Kc(cp,va(this.ABc,this));U("macros-extension-menu-promo").Kc(cp,va(this.NDb,this));U("macros-extension-disabled").Kc(cp,this.dvc,this);U("macros-extension-help").Kc(cp,this.ixc,this);U("macros-extension-install-start").Kc(cp,
this.oAc,this);U("macros-trigger-0").Kc(cp,va(this.gZ,this,"0"));U("macros-trigger-1").Kc(cp,va(this.gZ,this,"1"));U("macros-trigger-2").Kc(cp,va(this.gZ,this,"2"));U("macros-trigger-3").Kc(cp,va(this.gZ,this,"3"));U("macros-trigger-4").Kc(cp,va(this.gZ,this,"4"));U("macros-trigger-5").Kc(cp,va(this.gZ,this,"5"));U("macros-trigger-6").Kc(cp,va(this.gZ,this,"6"));U("macros-trigger-7").Kc(cp,va(this.gZ,this,"7"));U("macros-trigger-8").Kc(cp,va(this.gZ,this,"8"));U("macros-trigger-9").Kc(cp,va(this.gZ,
this,"9"));this.X.start();nks(this.oa,this.Ga)&&(U("macros-addon-sidebar-focus").Xa(!0),U("macros-addon-sidebar-focus").qc(void 0,phs(19)));hjs(new gjs(this.R,this.D));a=this.R.J;var b=!this.R.C,c=this.ma,d=this.V().getState()||void 0;d=["ruid",ta({}),c.C.C,c.D,c.C.D,d];b||d.push("addon_safe_mode",!0);a&&d.push("addon_dry_run",a);No(Po(Ohs(c,c.C.Ga),"POST").setContent(""),d).wC().Ii()}};
function oks(a){jks(a.C,null);var b=va(function(c){c.QB()?jks(this.C,Kk(c,Fhs,2)):(this.C.C.C.postMessage(Os("Could not load scripts.","warning",!0)),jks(this.C,[]))},a);Phs(a.ma,b)}
function pks(a,b,c,d,e,f){if(d){ais(a.C);var h=va(function(){var r=mis(this.D,b);r&&!uk(r,4)&&(R(r,4,!0),dis(this.D))},a);var k=va(function(){this.C.v7();this.O.Bs.dispatchEvent(new Qn(!0))},a);var l=va(function(r){this.C.v7();8!=r.sX()&&Sjs(this.C.C,c,r.$j())},a);$hs(a.D)}else{var m=Rjs(a.C.C),p=va(function(r){this.X.F.cancel(r);Ns(this.C.C.C,m)},a);h=va(function(r){Ns(this.C.C.C,m);m=Rjs(this.C.C,wa(p,r))},a);k=va(function(r){Ns(this.C.C.C,m);if(r.hwa()){r=this.C.C;var t=ug("Canceled script ");
r.C.postMessage(Os(t,"info",!1,2500))}else r=this.C.C,t=ug("Finished script "),r.C.postMessage(Os(t,"info",!1,2500));this.O.Bs.dispatchEvent(new Qn(!0))},a);l=va(function(r){Ns(this.C.C.C,m);8!=r.sX()&&Sjs(this.C.C,c,r.$j())},a)}a.Pa.Qc(3);VUj(a.O.C,va(a.Egd,a,b,c,h,k,l,d,e,f))}u.Egd=function(a,b,c,d,e,f,h,k){var l=this.V().getState()||void 0,m=this.X;c=void 0===c?pa:c;d=void 0===d?pa:d;e=void 0===e?pa:e;e=va(m.SUc,m,a,b,c,d,e);m.F.fHb(a,b,l,e,f,h,k)};
u.JUc=function(a){var b=bg(this.D.D),c={};b=da(b);for(var d=b.next();!d.done;d=b.next())d=d.value,c["ADD-ON:"+N9(d)]={name:d.getName(),"cws-id":Q(d,1),"gsm-application-id":Q(d,18),"app-key":N9(d)};Ug(a.k_,c)};u.dvc=function(a){a.data==this.Ca&&(a=this.C,a.dispatchEvent("Dl")&&a.Aa.Zd.ZTa())};
u.IUc=function(a){a=a.C().Nc();var b={},c=qks(this,a);if(1==wk(a,11,0)){var d=Q(a,4);d=mis(this.D,d)}else d=void 0;var e=d,f=e&&(uk(e,10)||uk(e,9))||!1,h=e&&uk(e,19)||!1;d=this.Ja;var k=c,l=Q(a,4),m=1==wk(a,11,0);f=new yhs(a,k,m,f,h);f.setVisible(!0);0==wk(a,11,0)&&(l=f.getLabel());d.C[wk(a,11,0)][l]=f;d.dispatchEvent("Hl");(d=bis(this.C))&&Q(a,9)&&(1==Q(a,12)||5==Q(a,12))&&(l=Q(a,4),d.J[l]=a,l&&l in d.D&&Bjs(d.D[l],a));c=c.reverse();if(d=this.C.R){for(l=0;l<c.length;l++)if(f=c[l],h=f.getKey())if(b[h])R(f,
5,void 0);else{if(this.Aa[h])for(k="Ctrl+Alt+Shift+"+h.toUpperCase(),k=hOb(U("macros-exec"),[k]),m=0;m<d.ma.length;m++){var p=d.ma[m];qn(p)==k&&on(p,"")}this.Aa[h]=f.Xh();b[h]=!0}if(1==wk(a,11,0)){b=null!=e?e:null;c=[];e=Q(a,4);f=!!Q(a,9)&&3!=Q(a,12);l=d.C.F.get(e);l||(l=new rs(""),l.qd(e),h=Q(a,10),l.setContent(en(h)),l.Xa(2==d.V?!1:f&&1==d.V?!1:!0),d.F.Ad(),gis(d.C,l),his(d));f||d.X.push(e);f=new os;!b||uk(b,10)||uk(b,9)||uk(b,19)||(iis(d,f,b),h=new Zgs,k=String(ta(h)),R(h,1,k),f.Na(njs(d,h,c),
!0));h=b&&(uk(b,10)||uk(b,9))||!1;if(!b||h||!uk(b,19))for(a=a.Em(),h=0;h<a.length;++h)f.Na(njs(d,a[h],c,void 0,b?b:void 0),!0);b&&jis(d,f,e,c,b);d.oa[e]=c;l.Lh(f);l.dispatchEvent("load");d.Ca.push(e)}else{b=a.Vk();if(d.nE(b)){d.nE(b);c=d.D[b];delete d.D[b];d.H.removeChild(c,!0);if(d.O)for(e=d.Aa[b],l=0;l<e.length;++l)d.O.ufa(e[l]);delete d.Aa[b];c.dispose()}10<=Eg(d.D)||(b=[],a.Em(),c=a.Vk(),a=njs(d,a,b,"Ctrl+Alt+Shift+").Nc(),a=new Us(c,a,kjs.rb(),void 0,!0),e=d.H.Dd()?d.H.Dd()-1:0,d.H.yj(a,e,!0),
d.D[c]=a,d.Aa[c]=b)}}};u.PUc=function(a){a=a.C();var b=a.Vk();b?kks(b,va(function(c){var d=Bh(c.getUrl());sg(d)||Eq(d);d=Bh(c.getFunctionName());sg(d)||pks(this,Q(c,1),d,Q(c,4)||void 0,void 0,c.EB()||void 0)},this,a)):Ujs()};
u.QUc=function(a){var b=a.C();a=b.getText();b=b.Zs();var c=this.C.ma,d=Wm("docs-script-button-bar");d&&(Vjs(c),sg(Bh(a))||(a=Jq(Uis,{caption:a}),gn(d,a),sg(Bh(b))||(c.C=new ds,c.C.Id("docs-script-button-bar-bubble"),c.C.setContent(Jq(Vis,{text:b})),c.C.kp(a),es(c.C,!0),c.C.i2=!1,c.C.setPosition(1,1),c.C.tB(!1),c.C.render(d),c.D.listen(a,"mouseover",va(c.C.setVisible,c.C,!0)).listen(a,"mouseout",va(c.C.setVisible,c.C,!1)))))};
u.OUc=function(a){this.C.v7();var b=a.C(),c=xk(b,6,!1);a=c?Q(b,3).replace(/\n/g," ").replace(/\\n/g,"\n"):Q(b,3);var d=Q(b,7),e=this.C,f=b.getTitle(),h=Q(b,4),k=xk(b,5,!1);b=va(this.cGc,this,Q(b,1),c,d);e.D&&(e.D.setVisible(!1),nVb(e.F,e.D));e.D=new aks(f,a,h,k,b);e.D.Qp=!0;e.F.Dn(e.D);e.D.setVisible(!0)};u.cGc=function(a,b,c,d,e){var f=new vis;R(f,1,d);R(f,3,b);R(f,4,c);null!==e&&R(f,2,e);U("macros-resume").qc([a,Pn(f.Oc())])};
u.MUc=function(a){a=a.C();var b=k4j(S(a,AX,9));var c={};c.mid=this.R.H;b=sja(b,c);switch(wk(a,6,0)){case 1:var d=this.C;c=Q(a,3);var e=this.V,f=a.getTitle()||void 0;if(d.dispatchEvent(new $js(b,c,e,f))){var h=d.oa;d=d.Aa.Zd;d.Ic()||(d.render(),d.resize());d.ZTa();var k=d.Ea();k.Qh(d.H,f||"Apps Script application");f=va(h.Qc,h,3);d.C=new Jjs(b,c,[new Ijs("google.script.host.close",va(d.ZTa,d),0),new Ijs("google.script.host.editor.focus",f,0)],e,k);ji(d.C,f);d.Na(d.C,!0);U("macros-application-focus").qc()}this.Ca=
Q(a,7)||null;break;default:c=this.C,e=Q(a,3),f=this.V,h=a.getTitle()||void 0,d=a.zc()||void 0,k=a.Ec()||void 0,a=xk(a,8,!1),c.D&&(c.D.setVisible(!1),nVb(c.F,c.D)),c.D=new Kjs(b,e,f,c.oa,h,d,k,a),c.D.Qp=!0,c.F.Dn(c.D),c.D.setVisible(!0)}};u.NUc=function(a){a=a.C();var b=a.getType();this.Ra(b,a.getText(),a.getTitle()||void 0,Q(a,4)||void 0)};
u.KUc=function(a){a=a.C();var b=S(a,ris,3);b&&(rk(b,2)||rk(b,11))?(b=new ghs(Q(b,2),Q(b,11)),uk(a,4)?(b=this.D.getExtension(b),null!=b&&uk(b,10)?(b="The add-on "+(b.getName()+" needs your permission to run in this document."),a=a.getUrl(),new Ojs(a,(new Xt).format(""),void 0,void 0,b)):(a=a.getUrl(),new Ojs(a,(new Xt).format("A script attached to this document needs your permission to run."),void 0,void 0,"Updated add-on"))):this.D.Iha(b)):(a=a.getUrl(),new Ojs(a,(new Xt).format("A script attached to this document needs your permission to run."),
void 0,void 0,void 0))};u.LUc=function(a){a=a.C();pks(this,Q(a,1),a.getFunctionName(),Q(a,4)||void 0,void 0,a.EB()||void 0)};u.Swc=function(a){a=a.data;var b=mis(this.D,a.C);!b||uk(b,9)?pks(this,a.C,a.functionName,a.F||void 0,1,a.D||void 0):this.D.Iha(ihs(b))};u.CHc=function(a){ais(this.C);var b=a.data;a=b[0];b=b[1];var c=va(function(){this.C.C.C.postMessage(Os("Error resuming script execution","warning",!0))},this);Ris(this.X,a,b,c)};u.BBc=function(){this.C.H.setVisible(!0);oks(this)};
u.L8a=function(a){var b=a.data;a=b?b.scriptId:void 0;a=new tm(ois(this.R,a?a:void 0));b&&(a=b.editorUri?new tm(b.editorUri):a,b.filename&&a.Jd("f",b.filename),b.lineNumber&&(a.Jd("l",b.lineNumber),a.Jd("s",b.lineNumber)));b=this.O.F;var c=null;Bo(this.O.C)||(c=VRj("Loading\u2026",{target:"MacroService"+kla(b)}));this.O.C.tF(va(this.C.Pdd,this.C,a.toString(),this.R.R,b,this.V,c))};u.NDb=function(){this.D.Iha()};
u.ABc=function(a){if(a.data)this.D.Iha(a.data);else{a=this.D;var b=Zhs(a,!0),c=a.V;var d=c.D;b=uhs(d,d.C,b,void 0,!0);d=vhs(d,b);c.C=d;d=c.C;c.F.Dn(d);d.setVisible(!0);$hs(a)}};
u.ixc=function(a){var b=this.D,c=mis(b,a.data);if(c){var d=ihs(c);a=va(b.PVb,b,d,N9(c),c.getName(),Q(c,6)||void 0,Q(c,11)||void 0);d=va(b.Iha,b,d);var e=uk(c,19)||void 0,f=b.C,h=c.getName(),k=Bh(Q(c,7)),l=Q(c,6)||void 0;c=Q(c,11)||void 0;e=void 0===e?!1:e;f.J&&!f.J.isDisposed()&&(nVb(f.F,f.J),f.J.dispose());f.J=new Yjs(h,k,a,d,l,c,e);f.J.Qp=!0;f.F.Dn(f.J);f.J.setVisible(!0);$hs(b)}};
u.oAc=function(a){if(a.data){var b=mis(this.D,a.data);if(null!=b)if(a=this.D,b=ihs(b),a.H){a:{if(1==a.H)b="Add-ons aren't allowed in your domain. Talk to your domain administrator for more information.";else if(2==a.H)b="Add-ons aren't allowed while in safe mode.";else break a;msk(a.oa,"Oops",b,void 0,void 0,"Close")}dis(a)}else{var c=a.getExtension(b);c&&uk(c,9)?(b=a.getExtension(b).getName(),b=ug(b+" is already installed"),a.C.C.C.postMessage(Os(b,"info",!1,2500)),dis(a)):a.Iha(b)}}};
u.axc=function(a){"edit"==a.key?(a=a.target.FE.Wi(),a=ois(this.R,a?a.bIb:void 0),this.L8a(new bCb({editorUri:a}))):"new"==a.key?this.L8a(new bCb({editorUri:this.R.X})):"reload"==a.key?oks(this):"run"==a.key&&(a=a.target.FE.Wi(),pks(this,a.bIb,a.getFunctionName(),void 0,void 0,a.EB()))};u.gZ=function(a){(a=this.Aa[a])&&(a=mjs(this.C.R,a))&&a.isEnabled()&&a.dispatchEvent("action")};u.Xwc=function(){for(var a=this.C,b=0;b<a.V.length;b++){var c=a.V[b];c.close();c.dispose()}a.V=[]};
function qks(a,b){var c=[];Q(b,3)&&c.push(b);b=b.Em();for(var d=0;d<b.length;d++)c=c.concat(qks(a,b[d]));return c}u.getView=n("C");function mks(a){return a==(Ls(),KPb)||a==(Ls(),MPb)||a==(Ls(),LPb)}function nks(a,b){return b&&(a==(Ls(),KPb)||a==(Ls(),LPb))};function rks(a,b,c,d,e,f,h){ii.call(this);var k=this;this.D=a;this.O=b;this.Hb=e;this.F=d;this.ma=new Km;this.C=f;this.oa=h;this.V=new Bs(this);this.Fa(this.V);this.V.Kc(fcc,Zo,this.J);this.X=new Mm(this);this.Fa(this.X);this.ma.Mc(this.F.F,function(){return k.J()});this.H=new VRb(this.Hb.fd(),!0);this.Fa(this.H);this.R={};this.J()}y(rks,ii);rks.prototype.J=function(){var a=sks(this),b=this.O.Nc(icc.getId(),!0);b.Vf(!0);KSb(this.O,b,[new Xjk(a)]);lr(b.getElement(),"waffle-action-menu")};
function sks(a){var b=Array.from(a.F.C.values());kgs(b,function(r){return jj(r,8)});var c=Array.from(a.F.D.values());ft(a.oa,bhe(0<b.length,0<c.length));hcc.setProperty("visible",!0);gcc.setProperty("visible",!0);var d={};c={};b=da(b);for(var e=b.next();!e.done;c={K_a:c.K_a},e=b.next()){e=e.value;var f=jj(e,1),h=e.getFunctionName(),k=jj(e,8),l=ej(e,9)?jj(e,9):null,m="recorded-action-"+f+":"+h,p=a.D.cj(m);p||(p=(new OEb(m)).enabled(!0),p.La(29583),p=p.build(),c.K_a=new Ygs(f,h,void 0,void 0,void 0,
ej(e,12)?e.EB():void 0),p.Kc(cp,function(r){return function(){U("macros-exec").qc(r.K_a)}}(c)),wRb(a.H,[p]),a.D.hA(p),a.C&&a.C.uo(p));p.setProperty("label",k);tks(a,l)&&p.setProperty("keys",[l]);null==l&&null!=p.getProperty("keys")&&p.setProperty("keys",null);d[m]=p}Ag(a.R,function(r,t){d[t]||(r.setProperty("keys",null),a.D.w$(t),a.C&&a.C.ufa(t),ki(r))});a.R=d;return Fg(d)}function tks(a,b){return!fcc.jg()&&null!=b&&/^Ctrl\+Alt\+Shift\+\d$/i.test(b)&&0==(kha(a.H.C,ud(b))||[]).length};function uks(a,b){this.gmb=a;this.RYa=b};function vks(a,b){a='<div class="waffle-recording-toast" role="complementary" tabIndex="0" aria-describedby="waffle-recording-toast-content"><div class="waffle-recording-toast-top"><div class="waffle-recording-toast-icon"><div class="waffle-recording-toast-outer-circle"><div class="waffle-recording-toast-inner-circle"></div></div></div><div class="waffle-recording-toast-content"><div class="waffle-recording-toast-new-content"></div><div class="waffle-recording-toast-default-content">Recording new macro\u2026</div></div><div class="waffle-recording-toast-right"><div class="waffle-recording-toast-cancel">Cancel</div><div class="waffle-recording-toast-stop">Save</div><div class="waffle-recording-toast-expand-section"><div class="waffle-recording-toast-expand"><div class="waffle-recording-toast-expand-icon"></div></div></div></div></div><div class="waffle-recording-toast-bottom" role="radiogroup"><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-absolute">'+
Rz({label:Qq('Use absolute references<div class="waffle-recording-toast-label-description">When applying macro use exact location as recorded</div>')},b);a=a+'</div></div><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-relative">'+Rz({label:Qq('Use relative references<div class="waffle-recording-toast-label-description">When applying macro use active selection</div>')},b);return Mq(a+"</div></div></div></div>")};function wks(a){uq.call(this,a);this.J=new gs("",new Bt,this.Ea());this.Na(this.J);this.F=new gs("",new Bt,this.Ea());this.Na(this.F);this.D=new Cs;this.Fa(this.D);this.H=null;this.C=0}y(wks,uq);u=wks.prototype;u.Ia=function(){this.Qb(Jq(vks))};
u.Oa=function(){uq.prototype.Oa.call(this);this.R=new RIk(this.Ea(),void 0,"relative");this.O=new RIk(this.Ea(),void 0,"absolute");this.R.xb(this.Ka("waffle-recording-toast-relative"));this.O.xb(this.Ka("waffle-recording-toast-absolute"));var a=Sg(Es);Rg(a,"selected",!0);var b=Fp(new Ep,6).build();Ds(this.D,this.R,lcc,a,void 0,b);Ds(this.D,this.O,mcc,a,void 0,b);Ds(this.D,this.J,U("recorded-action-stop"),void 0,void 0,b);Ds(this.D,this.F,ecc,void 0,void 0,b);this.H=new sad(this.Ka("waffle-recording-toast-expand"),
this.Ka("waffle-recording-toast-bottom"),ncc.isVisible(),void 0,this.Ea());this.Fa(this.H);this.getHandler().listen(this.H,"toggle",this.PGc);this.J.xb(this.Ka("waffle-recording-toast-stop"));this.F.xb(this.Ka("waffle-recording-toast-cancel"))};u.setVisible=function(a){var b=this.Sa();oq(b,a);gr(b,"hidden",!a);a&&(a=this.Ea().fd(),a=bn(a)||window,b=mq(this.Sa()),this.Sa().style.left=Math.max(Math.floor(an(a).width/2-b.width/2),0)+"px")};
function xks(a,b){a.Ka("waffle-recording-toast-default-content").style.opacity=0;var c=a.Ka("waffle-recording-toast-new-content");a.Ea().Qh(c,b);0!=a.C?yks(a):(Xn(a.C),a.C=Wn(function(){return yks(a)},400))}function yks(a){var b=a.Ka("waffle-recording-toast-new-content");nr(b,"waffle-recording-toast-slide-in");Xn(a.C);a.C=Wn(function(){lr(b,"waffle-recording-toast-slide-in");Xn(a.C);a.C=Wn(function(){return zks(a)},2200)})}
function zks(a){var b=a.Ka("waffle-recording-toast-default-content"),c=a.Ka("waffle-recording-toast-new-content");nr(c,"waffle-recording-toast-slide-in");b.style.opacity=1;Xn(a.C);a.C=Wn(function(){a.C=0},400)}u.PGc=function(a){ncc.setVisible(a.lX)};u.Va=function(){Xn(this.C);uq.prototype.Va.call(this)};function Aks(a,b,c,d){ii.call(this);var e=this;this.R=a;this.O=c;this.D=d;this.C=il().Mmc()(il().XF()(),il().jlc()(),O9(this),lcc.jg(),function(f){f="Action "+(il().Lmc()(e.C)+(": "+f));Bks(e,f)},il().GAb()());il().YAb()(this.C);this.H=new wks;this.Fa(this.H);this.Ca=new Bs(this);this.Fa(this.Ca);this.Ca.Kc(lcc,cp,this.KMc,this).Kc(mcc,cp,this.JMc,this).Kc(U("docs-doc-copy-made"),cp,this.uvc,this).Kc(U("macros-exec"),cp,this.aIc,this).Kc(j6b,cp,function(f){return Cks(e,f.data,2)},this).Kc(p6b,cp,
function(f){return Cks(e,f.data,3)},this).Kc(i6b,cp,function(f){return Cks(e,f.data,1)},this).Kc(k6b,cp,function(f){return Cks(e,f.data,5)},this).Kc(j7b,cp,function(f){return Cks(e,f.data,4)},this).Kc(D6b,cp,function(f){f=f.data;switch(f.F){case "all-objects-for-all-datasources":il().Bmc()(e.C,O9(e));break;case "all-objects-for-single-datasource":il().Cmc()(e.C,O9(e),f.D);break;case "specific-ids":var h=f.C[0];f=il().qX()(h);var k=null;switch(f){case 4:k=Dks(e,h,!1);break;case 1:case 3:case 5:(h=
il().Zxb()(h,dY(e.O)))&&0<h.length&&(k=qo(h[0]),k=msb(lsb(ksb(isb(),k.Fb()),k.yd()),k.jd()).build(),h=ngs(),3==f?(ogs(h),Aj(h,6,k)):1==f?(ogs(h),Aj(h,5,k)):5==f&&(ogs(h),Aj(h,4,k)),k=h.build().Ob());break;case 2:(h=il().Yxb()(h))&&0<h.length&&(k=mgs(h[0]).build().Ob())}k&&il().aBb()(e.C,O9(e),f,k)}}).Kc(v6b,cp,function(){return il().Dmc()(e.C,O9(e),!1)},this).Kc(h6b,cp,this.Stc,this).Kc(l6b,cp,function(f){return il().xmc()(e.C,O9(e),f.data.Ob())},this);this.F=new Km;this.Fa(this.F);this.F.Mc(a.$a,
function(){il().Rmc()(e.C,!0,O9(e))});this.F.Mc(a.Pa,function(f){if(f.D){var h=f.C.D();"docs-edit"==h?"ritz-waffle"==f.C.C&&il().Omc()(e.C,O9(e)):"docs-undo"==h?(Bks(e,"Undo previous action"),il().Smc()(e.C)):"docs-redo"==h&&(Bks(e,"Redo previous action"),il().Pmc()(e.C))}});this.F.Mc(b.oa,function(f){f.C||il().Imc()(e.C,O9(e),f.D)});this.F.Mc(this.D.Gb,function(f){return Eks(e,f)});this.F.Mc(this.D.Pc,function(){e.ma=O9(e)});this.F.Mc(this.D.Hc,function(f){switch(f.D){case "find-next-occurrence":il().ymc()(e.C,
e.ma,O9(e),f.C.Ob());break;case "replace-current-occurrence":il().Emc()(e.C,O9(e),f.C.Ob())}e.ma=null});this.F.Mc(this.D.kb.D,function(f){il().Hmc()(e.C,O9(e),f.F,f.H,f.J,f.O,f.id,f.C,f.D)});this.F.Mc(b.Bs,function(){il().vmc()(e.C,e.Aa,O9(e),e.oa);e.Aa=null;e.oa=null});this.F.Mc(this.D.Sc,function(f){il().wmc()(e.C,e.J.D.C.Ob(),f.getSelection().C.Ob(),e.J.C.Ob());e.J=null});this.X=new Mm(this);this.Fa(this.X);this.J=this.ma=this.oa=this.Aa=this.V=null;this.X.listen(this.D.C,"pa",this.C4c).listen(this.D.C,
"va",this.B4c);this.H.render();this.H.setVisible(!0);Fks(this);setTimeout(function(){return gx("All actions are now being recorded. Please use the Tools menu to cancel or save recording.")})}y(Aks,ii);u=Aks.prototype;u.B4c=function(){this.V=O9(this)};u.C4c=function(a){!a.j_&&u9c(this.D)&&(void 0!==a.$ia?(a=a.$ia,il().Jmc()(this.C,this.V,O9(this),a)):(a=this.D.C.C.dh(),xks(this.H,"Activating sheet "+a),il().Kmc()(this.C,this.V,O9(this),a)),this.V=null)};
function Bks(a,b){xks(a.H,b);gx("Macro recorder "+b)}function Gks(a){return il().Nmc()(a.C,O9(a))}u.aIc=function(a){this.oa=a.data.functionName;this.Aa=O9(this)};function Eks(a,b){var c=O9(a);a.X.qe(a.D,"gc",function(){var d=O9(a);switch(b.H){case "adjust-next-data-region-edge":il().umc()(a.C,c,d,b.D,b.C);break;case "move-next-data-region-edge":il().Amc()(a.C,c,d,b.D,b.C);break;case "select-all":il().Fmc()(a.C,c,d);break;case "select-rows-columns":il().Gmc()(a.C,c,d,"c"==b.F)}})}
u.uvc=function(a){a=a.data;il().zmc()(this.C,O9(this),a.C)};u.Stc=function(a){a=a.data;var b=this.R.C.getSelection();this.J=new Hks(a,b)};
function Cks(a,b,c){var d=il().aBb(),e=a.C,f=O9(a);a:switch(c){case 4:b=Dks(a,b,!0);break a;case 3:case 1:case 5:var h=kx(a.O);h?(a=usb(a.R.C.getSelection()),Iks(b,a,h)?b=null:(a=VBd(h),Iks(b,a,h)?(b=xJc(h.mb().Pk(a.y,a.x)),b=null!=b?b:msb(lsb(ksb(isb(),h.R.C.C.Fb()),a.y),a.x).build(),h=ngs(),3==c?(ogs(h),Aj(h,6,b)):1==c?(ogs(h),Aj(h,5,b)):5==c&&(ogs(h),Aj(h,4,b)),b=h.build().Ob()):b=null)):b=null;break a;case 2:if(h=kx(a.O)){a=a.R.C.getSelection();var k=mzk(h);b=k&&kj(a.C,6).Oc().includes(k)?null:
(a=kzk(h))&&b==lzk(h)?mgs(a).build().Ob():null}else b=null;break a;default:b=null}d(e,f,c,b)}function Iks(a,b,c){if(!b)return!1;b=c.mb().Pk(b.y,b.x);c=UBd(c,b);return a==c}function Dks(a,b,c){if(c&&(a=a.D.C.C)&&lv(a))return null;b=il().o6()(b);if(!b)return null;(b=il().hca()(b))?(a=ngs(),ogs(a),b=vj(a,2,b).build().Ob()):b=null;return b}u.KMc=function(){var a=!il().bBb()(this.C);Jks(this,!0);a&&(xks(this.H,"Using relative references"),gx("Recording with relative references"))};
u.JMc=function(){var a=il().bBb()(this.C);Jks(this,!1);a&&(xks(this.H,"Using absolute references"),gx("Recording with absolute references"))};function Jks(a,b){il().Qmc()(a.C,b);lcc.Gd(b);mcc.Gd(!b)}function Fks(a){(a=kx(a.O))&&oud(a)}function O9(a){return a.R.C.getSelection().C.Ob()}u.Va=function(){il().kAb()();ii.prototype.Va.call(this)};function Hks(a,b){this.C=a;this.D=b};function Kks(a,b,c,d){Dt.call(this,"Macro saved",Tm(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-saved"]);this.Ta=a;this.Aa=b;this.R=c;this.Ga=d}y(Kks,Dt);Kks.prototype.Ia=function(){Dt.prototype.Ia.call(this);var a=wq(this,"script-recorder-edit-link-id");this.xJ("EDIT SCRIPT",a)};Kks.prototype.Oa=function(){Dt.prototype.Oa.call(this);this.getHandler().pj(Cq(this,"script-recorder-edit-link-id"),Fm,va(this.O,this,this.Ta,this.Aa,this.R))};
Kks.prototype.O=function(a,b,c){this.Ga.C(29645);U("macros-editor").qc(b?{scriptId:a,filename:b,lineNumber:c}:void 0)};function Lks(a,b,c,d,e,f,h,k,l,m){bt.call(this);var p=this;this.Aa=a;this.ma=b;this.Ta=c;this.Ja=d;this.X=e;this.J=f;this.Ga=h;this.oa=k;this.R=m;this.Ca=new Bs(this);this.Fa(this.Ca);this.H=null;this.O=!1;this.C=null;this.Pa=l;this.Ca.subscribe(jcc,"action",this.Oid).subscribe(U("recorded-action-stop"),"action",this.Ckd).subscribe(occ,"action",this.Igd).subscribe(ecc,"action",this.Z5b).subscribe(gcc,"action",this.pjd).subscribe(hcc,"action",this.vjd);et(this,Mks(this));Kp(this.J,this);a=["not-revisions",
"sheet-access-edit",ht()];var r=new Jp(a.concat(["docs-script-recording"]));Bf([ecc,U("recorded-action-stop"),occ,kcc,mcc,lcc],function(t){p.J.C(t,r);p.J.F(t,r)});a=new Jp(a.concat(["not-docs-script-recording"]));this.J.C(jcc,a);Yt()||this.J.F(jcc,a)}y(Lks,bt);u=Lks.prototype;u.Oid=function(){var a=this;this.H=new Aks(this.Ta,this.Ja,this.X,this.Ga);ft(this,Mks(this));this.Ga.D.C.tF(function(){Oo(Wl(Po(a.Aa.Hi("/startrecordingscript"),"POST"),1).setTimeout(18E4)).Ii()})};
u.Ckd=function(){$Pc(this.X)&&qkd(kx(this.X),!0);this.H.H.setVisible(!1);il().kAb()();ggs(this.ma)};
u.Igd=function(a){var b=this,c=a.gmb;a=a.RYa;var d=Gks(this.H).C;Nks(this,Gt(this.R,"Saving new macro",Tm(),!0,0,!1,void 0,!0,["waffle-recording-toast-saving"]),!0);this.O=!0;ft(this,Mks(this));Oo(Xl(Zl(Wl(Po(Vl(Vl(Dxb(this.Aa.Hi("/saverecordedscript"),["script",d]),"name",c),"shortcut",""!=a?"Ctrl+Alt+Shift+"+a:""),"POST"),1),function(e){var f=e.Uca("scriptId"),h=e.Uca("filename");e=Number(jx(e,"lineNumber"));f=new Kks(f,h,e,b.Pa);fXb(b.R,f);Nks(b,f);b.O=!1;Oks(b)}),function(){Nks(b,Gt(b.R,"Failed to save macro",
Tm(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-save-failed"]));b.O=!1;if(b.H){var e=b.H;il().YAb()(e.C);e.H.setVisible(!0)}ft(b,Mks(b))}).setTimeout(18E4)).Ii()};function Oks(a){ki(a.H);a.H=null;ft(a,Mks(a))}u.Z5b=function(){Oks(this);setTimeout(function(){return gx("Script recording canceled")})};function Mks(a){var b={},c=!!a.H;a=a.O;b["docs-script-recording"]=c&&!a;b["not-docs-script-recording"]=!c&&!a;return b}u.pjd=function(){hgs(this.ma,this.oa)};u.vjd=function(){igs(this.ma,this.oa)};
function Nks(a,b,c){a.C&&(gXb(a.R,a.C),a.C.setVisible(!1),ki(a.C));a.C=b;a.C.render();c&&(new o7k(!0,Tm())).render($m("docs-ui-toast-content",b.getElement()));a.C.setVisible(!0)}u.Va=function(){ki(this.H);this.H=null;this.C&&(ki(this.C),this.C=null);bt.prototype.Va.call(this)};function Pks(a,b,c,d){1==a&&zMc(wh(c||""),wh(b),void 0!==d?d:-1,!0)};function Qks(a,b,c,d,e,f,h,k,l,m,p,r,t,v,A,G,M,T,Y){ii.call(this);this.V=a;this.ma=b;this.Aa=c;this.Ca=d;this.R=e;this.Ta=f;this.Ra=h;this.C=k;this.F=l;this.Pa=m;this.O=p;this.X=r;this.Ya=t;this.J=new Mm(this);this.Fa(this.J);this.oa=new xgs(this.Aa,this.F);this.hb=new Lks(this.Aa,this.R,this.ma,this.V,this.C.D,A,this.F,this.oa,G,M);this.Fa(this.hb);this.$a=new rks(A.H,this.C.Aa.C,l,this.oa,v,this.C.Aa.Ja,T);this.Fa(this.$a);this.D=null;this.H=Y}y(Qks,ii);
Qks.prototype.init=function(){var a=this.C.Aa.Ja;a.uo(jcc);a.uo(ecc);a.uo(U("recorded-action-stop"));a.uo(lcc);a.uo(mcc);a.uo(gcc);a.uo(hcc);a=this.F.Nb.D;var b=this.F.Nb.C;b&&(b+=a?"_"+a:"");a=vf();var c=of(a,"docs-tintd")&&of(a,"docs-thtea");this.D=new nak(this.Ca,this.ma.C,this.C.D);this.Fa(this.D);var d=this.V,e=fyb(this.O),f=gyb(this.O),h=this.R,k=this.Ta,l=this.Ra,m=va(this.X.V,this.X),p=va(this.D.C,this.D),r=(Ls(),LPb),t=this.Pa,v=this.Ya,A=this.Ca,G=au(Zt.rb()),M=this.C.Aa.C;G=void 0===G?
!1:G;c=void 0===c?!1:c;var T=vf();T=new nis(rf(T,"maestro_container_token"),rf(T,"maestro_domain"),rf(T,"maestro_script_editor_uri"),rf(T,"maestro_new_project_uri"),of(T,"docs-emae"),rf(T,"mae-pai"),of(T,"mae-cwssw"),of(T,"mae-aoeba"),of(T,"mae-esme"),rf(T,"mae-dret"),rf(T,"mae-ses"),of(T,"docs-tdd"),of(T,"mae-seitd"));e=new Mhs(d.F,String(A),e,void 0);A=new Pis;A.bind(f);f=T.C?2:T.D?0:1;var Y=new Cs(void 0,void 0,!0,Kt.rb());l=l?new ljs(l,Y,f,M,void 0):null;d=new lks(d,T,e,A,h,k,l,m,p,r,t,v,G,Pks,
LRd,b,c);d.Fa(e);d.Fa(A);d.start();U("macros-addon-sidebar").Xa(mks(r));U("macros-addon-sidebar-focus").Xa(nks(r,c||!1));U("macros-application-focus").Xa(!0);U("macros-application-sidebar").Xa(!0);U("macros-editor").Xa(!T.oa||T.F);U("macros-exec").Xa(!0);U("macros-extension-disabled").Xa(!0);U("macros-extension-help").Xa(!0);U("macros-extension-install-start").Xa(!0);U("macros-extension-menu-promo").Xa(!0);U("macros-manage").Xa(!0);U("macros-resume").Xa(!0);U("macros-trigger-0").Xa(!0);U("macros-trigger-1").Xa(!0);
U("macros-trigger-2").Xa(!0);U("macros-trigger-3").Xa(!0);U("macros-trigger-4").Xa(!0);U("macros-trigger-5").Xa(!0);U("macros-trigger-6").Xa(!0);U("macros-trigger-7").Xa(!0);U("macros-trigger-8").Xa(!0);U("macros-trigger-9").Xa(!0);null!=this.H&&(a=of(a,"docs-isctp"),this.H.ma=a,this.J.listen(d.J,"scpep",va(this.Ja,this)));this.J.listen(ex,"runMacro",va(this.Ga,this))};Qks.prototype.Ja=function(a){null!=this.H&&(a=uk(a.C(),1),this.H.ma=a)};
Qks.prototype.Ga=function(a){var b=a.payload;a=Df(il().Pca()(),Lua);a=Kf(a,function(c){return c.getFunctionName()==b});null!=a&&ej(a,1)?U("macros-exec").qc(new Ygs(jj(a,1),b,void 0,void 0,void 0,ej(a,12)?a.EB():void 0)):fx("Script function "+(b+" could not be found"))};function Rks(a){var b=a.Lnb;a='<div class="waffle-record-script-dialog-name-section"><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-name-input" id="waffle-record-script-name-input-label">Name</label></div><div class="waffle-record-script-name"><input class="waffle-record-script-name-input jfk-textinput" id="waffle-record-script-name-input" maxlength="50" aria-labelledby="waffle-record-script-dialog-description-id waffle-record-script-name-input-label"/></div></div><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-shortcut-input">Shortcut (optional)</label></div><div class="waffle-record-script-shortcut"><label for="waffle-record-script-shortcut-input" id="waffle-record-script-shortcut-input-label">'+
(Lq(b)+'</label><input class="waffle-record-script-shortcut-input jfk-textinput" id="waffle-record-script-shortcut-input" maxlength="1" aria-labelledby="waffle-record-script-shorcut-description-id"/><div id="waffle-record-script-shorcut-description-id" style="display:none;">');b="Optional numeric shortcut key, use with "+(Lq(b)+" to run macro.");return Mq(a+b+"</div></div>")};function Sks(a,b){ut.call(this,void 0,void 0,b);this.AB=!1;Br(this,!1);this.F=new it;this.Na(this.F);this.H=new HY(this.Ea());this.Na(this.H);this.O=new it("Number");this.Na(this.O);this.C=new HY(this.Ea());this.Na(this.C);Cr(this,(new Ar).Hj({key:"discard",caption:"Discard"},!1).Hj(mKb,!0))}y(Sks,ut);u=Sks.prototype;
u.Ia=function(){ut.prototype.Ia.call(this);of(vf(),"docs-egmd")?(lr(yr(this),"waffle-record-script-dialog-gm"),Hr(this,"save")):lr(yr(this),"waffle-record-script-dialog");this.setTitle("Save new macro");this.Lc().appendChild(Jq(Rks,{Lnb:lp?"\u2318 + Option + Shift +":"Ctrl + Alt + Shift +"}))};
u.Oa=function(){ut.prototype.Oa.call(this);this.F.xb(this.Ka("waffle-record-script-name-input"));of(vf(),"docs-egmd")||lr(this.Ka("waffle-record-script-name"),k2k.rb().xd());this.F.setValue("Untitled Macro");var a=this.F.Sa();this.H.setPosition(3,2);this.H.render();this.H.kp(a);KY(this.H,a);JY(this.H);this.O.xb(this.Ka("waffle-record-script-shortcut-input"));of(vf(),"docs-egmd")||lr(this.Ka("waffle-record-script-shortcut"),k2k.rb().xd());var b=this.O.Sa();this.C.setPosition(3,2);this.C.render();this.C.kp(b);
KY(this.C,b);JY(this.C);this.getHandler().listen(this,"dialogselect",this.D4c).listen(a,["focus","blur","change"],this.lDc).listen(b,["focus","blur","change"],this.AJc)};u.focus=function(){ut.prototype.focus.call(this);kt(this.F)};u.lDc=function(){""!=this.F.getValue()&&JY(this.H)};u.AJc=function(){Tks(this)&&JY(this.C)};
u.D4c=function(a){var b=this,c=Fp(new Ep,12).build();if("discard"==a.key)ecc.qc(void 0,c);else if("save"==a.key)if(""!=this.F.getValue()||IY(this.H,"Must not be empty.",!0),Tks(this)||setTimeout(function(){IY(b.C,"Must be a number from 0 to 9 or blank.",!0)}),Uks(this)&&setTimeout(function(){IY(b.C,"Conflicts with another shortcut.",!0)}),""!=this.F.getValue()&&Tks(this)&&!Uks(this)){a=this.F.getValue();var d=this.O.getValue();occ.qc(new uks(a,d),c)}else a.preventDefault()};
function Tks(a){a=a.O.getValue();return""==a||/^\d$/.test(a)}function Uks(a){var b="Ctrl+Alt+Shift+"+a.O.getValue();return il().Pca()().map(Lua).some(function(c){return ej(c,9)&&jj(c,9)==b})};function Vks(){io.apply(this,arguments)}y(Vks,io);Vks.prototype.F=function(){return Qks};Vks.prototype.H=function(){return Sks};Vks.prototype.C=function(a,b,c){return new Cgs(a,b,c,void 0)};Vks.prototype.D=function(a,b,c){return new Sgs(a,b,c,void 0)};yo("ritzmaestro",Vks);
